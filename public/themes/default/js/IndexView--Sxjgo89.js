import{k as e,$ as t,r as a,m as r,a6 as s,N as n,Q as l,P as o,Y as i,M as d,a9 as u,L as c}from"./vue-vendors-B4XdlKKZ.js";import{_ as m}from"./Content.vue_vue_type_script_setup_true_lang-CEfikmAR.js";import{u as p,_,S as f}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{J as v}from"./index-DZdj2b_n.js";import{_ as y}from"./DataTable.vue_vue_type_script_setup_true_lang-Dzev82sr.js";import{u as h}from"./order-B5wF1C3c.js";import{G as k,S as g,T as w,B as j,r as x,t as $,o as b}from"./naive-ui-DFBPfLe9.js";import"./icons-C1_zt0kT.js";import"./photo-components-DTzq5atJ.js";import"./utils-DGAJShNI.js";const C={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},W={class:"grow md:grow-0 md:basis-1/2"},O=e({__name:"IndexView",setup(e){const O=s(),U=h(),{t:P}=t(),S=k(),z=a(),A=[{title:P("Order Number"),key:"trade_no",minWidth:250},{title:P("Product"),key:"snapshot.name",minWidth:300},{title:P("Payment Cycle"),key:"product.name",minWidth:200},{title:P("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:P("Order Status"),key:"status",minWidth:100,sorter:!0,align:"center",render(e){const t={cancelled:P("Cancelled"),unpaid:P("Unpaid"),paid:P("Paid")},a=e.status;return r(g,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??P("Unknown")})}},{title:P("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>p(e.created_at).format("L")},{title:P("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>r(w,{vertical:!1,size:5,justify:"center"},{default:()=>[r(j,{size:"small",onClick:()=>{O.push(`/user/orders/${e.trade_no}`)}},{default:()=>P("Details")}),r(j,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{U.cancelOrder(e.trade_no,S,P).then((()=>{var e;T.value=[],null==(e=z.value)||e.refresh()}))}},{default:()=>P("Cancel Order")})]})}],K=a(""),L=a("sort:latest"),T=a([]),q=e=>v({query:{page:e,per_page:40,q:`${K.value} ${L.value}`.trim()}});function D(e){var t;e.order?L.value=`sort:${e.columnKey}:${e.order}`:L.value="sort:latest",null==(t=z.value)||t.refresh()}function I(){var e;null==(e=z.value)||e.refresh()}return(e,t)=>(c(),n(_,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:l((()=>[o(m,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:l((()=>[o(i(x),null,{default:l((()=>[o(i(w),{vertical:""},{default:l((()=>[d("div",C,[t[2]||(t[2]=d("div",null,null,-1)),d("div",W,[o(i($),{value:K.value,"onUpdate:value":t[0]||(t[0]=e=>K.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:u(I,["enter","native"])},{prefix:l((()=>[o(i(b),{component:i(f)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),o(y,{striped:"",ref_key:"tableRef",ref:z,bordered:!1,fetch:q,columns:A,"row-key":e=>e.id,"checked-row-keys":T.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>T.value=e),onUpdateSorter:D},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{O as default};
