import{_ as e}from"./Content.vue_vue_type_script_setup_true_lang-CEfikmAR.js";import{u as a,_ as t}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{a as l,l as s}from"./album-dTOteY8-.js";import{k as r,a6 as o,$ as u,K as i,L as n,Y as c,M as d,P as p,Q as b,V as m,U as g,a7 as f,m as v,r as y,N as h,F as _,R as k,w,o as x,j}from"./vue-vendors-B4XdlKKZ.js";import{F as $,E as A,S,D as C}from"./icons-C1_zt0kT.js";import{B as L,L as q,o as z,m as N,J as E,N as D,t as F,C as O}from"./naive-ui-DFBPfLe9.js";import{_ as R,a as U}from"./Share.vue_vue_type_script_setup_true_lang-JcdndmeT.js";import{s as H}from"./index-DZdj2b_n.js";import"./photo-components-DTzq5atJ.js";import"./utils-DGAJShNI.js";const M=["src"],P={key:1,class:"flex items-center justify-center w-full h-full bg-gray-200 dark:bg-gray-700"},V={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/70 to-transparent p-3"},B={key:0,class:"text-white font-medium truncate text-sm mb-1"},G={class:"flex justify-between items-center text-white/80 text-xs"},I=r({__name:"Album",props:{album:{type:Object,required:!0},handleSelect:{type:Function,default:()=>{}}},setup(e){const t=e,l=o(),{t:s}=u();function r(e){return()=>v(z,null,{default:()=>v(e)})}const y=[{key:"edit",label:s("Edit Album"),icon:r(A)},{key:"share",label:s("Share"),icon:r(S)},{key:"delete",label:s("Delete"),icon:r(C)}];return(e,s)=>(n(),i("div",{class:"relative aspect-square cursor-pointer group overflow-hidden bg-gray-200 dark:bg-gray-800",onClick:s[0]||(s[0]=()=>{c(l).push(`/user/albums/${t.album.id}`)})},[t.album.covers&&t.album.covers.length>0?(n(),i("img",{key:0,class:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",alt:"album cover",src:t.album.covers[0]},null,8,M)):(n(),i("div",P,[p(c($),{icon:"fa-solid fa-images",class:"text-gray-400 dark:text-gray-500",size:"3x"})])),s[1]||(s[1]=d("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300"},null,-1)),p(c(q),{size:"large",placement:"bottom-start",trigger:"click",options:y,onSelect:t.handleSelect,"show-arrow":""},{default:b((()=>[p(c(L),{tertiary:"",circle:"",size:"small",type:"default",title:e.$t("Show Album Options"),class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black bg-opacity-50 text-white border-none hover:bg-opacity-70",onClick:m((()=>{}),["stop"])},{icon:b((()=>[p(c($),{icon:"fa-solid fa-ellipsis-vertical",class:"text-white"})])),_:1},8,["title"])])),_:1},8,["onSelect"]),d("div",V,[t.album.name?(n(),i("p",B,f(t.album.name),1)):g("",!0),d("div",G,[d("span",null,f(e.$t("{count} items",{count:t.album.photo_count})),1),d("span",null,f(c(a)(t.album.created_at).format("L")),1)])])]))}}),J={key:1,class:"w-full grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-1 p-1"},K={key:2,class:"flex justify-center py-10"},Q=r({__name:"AlbumList",setup(e){const a=l(),t=N(),s=o(),{t:r}=u(),d=y(),b=y();return(e,l)=>(n(),i(_,null,[p(R,{ref_key:"deleteRef",ref:d},null,512),p(U,{ref_key:"shareRef",ref:b},null,512),c(a).isLoading||0!==c(a).albums.length?(n(),i("div",J,[(n(!0),i(_,null,k(c(a).albums,(e=>(n(),h(I,{album:e,key:e.id,"handle-select":a=>function(e,a){var l,o;switch(e){case"edit":s.push(`/user/albums/${a.id}`);break;case"share":null==(l=b.value)||l.open(a);break;case"delete":null==(o=d.value)||o.open(a,(()=>{t.success(r("Deleted successfully"))}))}}(a,e)},null,8,["album","handle-select"])))),128))])):(n(),h(c(E),{key:0,class:"my-10",description:e.$t("No albums available")},null,8,["description"])),c(a).isLoading?(n(),i("div",K,[p(c(D),{size:25})])):g("",!0)],64))}}),T={class:"flex items-center justify-between space-x-2 sticky top-0 z-[4] bg-gray-50 border-b border-transparent dark:bg-[var(--n-color)] dark:border-b-gray-800 p-2 w-full"},Y={class:"space-x-2"},W={class:"shrink-0 grow md:grow-0 w-1/2 flex space-x-2"},X=r({__name:"IndexView",setup(a){const r=N(),i=o(),m=l(),{t:g}=u(),v=e=>{const a=e.target;100+a.scrollTop+a.clientHeight>=a.scrollHeight&&(m.isLoading||(m.setPage(m.page+1),m.fetchAlbums()))},_=[{label:g("Newest"),value:"latest"},{label:g("Oldest"),value:"oldest"}],k=y({q:"",order_by:"latest"});function A(){m.resetAlbums({q:`sort:${k.value.order_by} ${k.value.q}`})}w(k,s.debounce((()=>A()),500),{deep:!0});const S=()=>{H({body:{name:g("Create New Album")}}).then((e=>{var a;i.push(`/user/albums/${null==(a=e.data)?void 0:a.data.id}`).then((()=>{r.success(g("Created successfully"))}))}))};return x((()=>A())),(a,l)=>(n(),h(t,{"toggle-header":!1,"show-footer":!1,"header-title":a.$t("Album Management"),"content-class":"bg-white dark:bg-[var(--n-color)]","on-scroll":v},{default:b((()=>[p(e,{class:"max-w-full"},{default:b((()=>[d("div",T,[d("div",Y,[p(c(L),{tertiary:"",type:"default",onClick:S},{icon:b((()=>[p(c($),{icon:"fa-solid fa-plus"})])),default:b((()=>[j(" "+f(a.$t("Create Album")),1)])),_:1})]),d("div",W,[p(c(F),{class:"grow",value:k.value.q,"onUpdate:value":l[0]||(l[0]=e=>k.value.q=e),placeholder:a.$t("Enter keywords to search..."),clearable:""},null,8,["value","placeholder"]),p(c(O),{class:"w-32",placeholder:a.$t("Sort"),options:_,value:k.value.order_by,"onUpdate:value":l[1]||(l[1]=e=>k.value.order_by=e)},null,8,["placeholder","value"])])]),p(Q)])),_:1})])),_:1},8,["header-title"]))}});export{X as default};
