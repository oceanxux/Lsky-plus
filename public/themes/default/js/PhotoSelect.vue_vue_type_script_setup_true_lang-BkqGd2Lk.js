const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["themes/default/js/photo-components-DTzq5atJ.js","themes/default/js/vue-vendors-B4XdlKKZ.js"])))=>i.map(i=>d[i]);
import{f as e,h as t,A as s,u as i}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{_ as l}from"./photo-components-DTzq5atJ.js";import{k as a,K as n,L as o,M as r,c as d,$ as h,a8 as c,r as p,V as u,P as m,Y as v,H as g,N as y,U as f,q as w,m as b,n as k,w as _,o as x,G as S,ac as C,a7 as I,F as P,R as A,Q as z,j as E}from"./vue-vendors-B4XdlKKZ.js";import{F as M,E as D,D as L}from"./icons-C1_zt0kT.js";import{b as F,t as T,_ as O,y as j}from"./index-DZdj2b_n.js";import{m as N,G as U,L as $,o as W,J as H,N as K,B,P as R,I as G,y as V,Q as Z,A as q,t as Y,R as Q}from"./naive-ui-DFBPfLe9.js";const X={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},J=[r("path",{d:"M384 224v184a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V168a40 40 0 0 1 40-40h167.48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 64h112v112"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M224 288L440 72"},null,-1)],ee=a({name:"OpenOutline",render:function(e,t){return o(),n("svg",X,J)}}),te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},se=[r("path",{d:"M336 192h40a40 40 0 0 1 40 40v192a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V232a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 128l-80-80l-80 80"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 321V48"},null,-1)],ie=a({name:"ShareOutline",render:function(e,t){return o(),n("svg",te,se)}}),le=["href","data-pswp-width","data-pswp-height","data-pswp-srcset"],ae={class:"relative group bg-gray-200 dark:bg-gray-700"},ne={class:"absolute inset-0 flex justify-between z-[2] select-none"},oe={class:"absolute top-2 right-2"},re=a({__name:"Photo",props:{photo:{},layout:{},layoutOptions:{},clickable:{type:Boolean},imageProps:{}},emits:["onToggleSelect"],setup(i,{emit:l}){const a=i,_=F(),x=d((()=>{var e,t,s;return(null==(t=null==(e=_.profile)?void 0:e.options)?void 0:t.show_original_photos)||!(null==(s=a.photo.srcSet)?void 0:s.length)?a.photo:a.photo.srcSet[0]})),S=e(),{t:C}=h(),I=N(),P=c(),A=d((()=>P.path.includes("/user/albums/"))),z=p(null),E=d((()=>({srcset:a.photo.srcSet?a.photo.srcSet.map((e=>`${e.src} ${e.width}w`)).join(", "):null})));function O(e){e.preventDefault(),e.stopPropagation();const t=x.value.key;if(e.ctrlKey||e.metaKey)return S.toggleSelect(t),void(z.value=t);e.shiftKey&&z.value?function(e,t){let s=-1,i=-1,l=-1,a=-1;const n=S.groups;for(let o=0;o<n.length;o++){const r=n[o];for(let n=0;n<r.photos.length;n++)r.photos[n].key===e&&(s=o,i=n),r.photos[n].key===t&&(l=o,a=n)}if(-1===s||-1===l)return;(s>l||s===l&&i>a)&&([s,l]=[l,s],[i,a]=[a,i]);for(let o=s;o<=l;o++){const e=n[o],t=o===s?i:0,r=o===l?a:e.photos.length-1;for(let s=t;s<=r;s++){const t=e.photos[s].key;e.photos[s].selected||S.toggleSelect(t)}}}(z.value,t):(S.toggleSelect(t),z.value=t)}function j(e){return()=>b(W,null,{default:()=>b(e)})}const H=d((()=>[{label:C("Copy Image"),key:"copy",disabled:S.selections.length>1,icon:j(t)},{label:C("Copy Link"),key:"copy-urls",icon:j(t),children:[{label:"Url",key:"copy-url"},{label:"Html",key:"copy-html"},{label:"BBCode",key:"copy-bbcode"},{label:"Markdown",key:"copy-markdown"},{label:"Markdown with link",key:"copy-markdown_with_link"},{label:"Thumbnail url",key:"copy-thumbnail_url"}]},{label:C("Open in New Window"),key:"open",disabled:S.selections.length>1,icon:j(ee)},{label:C("Edit Information"),key:"edit",icon:j(D)},{label:C("Share"),key:"share",icon:j(ie)},...A.value?[{label:C("Remove from Album"),key:"remove-from-album",icon:j(s)}]:[{label:C("Add to Album"),key:"to-album",icon:j(s)}],{type:"divider",key:"d1"},{label:C("Delete"),key:"delete",icon:j(L)}])),K=p(!1),B=p(0),R=p(0),G=U();function V(e){var t;K.value=!1;const s=String(e);switch(s){case"copy":S.copyImage(x.value.src).then((()=>{I.success(C("Copy successful"))})).catch((e=>{I.error(C("Copy failed"))}));break;case"copy-url":case"copy-html":case"copy-bbcode":case"copy-markdown":case"copy-markdown_with_link":case"copy-thumbnail_url":S.copyLink(s.replace("copy-","")).then((()=>{I.success(C("Copy successful"))})).catch((()=>{I.error(C("Copy failed"))}));break;case"open":S.openPhoto(x.value);break;case"edit":S.setEditModalActive(!0);break;case"share":S.setShareModalActive(!0);break;case"to-album":null==(t=S.albumSelectorRef)||t.open();break;case"remove-from-album":const e=Number(P.params.id);if(e){const t=G.warning({title:C("Warning"),content:C("Are you sure you want to remove the selected {count} photos from the album?",{count:S.selections.length}),positiveText:C("Confirm"),negativeText:C("Cancel"),onPositiveClick:()=>(t.loading=!0,T({path:{id:e},body:S.selections.map((e=>e.id))}).then((()=>{I.success(C("Removed successfully")),S.deletePhotos(S.selections.map((e=>e.key)));const e=F();e.isLoggedIn&&e.fetchUserProfile()})))})}break;case"delete":const i=G.warning({title:C("Warning"),content:C("Are you sure you want to delete the selected {count} photos?",{count:S.selections.length}),positiveText:C("Confirm"),negativeText:C("Cancel"),onPositiveClick:()=>(i.loading=!0,S.deleteSelectedPhotos().then((()=>{I.success(C("Deleted successfully"))})))})}}function Z(e){e.preventDefault(),K.value=!1,k().then((()=>{K.value=!0,B.value=e.clientX,R.value=e.clientY})),x.value.selected||(S.unselectAll(),setTimeout((()=>{S.toggleSelect(x.value.key)}),10))}function q(){K.value=!1}return(e,t)=>(o(),n("a",{href:x.value.public_url||x.value.src,"data-pswp-width":x.value.width,"data-pswp-height":x.value.height,"data-pswp-srcset":E.value.srcset,target:"_blank",rel:"noopener noreferrer",onContextmenu:Z,onClick:t[0]||(t[0]=u((e=>e.ctrlKey||e.metaKey||e.shiftKey?O(e):null),["prevent"]))},[m(v($),{placement:"bottom-start",trigger:"manual",x:B.value,y:R.value,options:H.value,show:K.value,"on-clickoutside":q,onSelect:V},null,8,["x","y","options","show"]),r("div",ae,[t[1]||(t[1]=r("div",{class:"transition-all absolute w-full top-0 h-1/2 bg-gradient-to-b from-black/30 opacity-0 group-hover:opacity-100"},null,-1)),r("div",ne,[m(v(M),{class:g(["rounded-full cursor-pointer absolute top-2 left-2",x.value.selected?"text-violet-500 bg-white outline outline-1 outline-white dark:outline-gray-500":"hidden group-hover:block text-white/70 hover:text-white"]),icon:"fa-solid fa-circle-check",size:"xl",onClick:u(O,["prevent","stop"])},null,8,["class"]),r("div",oe,[x.value.is_public?(o(),y(v(M),{key:0,class:"text-red-500",icon:"fa-solid fa-eye",title:e.$t("Public")},null,8,["title"])):f("",!0)])]),r("div",{class:g(["overflow-hidden transition-all",x.value.selected?"scale-90 rounded-lg":""])},[w(e.$slots,"default")],2)])],40,le))}});
/*!
  * PhotoSwipe Lightbox 5.4.4 - https://photoswipe.com
  * (c) 2024 Dmytro Semenov
  */
function de(e,t,s){const i=document.createElement(t);return e&&(i.className=e),s&&s.appendChild(i),i}function he(e,t,s){e.style.width="number"==typeof t?`${t}px`:t,e.style.height="number"==typeof s?`${s}px`:s}const ce="idle",pe="loading",ue="loaded",me="error";function ve(e,t,s=document){let i=[];if(e instanceof Element)i=[e];else if(e instanceof NodeList||Array.isArray(e))i=Array.from(e);else{const l="string"==typeof e?e:t;l&&(i=Array.from(s.querySelectorAll(l)))}return i}function ge(){return!(!navigator.vendor||!navigator.vendor.match(/apple/i))}class ye{constructor(e,t){this.type=e,this.defaultPrevented=!1,t&&Object.assign(this,t)}preventDefault(){this.defaultPrevented=!0}}class fe{constructor(){this._listeners={},this._filters={},this.pswp=void 0,this.options=void 0}addFilter(e,t,s=100){var i,l,a;this._filters[e]||(this._filters[e]=[]),null===(i=this._filters[e])||void 0===i||i.push({fn:t,priority:s}),null===(l=this._filters[e])||void 0===l||l.sort(((e,t)=>e.priority-t.priority)),null===(a=this.pswp)||void 0===a||a.addFilter(e,t,s)}removeFilter(e,t){this._filters[e]&&(this._filters[e]=this._filters[e].filter((e=>e.fn!==t))),this.pswp&&this.pswp.removeFilter(e,t)}applyFilters(e,...t){var s;return null===(s=this._filters[e])||void 0===s||s.forEach((e=>{t[0]=e.fn.apply(this,t)})),t[0]}on(e,t){var s,i;this._listeners[e]||(this._listeners[e]=[]),null===(s=this._listeners[e])||void 0===s||s.push(t),null===(i=this.pswp)||void 0===i||i.on(e,t)}off(e,t){var s;this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((e=>t!==e))),null===(s=this.pswp)||void 0===s||s.off(e,t)}dispatch(e,t){var s;if(this.pswp)return this.pswp.dispatch(e,t);const i=new ye(e,t);return null===(s=this._listeners[e])||void 0===s||s.forEach((e=>{e.call(this,i)})),i}}class we{constructor(e,t){if(this.element=de("pswp__img pswp__img--placeholder",e?"img":"div",t),e){const t=this.element;t.decoding="async",t.alt="",t.src=e,t.setAttribute("role","presentation")}this.element.setAttribute("aria-hidden","true")}setDisplayedSize(e,t){this.element&&("IMG"===this.element.tagName?(he(this.element,250,"auto"),this.element.style.transformOrigin="0 0",this.element.style.transform=function(e,t,s){let i=`translate3d(${e}px,0px,0)`;return void 0!==s&&(i+=` scale3d(${s},${s},1)`),i}(0,0,e/250)):he(this.element,e,t))}destroy(){var e;null!==(e=this.element)&&void 0!==e&&e.parentNode&&this.element.remove(),this.element=null}}class be{constructor(e,t,s){this.instance=t,this.data=e,this.index=s,this.element=void 0,this.placeholder=void 0,this.slide=void 0,this.displayedImageWidth=0,this.displayedImageHeight=0,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.hasSlide=!1,this.isDecoding=!1,this.state=ce,this.data.type?this.type=this.data.type:this.data.src?this.type="image":this.type="html",this.instance.dispatch("contentInit",{content:this})}removePlaceholder(){this.placeholder&&!this.keepPlaceholder()&&setTimeout((()=>{this.placeholder&&(this.placeholder.destroy(),this.placeholder=void 0)}),1e3)}load(e,t){if(this.slide&&this.usePlaceholder())if(this.placeholder){const e=this.placeholder.element;e&&!e.parentElement&&this.slide.container.prepend(e)}else{const e=this.instance.applyFilters("placeholderSrc",!(!this.data.msrc||!this.slide.isFirstSlide)&&this.data.msrc,this);this.placeholder=new we(e,this.slide.container)}this.element&&!t||this.instance.dispatch("contentLoad",{content:this,isLazy:e}).defaultPrevented||(this.isImageContent()?(this.element=de("pswp__img","img"),this.displayedImageWidth&&this.loadImage(e)):(this.element=de("pswp__content","div"),this.element.innerHTML=this.data.html||""),t&&this.slide&&this.slide.updateContentSize(!0))}loadImage(e){var t,s;if(!this.isImageContent()||!this.element||this.instance.dispatch("contentLoadImage",{content:this,isLazy:e}).defaultPrevented)return;const i=this.element;this.updateSrcsetSizes(),this.data.srcset&&(i.srcset=this.data.srcset),i.src=null!==(t=this.data.src)&&void 0!==t?t:"",i.alt=null!==(s=this.data.alt)&&void 0!==s?s:"",this.state=pe,i.complete?this.onLoaded():(i.onload=()=>{this.onLoaded()},i.onerror=()=>{this.onError()})}setSlide(e){this.slide=e,this.hasSlide=!0,this.instance=e.pswp}onLoaded(){this.state=ue,this.slide&&this.element&&(this.instance.dispatch("loadComplete",{slide:this.slide,content:this}),this.slide.isActive&&this.slide.heavyAppended&&!this.element.parentNode&&(this.append(),this.slide.updateContentSize(!0)),this.state!==ue&&this.state!==me||this.removePlaceholder())}onError(){this.state=me,this.slide&&(this.displayError(),this.instance.dispatch("loadComplete",{slide:this.slide,isError:!0,content:this}),this.instance.dispatch("loadError",{slide:this.slide,content:this}))}isLoading(){return this.instance.applyFilters("isContentLoading",this.state===pe,this)}isError(){return this.state===me}isImageContent(){return"image"===this.type}setDisplayedSize(e,t){if(this.element&&(this.placeholder&&this.placeholder.setDisplayedSize(e,t),!this.instance.dispatch("contentResize",{content:this,width:e,height:t}).defaultPrevented&&(he(this.element,e,t),this.isImageContent()&&!this.isError()))){const s=!this.displayedImageWidth&&e;this.displayedImageWidth=e,this.displayedImageHeight=t,s?this.loadImage(!1):this.updateSrcsetSizes(),this.slide&&this.instance.dispatch("imageSizeChange",{slide:this.slide,width:e,height:t,content:this})}}isZoomable(){return this.instance.applyFilters("isContentZoomable",this.isImageContent()&&this.state!==me,this)}updateSrcsetSizes(){if(!this.isImageContent()||!this.element||!this.data.srcset)return;const e=this.element,t=this.instance.applyFilters("srcsetSizesWidth",this.displayedImageWidth,this);(!e.dataset.largestUsedSize||t>parseInt(e.dataset.largestUsedSize,10))&&(e.sizes=t+"px",e.dataset.largestUsedSize=String(t))}usePlaceholder(){return this.instance.applyFilters("useContentPlaceholder",this.isImageContent(),this)}lazyLoad(){this.instance.dispatch("contentLazyLoad",{content:this}).defaultPrevented||this.load(!0)}keepPlaceholder(){return this.instance.applyFilters("isKeepingPlaceholder",this.isLoading(),this)}destroy(){this.hasSlide=!1,this.slide=void 0,this.instance.dispatch("contentDestroy",{content:this}).defaultPrevented||(this.remove(),this.placeholder&&(this.placeholder.destroy(),this.placeholder=void 0),this.isImageContent()&&this.element&&(this.element.onload=null,this.element.onerror=null,this.element=void 0))}displayError(){if(this.slide){var e,t;let s=de("pswp__error-msg","div");s.innerText=null!==(e=null===(t=this.instance.options)||void 0===t?void 0:t.errorMsg)&&void 0!==e?e:"",s=this.instance.applyFilters("contentErrorElement",s,this),this.element=de("pswp__content pswp__error-msg-container","div"),this.element.appendChild(s),this.slide.container.innerText="",this.slide.container.appendChild(this.element),this.slide.updateContentSize(!0),this.removePlaceholder()}}append(){if(this.isAttached||!this.element)return;if(this.isAttached=!0,this.state===me)return void this.displayError();if(this.instance.dispatch("contentAppend",{content:this}).defaultPrevented)return;const e="decode"in this.element;this.isImageContent()?e&&this.slide&&(!this.slide.isActive||ge())?(this.isDecoding=!0,this.element.decode().catch((()=>{})).finally((()=>{this.isDecoding=!1,this.appendImage()}))):this.appendImage():this.slide&&!this.element.parentNode&&this.slide.container.appendChild(this.element)}activate(){!this.instance.dispatch("contentActivate",{content:this}).defaultPrevented&&this.slide&&(this.isImageContent()&&this.isDecoding&&!ge()?this.appendImage():this.isError()&&this.load(!1,!0),this.slide.holderElement&&this.slide.holderElement.setAttribute("aria-hidden","false"))}deactivate(){this.instance.dispatch("contentDeactivate",{content:this}),this.slide&&this.slide.holderElement&&this.slide.holderElement.setAttribute("aria-hidden","true")}remove(){this.isAttached=!1,this.instance.dispatch("contentRemove",{content:this}).defaultPrevented||(this.element&&this.element.parentNode&&this.element.remove(),this.placeholder&&this.placeholder.element&&this.placeholder.element.remove())}appendImage(){this.isAttached&&(this.instance.dispatch("contentAppendImage",{content:this}).defaultPrevented||(this.slide&&this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element),this.state!==ue&&this.state!==me||this.removePlaceholder()))}}function ke(e,t,s,i,l){let a=0;if(t.paddingFn)a=t.paddingFn(s,i,l)[e];else if(t.padding)a=t.padding[e];else{const s="padding"+e[0].toUpperCase()+e.slice(1);t[s]&&(a=t[s])}return Number(a)||0}class _e{constructor(e,t,s,i){this.pswp=i,this.options=e,this.itemData=t,this.index=s,this.panAreaSize=null,this.elementSize=null,this.fit=1,this.fill=1,this.vFill=1,this.initial=1,this.secondary=1,this.max=1,this.min=1}update(e,t,s){const i={x:e,y:t};this.elementSize=i,this.panAreaSize=s;const l=s.x/i.x,a=s.y/i.y;this.fit=Math.min(1,l<a?l:a),this.fill=Math.min(1,l>a?l:a),this.vFill=Math.min(1,a),this.initial=this._getInitial(),this.secondary=this._getSecondary(),this.max=Math.max(this.initial,this.secondary,this._getMax()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}_parseZoomLevelOption(e){const t=e+"ZoomLevel",s=this.options[t];if(s)return"function"==typeof s?s(this):"fill"===s?this.fill:"fit"===s?this.fit:Number(s)}_getSecondary(){let e=this._parseZoomLevelOption("secondary");return e||(e=Math.min(1,3*this.fit),this.elementSize&&e*this.elementSize.x>4e3&&(e=4e3/this.elementSize.x),e)}_getInitial(){return this._parseZoomLevelOption("initial")||this.fit}_getMax(){return this._parseZoomLevelOption("max")||Math.max(1,4*this.fit)}}function xe(e,t,s){const i=t.createContentFromData(e,s);let l;const{options:a}=t;if(a){let n;l=new _e(a,e,-1),n=t.pswp?t.pswp.viewportSize:function(e,t){if(e.getViewportSizeFn){const s=e.getViewportSizeFn(e,t);if(s)return s}return{x:document.documentElement.clientWidth,y:window.innerHeight}}(a,t);const o=function(e,t,s,i){return{x:t.x-ke("left",e,t,s,i)-ke("right",e,t,s,i),y:t.y-ke("top",e,t,s,i)-ke("bottom",e,t,s,i)}}(a,n,e,s);l.update(i.width,i.height,o)}return i.lazyLoad(),l&&i.setDisplayedSize(Math.ceil(i.width*l.initial),Math.ceil(i.height*l.initial)),i}class Se extends fe{getNumItems(){var e;let t=0;const s=null===(e=this.options)||void 0===e?void 0:e.dataSource;s&&"length"in s?t=s.length:s&&"gallery"in s&&(s.items||(s.items=this._getGalleryDOMElements(s.gallery)),s.items&&(t=s.items.length));const i=this.dispatch("numItems",{dataSource:s,numItems:t});return this.applyFilters("numItems",i.numItems,s)}createContentFromData(e,t){return new be(e,this,t)}getItemData(e){var t;const s=null===(t=this.options)||void 0===t?void 0:t.dataSource;let i={};Array.isArray(s)?i=s[e]:s&&"gallery"in s&&(s.items||(s.items=this._getGalleryDOMElements(s.gallery)),i=s.items[e]);let l=i;l instanceof Element&&(l=this._domElementToItemData(l));const a=this.dispatch("itemData",{itemData:l||{},index:e});return this.applyFilters("itemData",a.itemData,e)}_getGalleryDOMElements(e){var t,s;return null!==(t=this.options)&&void 0!==t&&t.children||null!==(s=this.options)&&void 0!==s&&s.childSelector?ve(this.options.children,this.options.childSelector,e)||[]:[e]}_domElementToItemData(e){const t={element:e},s="A"===e.tagName?e:e.querySelector("a");if(s){t.src=s.dataset.pswpSrc||s.href,s.dataset.pswpSrcset&&(t.srcset=s.dataset.pswpSrcset),t.width=s.dataset.pswpWidth?parseInt(s.dataset.pswpWidth,10):0,t.height=s.dataset.pswpHeight?parseInt(s.dataset.pswpHeight,10):0,t.w=t.width,t.h=t.height,s.dataset.pswpType&&(t.type=s.dataset.pswpType);const l=e.querySelector("img");var i;if(l)t.msrc=l.currentSrc||l.src,t.alt=null!==(i=l.getAttribute("alt"))&&void 0!==i?i:"";(s.dataset.pswpCropped||s.dataset.cropped)&&(t.thumbCropped=!0)}return this.applyFilters("domItemData",t,e,s)}lazyLoadData(e,t){return xe(e,this,t)}}class Ce extends Se{constructor(e){super(),this.options=e||{},this._uid=0,this.shouldOpen=!1,this._preloadedContent=void 0,this.onThumbnailsClick=this.onThumbnailsClick.bind(this)}init(){ve(this.options.gallery,this.options.gallerySelector).forEach((e=>{e.addEventListener("click",this.onThumbnailsClick,!1)}))}onThumbnailsClick(e){if(function(e){return"button"in e&&1===e.button||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey}(e)||window.pswp)return;let t={x:e.clientX,y:e.clientY};t.x||t.y||(t=null);let s=this.getClickedIndex(e);s=this.applyFilters("clickedIndex",s,e,this);const i={gallery:e.currentTarget};s>=0&&(e.preventDefault(),this.loadAndOpen(s,i,t))}getClickedIndex(e){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,e);const t=e.target,s=ve(this.options.children,this.options.childSelector,e.currentTarget).findIndex((e=>e===t||e.contains(t)));return-1!==s?s:this.options.children||this.options.childSelector?-1:0}loadAndOpen(e,t,s){if(window.pswp||!this.options)return!1;if(!t&&this.options.gallery&&this.options.children){const e=ve(this.options.gallery);e[0]&&(t={gallery:e[0]})}return this.options.index=e,this.options.initialPointerPos=s,this.shouldOpen=!0,this.preload(e,t),!0}preload(e,t){const{options:s}=this;t&&(s.dataSource=t);const i=[],l=typeof s.pswpModule;if("function"==typeof(a=s.pswpModule)&&a.prototype&&a.prototype.goTo)i.push(Promise.resolve(s.pswpModule));else{if("string"===l)throw new Error("pswpModule as string is no longer supported");if("function"!==l)throw new Error("pswpModule is not valid");i.push(s.pswpModule())}var a;"function"==typeof s.openPromise&&i.push(s.openPromise()),!1!==s.preloadFirstSlide&&e>=0&&(this._preloadedContent=function(e,t){const s=t.getItemData(e);if(!t.dispatch("lazyLoadSlide",{index:e,itemData:s}).defaultPrevented)return xe(s,t,e)}(e,this));const n=++this._uid;Promise.all(i).then((e=>{if(this.shouldOpen){const t=e[0];this._openPhotoswipe(t,n)}}))}_openPhotoswipe(e,t){if(t!==this._uid&&this.shouldOpen)return;if(this.shouldOpen=!1,window.pswp)return;const s="object"==typeof e?new e.default(this.options):new e(this.options);this.pswp=s,window.pswp=s,Object.keys(this._listeners).forEach((e=>{var t;null===(t=this._listeners[e])||void 0===t||t.forEach((t=>{s.on(e,t)}))})),Object.keys(this._filters).forEach((e=>{var t;null===(t=this._filters[e])||void 0===t||t.forEach((t=>{s.addFilter(e,t.fn,t.priority)}))})),this._preloadedContent&&(s.contentLoader.addToCache(this._preloadedContent),this._preloadedContent=void 0),s.on("destroy",(()=>{this.pswp=void 0,delete window.pswp})),s.init()}destroy(){var e;null===(e=this.pswp)||void 0===e||e.destroy(),this.shouldOpen=!1,this._listeners={},ve(this.options.gallery,this.options.gallerySelector).forEach((e=>{e.removeEventListener("click",this.onThumbnailsClick,!1)}))}}const Ie={class:"flex flex-col space-y-2"},Pe={class:"sticky top-12 z-[3] py-2 bg-white dark:bg-[var(--n-color)] flex space-x-2 items-center overflow-hidden group text-md"},Ae={class:"font-bold"},ze=a({__name:"PhotoGroup",props:{group:{type:Object,default:()=>{},required:!0}},setup(t){const s=t,{toggleSelectAllByGroup:a}=e(),{t:d}=h(),c=[d("Sunday"),d("Monday"),d("Tuesday"),d("Wednesday"),d("Thursday"),d("Friday"),d("Saturday")],u=p(4),y=p(200),f=e=>{let t;return t=e>=1200?12:e>=600&&e<1200?8:e>=300&&e<600?4:3,{maxPhotos:t,singleRowMaxHeight:250}};return(e=>{const t=p(),s=()=>{i();const s=C(e??{});t.value=new Ce({pswpModule:()=>O((()=>import("./photo-components-DTzq5atJ.js").then((e=>e.p))),__vite__mapDeps([0,1])),...s}),t.value.init()},i=()=>{void 0!==t.value&&(t.value.destroy(),t.value=void 0)};_((()=>C(e)),(()=>k(s))),x((()=>{s()})),S((()=>{i()}))})({gallery:".gallery",children:"a"}),(e,t)=>(o(),n("div",Ie,[r("div",Pe,[m(v(M),{icon:s.group.selected?"fa-solid fa-circle-check":"fa-regular fa-circle",size:"xl",class:g(["cursor-pointer transition-all select-none",s.group.selected?"text-violet-500 ml-0.5":"-ml-6 group-hover:ml-0.5 text-gray-500/70"]),onClick:t[0]||(t[0]=()=>v(a)(s.group.date))},null,8,["icon","class"]),r("p",Ae,I(v(i)(s.group.date).format("L"))+" "+I(c[v(i)(s.group.date).day()]),1)]),m(v(l),{class:"gallery",layout:"rows",photos:s.group.photos,spacing:u.value,"photo-renderer":re,"row-constraints":f,"target-row-height":y.value},null,8,["photos","spacing","target-row-height"])]))}}),Ee={key:2,class:"flex justify-center py-10"},Me=a({__name:"PhotoList",setup(t){const s=e();return(e,t)=>(o(),n(P,null,[v(s).isLoading||0!==v(s).groups.length?(o(!0),n(P,{key:1},A(v(s).groups,(e=>(o(),y(ze,{group:e,key:e.date},null,8,["group"])))),128)):(o(),y(v(H),{key:0,class:"my-10",description:e.$t("No photos available")},null,8,["description"])),v(s).isLoading?(o(),n("div",Ee,[m(v(K),{size:25})])):f("",!0)],64))}}),De=a({__name:"PhotoOperates",setup(t){const s=e();return(e,t)=>(o(),n("div",{key:v(s).selections.length,class:g(["flex flex-col items-center absolute p-2 md:p-3 my-2 z-[3] bg-white/95 dark:bg-black/80 border border-transparent dark:border-slate-400 transition-all rounded-2xl shadow-md space-y-2 md:space-y-3",v(s).selections.length>0?"right-2 md:right-6":"-right-20"])},[w(e.$slots,"default")],2))}}),Le=a({__name:"PhotoCopyLink",setup(t){const s=e(),i=N(),{t:l}=h(),a=[{label:"Url",key:"url"},{label:"Html",key:"html"},{label:"BBCode",key:"bbcode"},{label:"Markdown",key:"markdown"},{label:"Markdown with link",key:"markdown_with_link"},{label:"Thumbnail url",key:"thumbnail_url"}];function n(e){0!==s.selections.length?s.copyLink(e).then((()=>{i.success(l("Copy successful"))})).catch((()=>{i.error(l("Copy failed"))})):i.warning(l("Please select photos first"))}return(e,t)=>(o(),y(v($),{placement:"left-start",trigger:"hover",size:"small","show-arrow":"",options:a,onSelect:n},{default:z((()=>[m(v(B),{tertiary:"",circle:"",size:"small",type:"default",title:e.$t("Copy Link")},{icon:z((()=>[m(v(M),{icon:"fa-solid fa-copy"})])),_:1},8,["title"])])),_:1}))}}),Fe=a({__name:"PhotoCancel",setup(t){const s=e();return(e,t)=>(o(),y(v(B),{tertiary:"",circle:"",size:"small",type:"default",title:e.$t("Deselect")},{icon:z((()=>[m(v(M),{icon:"fa-solid fa-times",onClick:t[0]||(t[0]=e=>v(s).unselectAll())})])),_:1},8,["title"]))}}),Te=a({__name:"PhotoDelete",setup(t){const s=e(),i=N(),{t:l}=h();function a(){s.deleteSelectedPhotos().then((()=>{i.success(l("Deleted successfully"))}))}return(e,t)=>(o(),y(v(R),{placement:"left-start",onPositiveClick:a},{trigger:z((()=>[m(v(B),{quaternary:"",circle:"",size:"small",type:"error",title:e.$t("Delete Selected Items")},{icon:z((()=>[m(v(M),{icon:"fa-solid fa-trash-alt"})])),_:1},8,["title"])])),default:z((()=>[E(" "+I(e.$t("Are you sure you want to delete the selected {count} photos?",{count:v(s).selections.length})),1)])),_:1}))}}),Oe={class:"flex flex-col space-y-4"},je={key:0,class:"text-sm dark:text-gray-300 mb-2 text-center p-2 bg-gray-50 dark:bg-gray-800 rounded"},Ne={key:1,class:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded"},Ue={class:"text-sm font-medium mb-2 text-gray-700 dark:text-gray-300"},$e={class:"flex flex-wrap gap-4"},We={class:"flex items-center gap-2"},He={class:"text-sm"},Ke={class:"flex items-center gap-2"},Be={class:"text-sm"},Re={class:"flex items-center gap-2"},Ge={class:"text-sm"},Ve={class:"flex items-center gap-2"},Ze={class:"text-sm"},qe={class:"flex justify-end space-x-2"},Ye=a({__name:"PhotoEdit",setup(t){const s=e(),i=d((()=>s.selections)),l=d((()=>i.value.length>1)),a=d((()=>s.selections[0]||{tags:[]})),c=p(),u=p({}),g={},y=N(),{t:w}=h(),b=p({name:!l.value,intro:!l.value,is_public:!l.value,tags:!l.value});function k(){var e;const{name:t,intro:s,is_public:i}=a.value,n=(null==(e=a.value.tags)?void 0:e.map((e=>e.name)))||[];u.value={name:t,intro:s,is_public:i,tags:n},b.value={name:!l.value,intro:!l.value,is_public:!l.value,tags:!l.value}}async function S(){const e={ids:i.value.map((e=>e.id))};b.value.name&&(e.name=u.value.name),b.value.intro&&(e.intro=u.value.intro),b.value.is_public&&(e.is_public=u.value.is_public),b.value.tags&&(e.tags=u.value.tags),await j({body:e}).then((()=>{y.success(w("Successfully updated")),s.setEditModalActive(!1),i.value.forEach((e=>{b.value.name&&(e.name=u.value.name),b.value.intro&&(e.intro=u.value.intro),b.value.is_public&&(e.is_public=u.value.is_public),b.value.tags&&(e.tags=u.value.tags.map((e=>({name:e}))))}))})).catch((e=>{y.error(w("Update failed"))}))}return x((()=>{k()})),_((()=>s.editModalActive),(e=>{e&&k()})),(e,t)=>(o(),n(P,null,[m(v(G),{show:v(s).editModalActive,"onUpdate:show":t[9]||(t[9]=e=>v(s).editModalActive=e),title:l.value?v(w)("Batch Edit Information"):v(w)("Edit Information"),preset:"card",size:"small",bordered:!1,class:"max-w-screen-sm mx-4 md:mx-auto"},{action:z((()=>[r("div",qe,[m(v(B),{tertiary:"",type:"default",onClick:t[8]||(t[8]=e=>v(s).setEditModalActive(!1))},{default:z((()=>[E(I(v(w)("Cancel")),1)])),_:1}),m(v(B),{tertiary:"",type:"primary",onClick:S},{default:z((()=>[E(I(v(w)("Save")),1)])),_:1})])])),default:z((()=>[r("div",Oe,[m(v(V),{ref_key:"formRef",ref:c,model:u.value,rules:g},{default:z((()=>[l.value?(o(),n("div",je,I(v(w)("Selected {count} photos for batch editing",{count:i.value.length})),1)):f("",!0),l.value?(o(),n("div",Ne,[r("div",Ue,I(v(w)("Select fields to update"))+":",1),r("div",$e,[r("div",We,[m(v(Z),{value:b.value.name,"onUpdate:value":t[0]||(t[0]=e=>b.value.name=e),size:"small"},null,8,["value"]),r("span",He,I(v(w)("Custom Name")),1)]),r("div",Ke,[m(v(Z),{value:b.value.intro,"onUpdate:value":t[1]||(t[1]=e=>b.value.intro=e),size:"small"},null,8,["value"]),r("span",Be,I(v(w)("Description")),1)]),r("div",Re,[m(v(Z),{value:b.value.tags,"onUpdate:value":t[2]||(t[2]=e=>b.value.tags=e),size:"small"},null,8,["value"]),r("span",Ge,I(v(w)("Tags")),1)]),r("div",Ve,[m(v(Z),{value:b.value.is_public,"onUpdate:value":t[3]||(t[3]=e=>b.value.is_public=e),size:"small"},null,8,["value"]),r("span",Ze,I(v(w)("Is Public")),1)])])])):f("",!0),m(v(q),{label:v(w)("Custom Name"),path:"name"},{default:z((()=>[m(v(Y),{value:u.value.name,"onUpdate:value":t[4]||(t[4]=e=>u.value.name=e),disabled:l.value&&!b.value.name,placeholder:l.value&&!b.value.name?v(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),m(v(q),{label:v(w)("Description"),path:"intro"},{default:z((()=>[m(v(Y),{resizable:"",type:"textarea",value:u.value.intro,"onUpdate:value":t[5]||(t[5]=e=>u.value.intro=e),disabled:l.value&&!b.value.intro,placeholder:l.value&&!b.value.intro?v(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),m(v(q),{label:v(w)("Tags"),path:"tags"},{default:z((()=>[m(v(Q),{value:u.value.tags,"onUpdate:value":t[6]||(t[6]=e=>u.value.tags=e),disabled:l.value&&!b.value.tags,placeholder:l.value&&!b.value.tags?v(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),m(v(q),{label:v(w)("Is Public"),path:"is_public"},{default:z((()=>[m(v(Z),{value:u.value.is_public,"onUpdate:value":t[7]||(t[7]=e=>u.value.is_public=e),disabled:l.value&&!b.value.is_public},null,8,["value","disabled"])])),_:1},8,["label"])])),_:1},8,["model"])])])),_:1},8,["show","title"]),m(v(B),{tertiary:"",circle:"",size:"small",type:"default",title:i.value.length>1?v(w)("Batch Edit Information"):v(w)("Edit Information"),onClick:t[10]||(t[10]=e=>v(s).setEditModalActive(!0))},{icon:z((()=>[m(v(M),{icon:"fa-solid fa-edit"})])),_:1},8,["title"])],64))}}),Qe=a({__name:"PhotoSelect",setup(t){const s=e();return(e,t)=>(o(),y(v(B),{tertiary:"",circle:"",size:"small",type:"default",title:v(s).isAllSelected?e.$t("Deselect All"):e.$t("Select All")},{icon:z((()=>[m(v(M),{icon:"fa-solid fa-"+(v(s).isAllSelected?"check-double":"check"),onClick:t[0]||(t[0]=()=>{v(s).isAllSelected?v(s).unselectAll():v(s).selectAll()})},null,8,["icon"])])),_:1},8,["title"]))}});export{Me as _,De as a,Fe as b,Qe as c,Le as d,Ye as e,Te as f};
