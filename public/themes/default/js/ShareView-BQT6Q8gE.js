import{k as a,K as e,L as l,M as s,$ as t,r,a8 as u,o,P as n,Q as i,F as d,a7 as v,Y as c,j as p,R as m,a9 as f,a6 as w,N as _}from"./vue-vendors-B4XdlKKZ.js";import{_ as x,a as h}from"./ExploreImage.vue_vue_type_script_setup_true_lang-DTB10U6K.js";import{u as g,c as y,d as j}from"./index-DZdj2b_n.js";import{_ as k}from"./Content.vue_vue_type_script_setup_true_lang-CEfikmAR.js";import{_ as $,c as b,b as z}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{m as S,p as C,B as q,q as I,r as A,o as L,s as R,t as B}from"./naive-ui-DFBPfLe9.js";import"./utils-DGAJShNI.js";import"./icons-C1_zt0kT.js";import"./photo-components-DTzq5atJ.js";const K={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},M=[s("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm0 319.91a20 20 0 1 1 20-20a20 20 0 0 1-20 20zm21.72-201.15l-5.74 122a16 16 0 0 1-32 0l-5.74-121.94v-.05a21.74 21.74 0 1 1 43.44 0z",fill:"currentColor"},null,-1)],O=a({name:"AlertCircle",render:function(a,s){return l(),e("svg",K,M)}}),P={key:0,class:"container mx-auto p-4 sm:p-8 w-full"},T={class:"flex flex-col justify-center items-center mt-20"},U={key:1,class:"w-full"},V={class:"container mx-auto p-4 sm:p-8"},D={class:"flex flex-col sm:flex-row sm:justify-between mb-10 w-full"},E={class:"flex flex-col"},F={class:"text-2xl mb-4 font-bold"},N={class:"flex items-center w-full"},Q={class:"mt-4"},Y={class:"flex justify-end mt-2 sm:mt-0"},G={class:"my-4"},H={class:"masonry-container"},J={key:2,class:"container mx-auto p-4 sm:p-8 w-full"},W={class:"flex flex-col justify-center items-center mt-20"},X={class:"w-[300px] md:w-[400px]"},Z={class:"flex items-center space-x-1 text-gray-500 mb-2"},aa=z(a({__name:"ShareView",setup(a){const z=u(),K=w(),M=S(),aa=g(),{t:ea}=t(),la=r(String(z.query.p||"")),sa=r(null),ta=r({}),ra=r(0),ua=r([]),oa=r(""),na=r(1),ia=r(!1),da=r(!0),va=r(!1);async function ca(){var a,e,l,s;const t=await y({path:{slug:z.params.slug.toString()},query:{password:la.value}});return"error"===(null==(a=t.data)?void 0:a.status)?M.error(null==(e=t.data)?void 0:e.message):(!(null==(l=t.data)?void 0:l.data.is_valid)&&la.value&&M.error(ea("Incorrect password")),null==(s=t.data)?void 0:s.data)}async function pa(a={}){var e,l,s,t,r,u,o;if(ta.value.is_valid){const n=await j({path:{slug:ta.value.slug},query:{q:oa.value,page:na.value,password:la.value,...a}});if("error"===(null==(e=n.data)?void 0:e.status))return M.error(null==(l=n.data)?void 0:l.message);!(null==(s=n.data)?void 0:s.data.is_valid)&&la.value?M.error(ea("Incorrect password")):(ua.value.push(...(null==(t=n.data)?void 0:t.data.data)||[]),ia.value=!1,ra.value=(null==(r=n.data)?void 0:r.data.meta.total)||0,va.value=(null==(u=n.data)?void 0:u.data.meta.last_page)===(null==(o=n.data)?void 0:o.data.meta.current_page),na.value++)}}function ma(){ia.value||va.value||pa()}function fa(){var a;null==(a=sa.value)||a.open({path:{slug:z.params.slug.toString()}})}async function wa(){ta.value=await ca(),await pa(),ta.value.is_valid&&await K.replace(`/shares/${z.params.slug}?p=${la.value}`)}function _a(){K.push(`/explore/@${ta.value.user.username}`).then((()=>aa.setSidebarOpen(!1)))}return o((async()=>{da.value=!0,ta.value=await ca(),da.value=!1,await pa()})),(a,t)=>(l(),e(d,null,[n(x,{ref_key:"reportRef",ref:sa,type:"share"},null,512),n($,{"toggle-header":!1,"show-footer":!0,"header-title":a.$t("Share Details")},{default:i((()=>[n(k,null,{default:i((()=>{var r,u,o,w,x,g;return[da.value?(l(),e("div",P,[s("div",T,v(a.$t("Verifying...")),1)])):ta.value.is_valid?(l(),e("div",U,[s("div",V,[s("div",D,[s("div",E,[s("p",F,v((null==(u=null==(r=ta.value)?void 0:r.album)?void 0:u.name)||ta.value.content),1),s("div",N,[n(c(C),{class:"shrink-0",round:"",size:"medium",src:c(b).getUserAvatar((null==(o=ta.value.user)?void 0:o.avatar_url)||"")},null,8,["src"]),s("div",{class:"flex flex-col ml-2 w-full overflow-hidden cursor-pointer",onClick:_a},v(null==(w=ta.value.user)?void 0:w.name),1)]),s("p",Q,v(null==(g=null==(x=ta.value)?void 0:x.album)?void 0:g.intro),1)]),s("div",Y,[n(c(q),{secondary:"",strong:"",size:"small",onClick:fa},{default:i((()=>[p(v(a.$t("Report")),1)])),_:1})])]),s("p",G,v(a.$t("Total {count} photos",{count:ra.value})),1)]),n(c(I),{onLoad:ma},{default:i((()=>[s("div",H,[(l(!0),e(d,null,m(ua.value,(a=>(l(),_(h,{"show-user-info":!1,"show-like":!1,"show-report":!1,photo:a,key:a.id},null,8,["photo"])))),128))])])),_:1})])):(l(),e("div",J,[s("div",W,[s("div",X,[n(c(A),{size:"small"},{default:i((()=>[s("p",Z,[n(c(L),{component:c(O),size:16},null,8,["component"]),s("span",null,v(a.$t("This content requires a password to access")),1)]),n(c(R),null,{default:i((()=>[n(c(B),{type:"password",onKeyup:f(wa,["enter"]),value:la.value,"onUpdate:value":t[0]||(t[0]=a=>la.value=a),placeholder:a.$t("Please enter the access password"),"show-password-on":"click"},null,8,["value","placeholder"]),n(c(q),{onClick:wa},{default:i((()=>[p(v(a.$t("Open Share")),1)])),_:1})])),_:1})])),_:1})])])]))]})),_:1})])),_:1},8,["header-title"])],64))}}),[["__scopeId","data-v-f973e84d"]]);export{aa as default};
