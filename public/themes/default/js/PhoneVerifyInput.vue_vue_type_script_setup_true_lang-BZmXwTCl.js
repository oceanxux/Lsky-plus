import{a6 as e,a5 as a,a as l,a2 as t}from"./index-DZdj2b_n.js";import{k as u,af as s,ae as r,$ as i,r as o,c as d,o as n,N as c,Y as p,Q as v,M as h,P as f,I as m,H as y,K as b,j as C,a7 as z,L as g,w as k,q as S,U as V,F as _}from"./vue-vendors-B4XdlKKZ.js";import{m as $,s as w,t as x,B as q,A as M,C as P}from"./naive-ui-DFBPfLe9.js";const U={class:"flex items-center w-full"},I={key:0,class:"overflow-hidden rounded-md border border-[#d9d9d9] dark:border-[#383838] h-full"},K=["src"],j=u({__name:"CaptchaInput",props:s({disabled:{type:Boolean,default:!1},size:{type:String,default:()=>"medium"}},{captcha:{default:""},captchaModifiers:{},captchaKey:{default:""},captchaKeyModifiers:{}}),emits:["update:captcha","update:captchaKey"],setup(a){const l=a,t=r(a,"captcha"),u=r(a,"captchaKey"),{t:s}=i(),k=$(),S=o(""),V=o(!1),_=d((()=>{switch(l.size){case"small":return"28px";case"large":return"40px";default:return"34px"}})),M=async()=>{try{V.value=!0;const a=(await e()).data;a&&a.data?(S.value=a.data.img,u.value=a.data.key,t.value=""):k.error(s("Failed to load captcha"))}catch(a){k.error(s("Failed to load captcha"))}finally{V.value=!1}};return n((()=>{M()})),(e,a)=>(g(),c(p(w),null,{default:v((()=>[h("div",U,[f(p(x),{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),placeholder:e.$t("Please enter captcha"),disabled:l.disabled,size:l.size,class:"flex-1"},null,8,["value","placeholder","disabled","size"]),h("div",{class:y(["ml-2 flex items-center cursor-pointer",{"opacity-50":V.value}]),onClick:M,style:m({height:_.value})},[S.value?(g(),b("div",I,[h("img",{src:S.value,alt:"captcha",class:"h-full object-cover object-center",style:m({maxHeight:_.value})},null,12,K)])):(g(),c(p(q),{key:1,onClick:M,loading:V.value,size:l.size,class:"h-full"},{default:v((()=>[C(z(e.$t("Load Captcha")),1)])),_:1},8,["loading","size"]))],6)])])),_:1}))}}),E=u({__name:"EmailVerifyInput",props:s({event:{type:String,required:!0},size:{type:String,default:()=>"medium"},modelValue:{type:String,default:void 0},disabled:{type:Boolean,default:!1}},{email:{default:""},emailModifiers:{},code:{default:""},codeModifiers:{}}),emits:["update:email","update:code"],setup(e){const l=e,t=r(e,"email"),u=r(e,"code"),s=o(""),n=o("");k((()=>l.modelValue),(e=>{e&&e!==t.value&&(t.value=e)}),{immediate:!0});const{t:h}=i(),m=$(),y=o(h("Send Email Verification Code")),P=o(!1),U=d((()=>l.modelValue&&l.modelValue.length>0||t.value.length>0)),I=async()=>{var e;const u=l.modelValue||t.value.toString();if(!U.value)return m.error(h("Please enter your email first"));if(!s.value)return m.error(h("Please enter captcha"));if(!n.value)return m.error(h("Captcha key is missing, please refresh the captcha"));const r=await a({body:{event:l.event,email:u,captcha:s.value,captcha_key:n.value}});"success"===(null==(e=r.data)?void 0:e.status)?(()=>{let e=60;P.value=!0;const a=setInterval((()=>{e--,y.value=h("Resend after {seconds} seconds",{seconds:e}),e<=0&&(P.value=!1,y.value=h("Send Email Verification Code"),clearInterval(a))}),1e3)})():m.error(r.data.message)};return(e,a)=>l.disabled?S(e.$slots,"default",{key:0,sendVerifyCode:I,btnDisabled:P.value,btnText:y.value}):(g(),b(_,{key:1},[f(p(M),{label:e.$t("Email"),"show-require-mark":""},{default:v((()=>[f(p(w),null,{default:v((()=>[f(p(x),{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),"input-props":{type:"email",required:!0},placeholder:e.$t("Please enter your email"),size:l.size},null,8,["value","placeholder","size"])])),_:1})])),_:1},8,["label"]),U.value?(g(),c(p(M),{key:0,label:e.$t("Captcha"),"show-require-mark":""},{default:v((()=>[f(j,{captcha:s.value,"onUpdate:captcha":a[1]||(a[1]=e=>s.value=e),"captcha-key":n.value,"onUpdate:captchaKey":a[2]||(a[2]=e=>n.value=e),size:l.size},null,8,["captcha","captcha-key","size"])])),_:1},8,["label"])):V("",!0),f(p(M),{label:e.$t("Email Verification Code"),"show-require-mark":""},{default:v((()=>[f(p(x),{value:u.value,"onUpdate:value":a[3]||(a[3]=e=>u.value=e),"input-props":{required:!0},placeholder:e.$t("Please enter the email verification code"),size:l.size},{suffix:v((()=>[f(p(q),{text:"",type:"info",onClick:I,disabled:P.value||!l.modelValue&&!t.value||U.value&&!s.value},{default:v((()=>[C(z(y.value),1)])),_:1},8,["disabled"])])),_:1},8,["value","placeholder","size"])])),_:1},8,["label"])],64))}}),B=u({__name:"PhoneVerifyInput",props:s({event:{type:String,required:!0},size:{type:String,default:()=>"medium"},modelValue:{type:String,default:void 0},modelValueCountryCode:{type:String,default:void 0},disabled:{type:Boolean,default:!1}},{countryCode:{default:"cn"},countryCodeModifiers:{},phone:{default:""},phoneModifiers:{},code:{default:""},codeModifiers:{}}),emits:["update:countryCode","update:phone","update:code"],setup(e){const a=e,u=r(e,"countryCode"),s=r(e,"phone"),n=r(e,"code"),h=o(""),m=o("");k((()=>a.modelValue),(e=>{e&&e!==s.value&&(s.value=e)}),{immediate:!0}),k((()=>a.modelValueCountryCode),(e=>{e&&e!==u.value&&(u.value=e)}),{immediate:!0});const{t:y}=i(),U=$(),I=l(),K=o(y("Send SMS Verification Code")),E=o(!1),B=d((()=>a.modelValue&&a.modelValue.length>0||s.value.length>0)),F=I.getSelectOptionCountryCodes(),D=e=>{var a,l;return(null==(l=null==(a=e.option.label)?void 0:a.toString())?void 0:l.match(/^\+\d+/))||""},H=async()=>{var e;const l=a.modelValue||s.value.toString(),r=a.modelValueCountryCode||u.value.toString();if(!B.value)return U.error(y("Please enter your mobile number first"));if(!h.value)return U.error(y("Please enter captcha"));if(!m.value)return U.error(y("Captcha key is missing, please refresh the captcha"));const i=await t({body:{event:a.event,country_code:r,phone:l,captcha:h.value,captcha_key:m.value}});"success"===(null==(e=i.data)?void 0:e.status)?(()=>{let e=60;E.value=!0;const a=setInterval((()=>{e--,K.value=y("Resend after {seconds} seconds",{seconds:e}),e<=0&&(E.value=!1,K.value=y("Send SMS Verification Code"),clearInterval(a))}),1e3)})():U.error(i.data.message)};return(e,l)=>a.disabled?S(e.$slots,"default",{key:0,sendVerifyCode:H,btnDisabled:E.value,btnText:K.value}):(g(),b(_,{key:1},[f(p(M),{label:e.$t("Mobile Number"),"show-require-mark":""},{default:v((()=>[f(p(w),null,{default:v((()=>[f(p(P),{options:p(F),"render-tag":D,"consistent-menu-width":!1,value:u.value,"onUpdate:value":l[0]||(l[0]=e=>u.value=e),class:"w-40",size:a.size,filterable:"",placeholder:e.$t("Select Country")},null,8,["options","value","size","placeholder"]),f(p(x),{value:s.value,"onUpdate:value":l[1]||(l[1]=e=>s.value=e),placeholder:e.$t("Please enter your mobile number"),"input-props":{required:!0},size:a.size},null,8,["value","placeholder","size"])])),_:1})])),_:1},8,["label"]),B.value?(g(),c(p(M),{key:0,label:e.$t("Captcha"),"show-require-mark":""},{default:v((()=>[f(j,{captcha:h.value,"onUpdate:captcha":l[2]||(l[2]=e=>h.value=e),"captcha-key":m.value,"onUpdate:captchaKey":l[3]||(l[3]=e=>m.value=e),size:a.size},null,8,["captcha","captcha-key","size"])])),_:1},8,["label"])):V("",!0),f(p(M),{label:e.$t("SMS Verification Code"),"show-require-mark":""},{default:v((()=>[f(p(x),{value:n.value,"onUpdate:value":l[4]||(l[4]=e=>n.value=e),"input-props":{required:!0},placeholder:e.$t("Please enter the SMS verification code"),size:a.size},{suffix:v((()=>[f(p(q),{text:"",type:"info",onClick:H,disabled:E.value||!a.modelValue&&!s.value||B.value&&!h.value},{default:v((()=>[C(z(K.value),1)])),_:1},8,["disabled"])])),_:1},8,["value","placeholder","size"])])),_:1},8,["label"])],64))}});export{E as _,B as a,j as b};
