import{m as e,k as t,$ as a,r as s,N as r,Q as o,P as l,Y as n,M as i,j as u,a7 as d,a9 as c,L as p}from"./vue-vendors-B4XdlKKZ.js";import{_ as m}from"./Content.vue_vue_type_script_setup_true_lang-CEfikmAR.js";import{n as f,u as y,s as h,_ as v,S as _}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{_ as w}from"./DataTable.vue_vue_type_script_setup_true_lang-Dzev82sr.js";import{B as g,C as k,D as x}from"./index-DZdj2b_n.js";import{t as C,m as j,G as b,S as $,T as L,B as D,r as T,o as S}from"./naive-ui-DFBPfLe9.js";import{D as P}from"./icons-C1_zt0kT.js";import"./photo-components-DTzq5atJ.js";import"./utils-DGAJShNI.js";const z={password:function(t,a={}){return e(C,{type:"password",showPasswordOn:"click",defaultValue:t,...a})}},A={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},W={class:"grow md:grow-0 md:basis-1/2"},K=t({__name:"IndexView",setup(t){const K=j(),M=b(),{t:N}=a(),U=s(),V=[{type:"selection"},{title:N("Type"),key:"type",width:100,align:"center",render:t=>e($,null,{default:()=>"photo"===t.type?N("Photo"):N("Album")})},{title:N("Password"),key:"password",minWidth:180,render:e=>e.password?z.password(e.password,{size:"small",onChange(t){g({path:{id:e.id},body:{password:t}}).then((()=>{K.success(N("Successfully updated"))})).catch((()=>{K.error(N("Modification failed"))}))}}):N("None")},{title:N("Views"),key:"view_count",minWidth:100,align:"center",sorter:!0,render:e=>f.format(e.view_count)},{title:N("Expiration Time"),minWidth:200,key:"expired_at",sorter:!0,align:"center",render:e=>e.expired_at?y(e.expired_at).format("LLL"):N("None")},{title:N("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>y(e.created_at).format("LLL")},{title:N("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:t=>e(L,{vertical:!1,size:5,justify:"center"},{default:()=>[e(D,{size:"small",onClick:()=>{h.copyText(`${window.location.origin}/shares/${t.slug}`).then((()=>{K.success(N("Copy successful"))})).catch((()=>{K.error(N("Copy failed"))}))}},{default:()=>N("Copy Link")}),e(D,{size:"small",type:"error",onClick:()=>{G([t.id],{title:N("Delete Share"),content:N("Are you sure you want to delete this share?")})}},{default:()=>N("Delete")})]})}],q=s(""),B=s("sort:latest"),E=s([]),I=e=>x({query:{page:e,per_page:40,q:`${q.value} ${B.value}`.trim()}});function R(e){var t;e.order?B.value=`sort:${e.columnKey}:${e.order}`:B.value="sort:latest",null==(t=U.value)||t.refresh()}function G(e,t){const a=M.warning({positiveText:N("Confirm"),negativeText:N("Cancel"),onPositiveClick:()=>(a.loading=!0,new Promise((t=>{k({body:e}).then((()=>{var e;K.success(N("Deleted successfully")),E.value=[],null==(e=U.value)||e.refresh(),t(!0)})).finally((()=>{a.loading=!1}))}))),...t})}function O(){var e;null==(e=U.value)||e.refresh()}return(e,t)=>(p(),r(v,{"header-title":e.$t("My Shares"),"toggle-header":!1,"show-footer":!1},{default:o((()=>[l(m,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:o((()=>[l(n(T),null,{default:o((()=>[l(n(L),{vertical:""},{default:o((()=>[i("div",A,[i("div",null,[l(n(D),{type:"error",size:"small",disabled:E.value.length<=0,onClick:t[0]||(t[0]=()=>{G(E.value.map((e=>e)),{title:n(N)("Delete Share"),content:n(N)("Are you sure you want to delete the selected {count} shares?",{count:E.value.length})})})},{icon:o((()=>[l(n(S),{component:n(P)},null,8,["component"])])),default:o((()=>[u(" "+d(e.$t("Delete")),1)])),_:1},8,["disabled"])]),i("div",W,[l(n(C),{value:q.value,"onUpdate:value":t[1]||(t[1]=e=>q.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:c(O,["enter","native"])},{prefix:o((()=>[l(n(S),{component:n(_)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),l(w,{striped:"",ref_key:"tableRef",ref:U,bordered:!1,fetch:I,columns:V,"row-key":e=>e.id,"checked-row-keys":E.value,"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>E.value=e),onUpdateSorter:R},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{K as default};
