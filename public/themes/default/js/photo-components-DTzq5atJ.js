import{N as t,L as e,q as i,O as s,P as n,Q as o,F as a,R as r,S as h,l,A as c,s as d,U as p,V as u,k as m,W as g,r as f,c as v,w,K as y,X as b,Y as _,G as x,v as z,M as S,Z as A}from"./vue-vendors-B4XdlKKZ.js";function R(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?R(Object(i),!0).forEach((function(e){P(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):R(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function P(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function M(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?T(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}var E,I=(function(t){
/*!
    Copyright (c) 2018 Jed Watson.
    Licensed under the MIT License (MIT), see
    http://jedwatson.github.io/classnames
  */
!function(){var e={}.hasOwnProperty;function i(){for(var t=[],s=0;s<arguments.length;s++){var n=arguments[s];if(n){var o=typeof n;if("string"===o||"number"===o)t.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&t.push(a)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var r in n)e.call(n,r)&&n[r]&&t.push(r);else t.push(n.toString())}}return t.join(" ")}t.exports?(i.default=i,t.exports=i):window.classNames=i}()}(E={path:undefined,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&E.path)}},E.exports),E.exports),O=function(t){return function(e,i){if(!e)return t;var s;"string"==typeof e?s=e:i=e;var n=t;return s&&(n+="__"+s),n+(i?Object.keys(i).reduce((function(t,e){var s=i[e];return s&&(t+=" "+("boolean"==typeof s?n+"--"+e:n+"--"+e+"_"+s)),t}),""):"")}};function L(t,e,i){var s,n,o,a,r;function h(){var l=Date.now()-a;l<e&&l>=0?s=setTimeout(h,e-l):(s=null,i||(r=t.apply(o,n),o=n=null))}null==e&&(e=100);var l=function(){o=this,n=arguments,a=Date.now();var l=i&&!s;return s||(s=setTimeout(h,e)),l&&(r=t.apply(o,n),o=n=null),r};return l.clear=function(){s&&(clearTimeout(s),s=null)},l.flush=function(){s&&(r=t.apply(o,n),o=n=null,clearTimeout(s),s=null)},l}L.debounce=L;var D=L,W=function(){return W=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},W.apply(this,arguments)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Z(t,e){var i,s;return t&&e?(i=""+t+e[0].toUpperCase()+e.slice(1),s=t+"-"+e):(i=t||e,s=t||e),{name:i,classname:s}}function H(t){return/^blob:/.test(t)}function B(t){return H(t)||/^data:/.test(t)}function k(t){return!!(t&&t.constructor&&t.call&&t.apply)}function F(t){return void 0===t}function $(t){return"object"==typeof t&&null!==t}function j(t,e,i){var s={};return $(t)?(Object.keys(e).forEach((function(n){F(t[n])?s[n]=e[n]:$(e[n])?$(t[n])?s[n]=j(t[n],e[n],i[n]):s[n]=t[n]?e[n]:i[n]:!0===e[n]||!1===e[n]?s[n]=Boolean(t[n]):s[n]=t[n]})),s):t?e:i}function N(t){var e=Number(t);return Number.isNaN(e)?t:e}function U(t){return typeof("number"==t||function(t){return"object"==typeof t&&null!==t}(t)&&"[object Number]"==toString.call(t))&&!X(t)}function X(t){return t!=t}function Y(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}var V=function(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.type="manipulateImage",this.move=t,this.scale=e},q=function(t,e){void 0===e&&(e={}),this.type="resize",this.directions=t,this.params=e},G=function(t){this.type="move",this.directions=t},K=function(){function t(t,e,i,s,n){this.type="drag",this.nativeEvent=t,this.position=i,this.previousPosition=s,this.element=e,this.anchor=n}return t.prototype.shift=function(){var t=this,e=t.element,i=t.anchor,s=t.position;if(e){var n=e.getBoundingClientRect(),o=n.left,a=n.top;return{left:s.left-o-i.left,top:s.top-a-i.top}}return{left:0,top:0}},t}(),Q={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(t){t.cancelable&&!this.disabled&&1===t.touches.length&&(this.touches=M(t.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),t.touches.length&&this.initAnchor(this.touches.reduce((function(e,i){return{clientX:e.clientX+i.clientX/t.touches.length,clientY:e.clientY+i.clientY/t.touches.length}}),{clientX:0,clientY:0})),t.preventDefault&&t.preventDefault(),t.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(t){this.touches.length&&(this.processMove(t,t.touches),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())},onMouseDown:function(t){if(!this.disabled){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.draggable.getBoundingClientRect(),i=e.left,s=e.right,n=e.bottom,o=e.top;this.anchor={left:t.clientX-i,top:t.clientY-o,bottom:n-t.clientY,right:s-t.clientX}},processMove:function(t,e){var i=M(e);if(this.touches.length){if(1===this.touches.length&&1===i.length){var s=this.$refs.draggable;this.$emit("drag",new K(t,s,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"],render:function(s,n,o,a,r,h){return e(),t("div",{ref:"draggable",class:o.classname,onTouchstart:n[1]||(n[1]=function(){return h.onTouchStart&&h.onTouchStart.apply(h,arguments)}),onMousedown:n[2]||(n[2]=function(){return h.onMouseDown&&h.onMouseDown.apply(h,arguments)}),onMouseover:n[3]||(n[3]=function(){return h.onMouseOver&&h.onMouseOver.apply(h,arguments)}),onMouseleave:n[4]||(n[4]=function(){return h.onMouseLeave&&h.onMouseLeave.apply(h,arguments)})},[i(s.$slots,"default")],34)}},J=O("vue-handler-wrapper"),tt={name:"HandlerWrapper",components:{DraggableElement:Q},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var t;if(this.horizontalPosition||this.verticalPosition){var e,i=Z(this.horizontalPosition,this.verticalPosition);t=J((P(e={},i.classname,!0),P(e,"disabled",this.disabled),e))}else t=J({disabled:this.disabled});return{root:t,draggable:J("draggable")}}},emits:["leave","enter","drag","drag-end"],render:function(a,r,h,l,c,d){var p=s("DraggableElement");return e(),t("div",{class:d.classes.root},[n(p,{class:d.classes.draggable,onDrag:r[1]||(r[1]=function(t){return a.$emit("drag",t)}),onDragEnd:r[2]||(r[2]=function(t){return a.$emit("drag-end")}),onLeave:r[3]||(r[3]=function(t){return a.$emit("leave")}),onEnter:r[4]||(r[4]=function(t){return a.$emit("enter")})},{default:o((function(){return[i(a.$slots,"default")]})),_:3},8,["class"])],2)}},et=O("vue-line-wrapper"),it={name:"LineWrapper",components:{DraggableElement:Q},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var t;return et((P(t={},this.position,!0),P(t,"disabled",this.disabled),t))}},emits:["leave","enter","drag","drag-end"],render:function(n,a,r,h,l,c){var d=s("DraggableElement");return e(),t(d,{class:c.classname,onDrag:a[1]||(a[1]=function(t){return n.$emit("drag",t)}),onDragEnd:a[2]||(a[2]=function(t){return n.$emit("drag-end")}),onLeave:a[3]||(a[3]=function(t){return n.$emit("leave")}),onEnter:a[4]||(a[4]=function(t){return n.$emit("enter")})},{default:o((function(){return[i(n.$slots,"default")]})),_:3},8,["class"])}},st=["left","right","top","bottom"],nt=["left","right"],ot=["top","bottom"],at=["left","top"],rt=["fill-area","fit-area","stencil","none"],ht={left:0,top:0,width:0,height:0};function lt(t,e,i){return!(i=i||["width","height","left","top"]).some((function(i){return t[i]!==e[i]}))}function ct(t){return{left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height}}function dt(t,e){return{left:t.left-e.left,top:t.top-e.top}}function pt(t){return{left:t.left+t.width/2,top:t.top+t.height/2}}function ut(t,e){var i={left:0,top:0,right:0,bottom:0};return st.forEach((function(s){var n=e[s],o=ct(t)[s];i[s]=void 0!==n&&void 0!==o?"left"===s||"top"===s?Math.max(0,n-o):Math.max(0,o-n):0})),i}function mt(t,e){return{left:t.left-e.left,top:t.top-e.top,width:t.width+e.left+e.right,height:t.height+e.top+e.bottom}}function gt(t){return{left:-t.left,top:-t.top}}function ft(t,e){return W(W({},t),{left:t.left+e.left,top:t.top+e.top})}function vt(t,e,i,s){if(1!==e){if(i){var n=pt(t);return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2+(i.left-n.left)*(1-e),top:t.top+t.height*(1-e)/2+(i.top-n.top)*(1-e)}}return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2,top:t.top+t.height*(1-e)/2}}return t}function wt(t){return t.width/t.height}function yt(t,e){return Math.min(void 0!==e.right&&void 0!==e.left?(e.right-e.left)/t.width:1/0,void 0!==e.bottom&&void 0!==e.top?(e.bottom-e.top)/t.height:1/0)}function bt(t,e){var i={left:0,top:0},s=ut(t,e);return s.left&&s.left>0?i.left=s.left:s.right&&s.right>0&&(i.left=-s.right),s.top&&s.top>0?i.top=s.top:s.bottom&&s.bottom>0&&(i.top=-s.bottom),i}function _t(t,e){var i;return e.minimum&&t<e.minimum?i=e.minimum:e.maximum&&t>e.maximum&&(i=e.maximum),i}function xt(t,e){var i=wt(t),s=wt(e);return e.width<1/0&&e.height<1/0?i>s?{width:e.width,height:e.width/i}:{width:e.height*i,height:e.height}:e.width<1/0?{width:e.width,height:e.width/i}:e.height<1/0?{width:e.height*i,height:e.height}:t}function zt(t,e){var i=e*Math.PI/180;return{width:Math.abs(t.width*Math.cos(i))+Math.abs(t.height*Math.sin(i)),height:Math.abs(t.width*Math.sin(i))+Math.abs(t.height*Math.cos(i))}}function St(t,e){var i=e*Math.PI/180;return{left:t.left*Math.cos(i)-t.top*Math.sin(i),top:t.left*Math.sin(i)+t.top*Math.cos(i)}}function At(t,e){var i=ut(Rt(t,e),e);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((t.width+i.left+i.right)/t.width,yt(t,e)):Math.min((t.height+i.top+i.bottom)/t.height,yt(t,e)):1}function Rt(t,e,i){void 0===i&&(i=!1);var s=bt(t,e);return ft(t,i?gt(s):s)}function Ct(t){return{width:void 0!==t.right&&void 0!==t.left?t.right-t.left:1/0,height:void 0!==t.bottom&&void 0!==t.top?t.bottom-t.top:1/0}}function Pt(t,e,i){void 0===i&&(i=!0);var s={};return st.forEach((function(n){var o=t[n],a=e[n];void 0!==o&&void 0!==a?s[n]="left"===n||"top"===n?i?Math.max(o,a):Math.min(o,a):i?Math.min(o,a):Math.max(o,a):void 0!==a?s[n]=a:void 0!==o&&(s[n]=o)})),s}function Mt(t,e){return Pt(t,e,!0)}function Tt(t){var e=t.size,i=t.aspectRatio,s=t.ignoreMinimum,n=t.sizeRestrictions;return Boolean((e.correctRatio||wt(e)>=i.minimum&&wt(e)<=i.maximum)&&e.height<=n.maxHeight&&e.width<=n.maxWidth&&e.width&&e.height&&(s||e.height>=n.minHeight&&e.width>=n.minWidth))}function Et(t,e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)}function It(t){var e=t.width,i=t.height,s=t.sizeRestrictions,n={minimum:t.aspectRatio&&t.aspectRatio.minimum||0,maximum:t.aspectRatio&&t.aspectRatio.maximum||1/0},o={width:Math.max(s.minWidth,Math.min(s.maxWidth,e)),height:Math.max(s.minHeight,Math.min(s.maxHeight,i))};function a(t,o){return void 0===o&&(o=!1),t.reduce((function(t,a){return Tt({size:a,aspectRatio:n,sizeRestrictions:s,ignoreMinimum:o})&&(!t||Et(a,{width:e,height:i})<Et(t,{width:e,height:i}))?a:t}),null)}var r=[];n&&[n.minimum,n.maximum].forEach((function(t){t&&r.push({width:o.width,height:o.width/t,correctRatio:!0},{width:o.height*t,height:o.height,correctRatio:!0})})),Tt({size:o,aspectRatio:n,sizeRestrictions:s})&&r.push(o);var h=a(r)||a(r,!0);return h&&{width:h.width,height:h.height}}function Ot(t){var e=t.event,i=t.coordinates,s=t.positionRestrictions,n=void 0===s?{}:s,o=ft(i,e.directions);return ft(o,bt(o,n))}function Lt(t){t.event;var e=t.getAreaRestrictions,i=t.boundaries,s=t.coordinates,n=t.visibleArea;t.aspectRatio;var o=t.stencilSize,a=t.sizeRestrictions,r=t.positionRestrictions;t.stencilReference;var h,l,c,d=W({},s),p=W({},n),u=W({},o);h=wt(u),l=wt(d),void 0===c&&(c=.001),(0===h||0===l?Math.abs(l-h)<c:Math.abs(l/h)<1+c&&Math.abs(l/h)>1-c)||(d=W(W({},d),It({sizeRestrictions:a,width:d.width,height:d.height,aspectRatio:{minimum:wt(u),maximum:wt(u)}})));var m=At(p=vt(p,d.width*i.width/(p.width*u.width)),e({visibleArea:p,type:"resize"}));return 1!==m&&(p=vt(p,m),d=vt(d,m)),p=Rt(p=ft(p,dt(pt(d),pt(p))),e({visibleArea:p,type:"move"})),{coordinates:d=Rt(d,Mt(ct(p),r)),visibleArea:p}}function Dt(t){var e=t.event,i=t.getAreaRestrictions,s=t.boundaries,n=t.coordinates,o=t.visibleArea;t.aspectRatio,t.stencilSize,t.sizeRestrictions;var a=t.positionRestrictions;t.stencilReference;var r=W({},n),h=W({},o);if(n&&o&&"manipulateImage"!==e.type){var l={width:0,height:0};h.width,s.width,wt(s)>wt(r)?(l.height=.8*s.height,l.width=l.height*wt(r)):(l.width=.8*s.width,l.height=l.width*wt(r));var c=At(h=vt(h,r.width*s.width/(h.width*l.width)),i({visibleArea:h,type:"resize"}));h=vt(h,c),1!==c&&(l.height/=c,l.width/=c),h=Rt(h=ft(h,dt(pt(r),pt(h))),i({visibleArea:h,type:"move"})),r=Rt(r,Mt(ct(h),a))}return{coordinates:r,visibleArea:h}}function Wt(t){var e=t.event,i=t.coordinates,s=t.visibleArea,n=t.getAreaRestrictions,o=W({},s),a=W({},i);if("setCoordinates"===e.type){var r=Math.max(0,a.width-o.width),h=Math.max(0,a.height-o.height);r>h?o=vt(o,Math.min(a.width/o.width,yt(o,n({visibleArea:o,type:"resize"})))):h>r&&(o=vt(o,Math.min(a.height/o.height,yt(o,n({visibleArea:o,type:"resize"}))))),o=Rt(o=ft(o,gt(bt(a,ct(o)))),n({visibleArea:o,type:"move"}))}return{visibleArea:o,coordinates:a}}function Zt(t){var e=t.imageSize,i=t.visibleArea,s=t.coordinates,n=i||e;return{left:(i?i.left:0)+n.width/2-s.width/2,top:(i?i.top:0)+n.height/2-s.height/2}}function Ht(t){var e=t.imageSize,i=t.visibleArea,s=t.aspectRatio,n=t.sizeRestrictions,o=i||e,a=Math.min(s.maximum||1/0,Math.max(s.minimum||0,wt(o))),r=o.width<o.height?{width:.8*o.width,height:.8*o.width/a}:{height:.8*o.height,width:.8*o.height*a};return It(W(W({},r),{aspectRatio:s,sizeRestrictions:n}))}function Bt(t){var e,i,s=t.imageSize,n=t.visibleArea,o=t.boundaries,a=t.aspectRatio,r=t.sizeRestrictions,h=t.stencilSize,l=n||s;return wt(l)>wt(o)?i=(e=h.height*l.height/o.height)*wt(h):e=(i=h.width*l.width/o.width)/wt(h),It({width:i,height:e,aspectRatio:a,sizeRestrictions:r})}function kt(t){var e=t.getAreaRestrictions,i=t.coordinates,s=t.imageSize,n=wt(t.boundaries);if(i){var o={height:Math.max(i.height,s.height),width:Math.max(i.width,s.width)},a=xt({width:wt(o)>n?o.width:o.height*n,height:wt(o)>n?o.width/n:o.height},Ct(e())),r={left:i.left+i.width/2-a.width/2,top:i.top+i.height/2-a.height/2,width:a.width,height:a.height},h=ut(i,ct(W({left:0,top:0},s))),l={};return!h.left&&!h.right&&r.width<=s.width&&(l.left=0,l.right=s.width),!h.top&&!h.bottom&&r.height<=s.height&&(l.top=0,l.bottom=s.height),Rt(r,l)}var c=wt(s);return a={height:c>n?s.height:s.width/n,width:c>n?s.height*n:s.width},{left:s.width/2-a.width/2,top:s.height/2-a.height/2,width:a.width,height:a.height}}function Ft(t,e){return Pt(t,ct(e))}function $t(t){var e=t.directions,i=t.coordinates,s=t.positionRestrictions,n=void 0===s?{}:s,o=t.sizeRestrictions,a=t.preserveRatio,r=t.compensate,h=W({},e),l=mt(i,h).width,c=mt(i,h).height;l<0&&(h.left<0&&h.right<0?(h.left=-(i.width-o.minWidth)/(h.left/h.right),h.right=-(i.width-o.minWidth)/(h.right/h.left)):h.left<0?h.left=-(i.width-o.minWidth):h.right<0&&(h.right=-(i.width-o.minWidth))),c<0&&(h.top<0&&h.bottom<0?(h.top=-(i.height-o.minHeight)/(h.top/h.bottom),h.bottom=-(i.height-o.minHeight)/(h.bottom/h.top)):h.top<0?h.top=-(i.height-o.minHeight):h.bottom<0&&(h.bottom=-(i.height-o.minHeight)));var d=ut(mt(i,h),n);r&&(d.left&&d.left>0&&0===d.right?(h.right+=d.left,h.left-=d.left):d.right&&d.right>0&&0===d.left&&(h.left+=d.right,h.right-=d.right),d.top&&d.top>0&&0===d.bottom?(h.bottom+=d.top,h.top-=d.top):d.bottom&&d.bottom>0&&0===d.top&&(h.top+=d.bottom,h.bottom-=d.bottom),d=ut(mt(i,h),n));var p={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(st.forEach((function(t){var e=d[t];e&&h[t]&&(p[t]=Math.max(0,1-e/h[t]))})),a){var u=Math.min.apply(null,st.map((function(t){return p[t]})));u!==1/0&&st.forEach((function(t){h[t]*=u}))}else st.forEach((function(t){p[t]!==1/0&&(h[t]*=p[t])}));if(l=mt(i,h).width,c=mt(i,h).height,h.right+h.left&&(l>o.maxWidth?p.width=(o.maxWidth-i.width)/(h.right+h.left):l<o.minWidth&&(p.width=(o.minWidth-i.width)/(h.right+h.left))),h.bottom+h.top&&(c>o.maxHeight?p.height=(o.maxHeight-i.height)/(h.bottom+h.top):c<o.minHeight&&(p.height=(o.minHeight-i.height)/(h.bottom+h.top))),a){var m=Math.min(p.width,p.height);m!==1/0&&st.forEach((function(t){h[t]*=m}))}else p.width!==1/0&&nt.forEach((function(t){h[t]*=p.width})),p.height!==1/0&&ot.forEach((function(t){h[t]*=p.height}));return h}function jt(t,e,i){return 0==e&&0==i?t/2:0==e?0:0==i?t:t*Math.abs(e/(e+i))}var Nt=O("vue-simple-handler"),Ut=O("vue-simple-handler-wrapper"),Xt={name:"SimpleHandler",components:{HandlerWrapper:tt},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var t,e=(P(t={},this.horizontalPosition,Boolean(this.horizontalPosition)),P(t,this.verticalPosition,Boolean(this.verticalPosition)),P(t,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),Boolean(this.verticalPosition&&this.horizontalPosition)),P(t,"hover",this.hover),t);return{default:I(Nt(e),this.defaultClass,this.hover&&this.hoverClass),wrapper:I(Ut(e),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"],render:function(i,a,r,h,l,c){var d=s("HandlerWrapper");return e(),t(d,{class:c.classes.wrapper,"vertical-position":r.verticalPosition,"horizontal-position":r.horizontalPosition,disabled:r.disabled,onDrag:c.onDrag,onDragEnd:c.onDragEnd,onEnter:c.onEnter,onLeave:c.onLeave},{default:o((function(){return[n("div",{class:c.classes.default},null,2)]})),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])}},Yt=O("vue-simple-line"),Vt=O("vue-simple-line-wrapper"),qt={name:"SimpleLine",components:{LineWrapper:it},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:I(Yt(P({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:I(Vt(P({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"],render:function(i,a,r,h,l,c){var d=s("LineWrapper");return e(),t(d,{class:c.classes.wrapper,position:r.position,disabled:r.disabled,onDrag:c.onDrag,onDragEnd:c.onDragEnd,onEnter:c.onEnter,onLeave:c.onLeave},{default:o((function(){return[n("div",{class:c.classes.root},null,2)]})),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])}},Gt=O("vue-bounding-box"),Kt=["east","west",null],Qt=["south","north",null],Jt={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return Xt}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return qt}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var t=[];return Kt.forEach((function(e){Qt.forEach((function(i){if(e!==i){var s=Z(e,i),n=s.name,o=s.classname;t.push({name:n,classname:o,verticalDirection:i,horizontalDirection:e})}}))})),{points:t}},computed:{style:function(){var t={};return this.width&&this.height&&(t.width="".concat(this.width,"px"),t.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),t},classes:function(){var t=this.handlersClasses,e=this.handlersWrappersClasses,i=this.linesClasses,s=this.linesWrappersClasses;return{root:Gt(),handlers:t,handlersWrappers:e,lines:i,linesWrappers:s}},lineNodes:function(){var t=this,e=[];return this.points.forEach((function(i){i.horizontalDirection&&i.verticalDirection||!t.lines[i.name]||e.push({name:i.name,component:t.linesComponent,class:I(t.classes.lines.default,t.classes.lines[i.name],!t.resizable&&t.classes.lines.disabled),wrapperClass:I(t.classes.linesWrappers.default,t.classes.linesWrappers[i.name],!t.resizable&&t.classes.linesWrappers.disabled),hoverClass:t.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!t.resizable})})),e},handlerNodes:function(){var t=this,e=[],i=this.width,s=this.height;return this.points.forEach((function(n){if(t.handlers[n.name]){var o={name:n.name,component:t.handlersComponent,class:I(t.classes.handlers.default,t.classes.handlers[n.name]),wrapperClass:I(t.classes.handlersWrappers.default,t.classes.handlersWrappers[n.name]),hoverClass:t.classes.handlers.hover,verticalDirection:n.verticalDirection,horizontalDirection:n.horizontalDirection,disabled:!t.resizable};if(i&&s){var a=n.horizontalDirection,r=n.verticalDirection,h="east"===a?i:"west"===a?0:i/2,l="south"===r?s:"north"===r?0:s/2;o.wrapperClass=Gt("handler"),o.wrapperStyle={transform:"translate(".concat(h,"px, ").concat(l,"px)")},t.transitions&&t.transitions.enabled&&(o.wrapperStyle.transition="".concat(t.transitions.time,"ms ").concat(t.transitions.timingFunction))}else o.wrapperClass=Gt("handler",P({},n.classname,!0));e.push(o)}})),e}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(t,e,i){var s,n=t.shift(),o=n.left,a=n.top,r={left:0,right:0,top:0,bottom:0};"west"===e?r.left-=o:"east"===e&&(r.right+=o),"north"===i?r.top-=a:"south"===i&&(r.bottom+=a),!i&&e?s="width":i&&!e&&(s="height"),this.resizable&&this.$emit("resize",new q(r,{allowedDirections:{left:"west"===e||!e,right:"east"===e||!e,bottom:"south"===i||!i,top:"north"===i||!i},preserveAspectRatio:t.nativeEvent&&t.nativeEvent.shiftKey,respectDirection:s}))}},emits:["resize","resize-end"],render:function(s,o,l,c,d,p){return e(),t("div",{ref:"box",class:p.classes.root,style:p.style},[i(s.$slots,"default"),n("div",null,[(e(!0),t(a,null,r(p.lineNodes,(function(i){return e(),t(h(i.component),{key:i.name,"default-class":i.class,"hover-class":i.hoverClass,"wrapper-class":i.wrapperClass,position:i.name,disabled:i.disabled,onDrag:function(t){return p.onHandlerDrag(t,i.horizontalDirection,i.verticalDirection)},onDragEnd:o[1]||(o[1]=function(t){return p.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])})),128))]),(e(!0),t(a,null,r(p.handlerNodes,(function(i){return e(),t("div",{key:i.name,style:i.wrapperStyle,class:i.wrapperClass},[(e(),t(h(i.component),{"default-class":i.class,"hover-class":i.hoverClass,"wrapper-class":i.wrapperClass,"horizontal-position":i.horizontalDirection,"vertical-position":i.verticalDirection,disabled:i.disabled,onDrag:function(t){return p.onHandlerDrag(t,i.horizontalDirection,i.verticalDirection)},onDragEnd:o[2]||(o[2]=function(t){return p.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)})),128))],6)}},te=O("vue-draggable-area"),ee={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:te()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(t){if(t.cancelable){var e=this.movable&&1===t.touches.length;e&&(this.touches=M(t.touches)),(this.touchStarted||e)&&(t.preventDefault(),t.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(t){this.touches.length>=1&&(this.touchStarted?(this.processMove(t,t.touches),t.preventDefault(),t.stopPropagation()):Y({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:t.touches[0].clientX,y:t.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(t){if(this.movable&&0===t.button){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.cancelable&&t.preventDefault(),t.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.container.getBoundingClientRect(),i=e.left,s=e.top;this.anchor={x:t.clientX-i,y:t.clientY-s}},processMove:function(t,e){var i=M(e);if(this.touches.length){var s=this.$refs.container.getBoundingClientRect(),n=s.left,o=s.top;1===this.touches.length&&1===i.length&&this.$emit("move",new G({left:i[0].clientX-(n+this.anchor.x),top:i[0].clientY-(o+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};function ie(t){var e,i;return{rotate:t.rotate||0,flip:{horizontal:(null===(e=null==t?void 0:t.flip)||void 0===e?void 0:e.horizontal)||!1,vertical:(null===(i=null==t?void 0:t.flip)||void 0===i?void 0:i.vertical)||!1}}}function se(t){var e=t.rotate,i=t.flip,s=t.scaleX,n=t.scaleY,o="";return o+=" rotate("+e+"deg) ",(o+=" scaleX("+s*(i.horizontal?-1:1)+") ")+" scaleY("+n*(i.vertical?-1:1)+") "}function ne(t,e){var i=e.getBoundingClientRect(),s=i.left,n=i.top,o={left:0,top:0},a=0;return t.forEach((function(e){o.left+=(e.clientX-s)/t.length,o.top+=(e.clientY-n)/t.length})),t.forEach((function(t){a+=Y({x:o.left,y:o.top},{x:t.clientX-s,y:t.clientY-n})})),{centerMass:o,spread:a,count:t.length}}ee.render=function(s,n,o,a,r,h){return e(),t("div",{ref:"container",onTouchstart:n[1]||(n[1]=function(){return h.onTouchStart&&h.onTouchStart.apply(h,arguments)}),onMousedown:n[2]||(n[2]=function(){return h.onMouseDown&&h.onMouseDown.apply(h,arguments)})},[i(s.$slots,"default")],544)};var oe={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=D(this.processEnd),this.touches=[]},methods:{processMove:function(t,e){if(this.touches.length){if(1===this.touches.length&&1===e.length)this.$emit("move",new V({left:this.touches[0].clientX-e[0].clientX,top:this.touches[0].clientY-e[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=ne(e,this.$refs.container),s=this.oldGeometricProperties;s.count===i.count&&s.count>1&&this.$emit("resize",new V({left:s.centerMass.left-i.centerMass.left,top:s.centerMass.top-i.centerMass.top},{factor:s.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=e}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(t){return this.eventsFilter?!1!==this.eventsFilter(t,this.transforming):(t.preventDefault(),t.stopPropagation(),!0)},onTouchStart:function(t){if(t.cancelable&&(this.touchMove||this.touchResize&&t.touches.length>1)&&this.processEvent(t)){var e=this.$refs.container,i=e.getBoundingClientRect(),s=i.left,n=i.top,o=i.bottom,a=i.right;this.touches=M(t.touches).filter((function(t){return t.clientX>s&&t.clientX<a&&t.clientY>n&&t.clientY<o})),this.oldGeometricProperties=ne(this.touches,e)}},onTouchEnd:function(t){0===t.touches.length&&(this.touches=[],this.processEnd())},onTouchMove:function(t){var e=this;if(this.touches.length){var i=M(t.touches).filter((function(t){return!t.identifier||e.touches.find((function(e){return e.identifier===t.identifier}))}));this.processEvent(t)&&(this.processMove(t,i),this.processStart())}},onMouseDown:function(t){if(this.mouseMove&&"buttons"in t&&1===t.buttons&&this.processEvent(t)){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.processStart()}},onMouseMove:function(t){this.touches.length&&this.processEvent(t)&&this.processMove(t,[{clientX:t.clientX,clientY:t.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(t){if(this.wheelResize&&this.processEvent(t)){var e=this.$refs.container.getBoundingClientRect(),i=e.left,s=e.top,n=1+this.wheelResize.ratio*(0===(a=+(t.deltaY||t.detail||t.wheelDelta))||X(a)?a:a>0?1:-1),o={left:t.clientX-i,top:t.clientY-s};this.$emit("resize",new V({},{factor:n,center:o})),this.touches.length||this.debouncedProcessEnd()}var a}},emits:["resize","move","transform-end"],render:function(s,n,o,a,r,h){return e(),t("div",{ref:"container",onTouchstart:n[1]||(n[1]=function(){return h.onTouchStart&&h.onTouchStart.apply(h,arguments)}),onMousedown:n[2]||(n[2]=function(){return h.onMouseDown&&h.onMouseDown.apply(h,arguments)}),onWheel:n[3]||(n[3]=function(){return h.onWheel&&h.onWheel.apply(h,arguments)})},[i(s.$slots,"default")],544)}},ae={components:{TransformableImage:oe},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"],render:function(n,a,r,h,l,c){var d=s("transformable-image");return e(),t(d,{"touch-move":r.touchMove,"touch-resize":r.touchResize,"mouse-move":r.mouseMove,"wheel-resize":r.wheelResize,onMove:a[1]||(a[1]=function(t){return n.$emit("move",t)}),onResize:a[2]||(a[2]=function(t){return n.$emit("resize",t)})},{default:o((function(){return[i(n.$slots,"default")]})),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])}},re=O("vue-preview"),he={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:re({fill:this.fill}),wrapper:re("wrapper"),imageWrapper:re("image-wrapper"),image:I(re("image"),this.imageClass)}},style:function(){if(this.fill)return{};var t={};return this.width&&(t.width="".concat(this.size.width,"px")),this.height&&(t.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},wrapperStyle:function(){var t={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},imageStyle:function(){if(this.coordinates&&this.image){var t=this.coordinates.width/this.size.width,e=C(C({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/t,scaleY:1/t}),i=this.imageSize.width,s=this.imageSize.height,n=zt({width:i,height:s},e.rotate),o={width:"".concat(i,"px"),height:"".concat(s,"px"),left:"0px",top:"0px"},a={rotate:{left:(i-n.width)*e.scaleX/2,top:(s-n.height)*e.scaleY/2},scale:{left:(1-e.scaleX)*i/2,top:(1-e.scaleY)*s/2}};return o.transform="translate(\n\t\t\t\t".concat(-this.coordinates.left/t-a.rotate.left-a.scale.left,"px,").concat(-this.coordinates.top/t-a.rotate.top-a.scale.top,"px) ")+se(e),this.transitions&&this.transitions.enabled&&(o.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),o}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(t){(t.width||t.height)&&this.onChangeImage()}},mounted:function(){var t=this;this.onChangeImage(),this.$refs.image.addEventListener("load",(function(){t.refreshImage()})),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var t=this.$refs.image;this.calculatedImageSize.height=t.naturalHeight,this.calculatedImageSize.width=t.naturalWidth},refresh:function(){var t=this.$refs.root;this.width||(this.calculatedSize.width=t.clientWidth),this.height||(this.calculatedSize.height=t.clientHeight)},onChangeImage:function(){var t=this.$refs.image;t&&t.complete&&this.refreshImage(),this.refresh()}},render:function(i,s,o,a,r,h){return e(),t("div",{ref:"root",class:h.classes.root,style:h.style},[n("div",{ref:"wrapper",class:h.classes.wrapper,style:h.wrapperStyle},[l(n("img",{ref:"image",src:o.image&&o.image.src,class:h.classes.image,style:h.imageStyle},null,14,["src"]),[[c,o.image&&o.image.src]])],6)],6)}},le={components:{Preview:he},inheritAttrs:!1,render:function(i,n,o,a,r,h){var l=s("preview");return e(),t(l,d(i.$attrs,{fill:!0}),null,16)}},ce=O("vue-rectangle-stencil"),de={name:"RectangleStencil",components:{StencilPreview:le,BoundingBox:Jt,DraggableArea:ee},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return Xt}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return qt}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:I(ce({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:I(ce("preview"),this.previewClass),boundingBox:I(ce("bounding-box"),this.boundingBoxClass)}},style:function(){var t=this.stencilCoordinates,e=t.height,i=t.width,s=t.left,n=t.top,o={width:"".concat(i,"px"),height:"".concat(e,"px"),transform:"translate(".concat(s,"px, ").concat(n,"px)")};return this.transitions&&this.transitions.enabled&&(o.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),o}},methods:{onMove:function(t){this.$emit("move",t),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(t){this.$emit("resize",t),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"],render:function(i,a,r,h,l,c){var d=s("stencil-preview"),p=s("draggable-area"),u=s("bounding-box");return e(),t("div",{class:c.classes.stencil,style:c.style},[n(u,{width:r.stencilCoordinates.width,height:r.stencilCoordinates.height,transitions:r.transitions,class:c.classes.boundingBox,handlers:r.handlers,"handlers-component":r.handlersComponent,"handlers-classes":r.handlersClasses,"handlers-wrappers-classes":r.handlersWrappersClasses,lines:r.lines,"lines-component":r.linesComponent,"lines-classes":r.linesClasses,"lines-wrappers-classes":r.linesWrappersClasses,resizable:r.resizable,onResize:c.onResize,onResizeEnd:c.onResizeEnd},{default:o((function(){return[n(p,{movable:r.movable,onMove:c.onMove,onMoveEnd:c.onMoveEnd},{default:o((function(){return[n(d,{image:r.image,coordinates:r.coordinates,width:r.stencilCoordinates.width,height:r.stencilCoordinates.height,class:c.classes.preview,transitions:r.transitions},null,8,["image","coordinates","width","height","class","transitions"])]})),_:1},8,["movable","onMove","onMoveEnd"])]})),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)}},pe=["transitions"],ue=O("vue-advanced-cropper"),me={name:"Cropper",components:{BackgroundWrapper:ae},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return de}},backgroundWrapperComponent:{type:[Object,String],default:function(){return ae}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(t){return-1!==rt.indexOf(t)}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(t){return!("string"==typeof t&&"fill"!==t&&"fit"!==t)}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(t){var e=t.event,i=t.coordinates,s=t.aspectRatio,n=t.positionRestrictions,o=t.sizeRestrictions,a=W(W({},i),{right:i.left+i.width,bottom:i.top+i.height}),r=e.params||{},h=W({},e.directions),l=r.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};o.widthFrozen&&(h.left=0,h.right=0),o.heightFrozen&&(h.top=0,h.bottom=0),st.forEach((function(t){l[t]||(h[t]=0)}));var c=mt(a,h=$t({coordinates:a,directions:h,sizeRestrictions:o,positionRestrictions:n})).width,d=mt(a,h).height,p=r.preserveRatio?wt(a):_t(c/d,s);if(p){var u=r.respectDirection;if(u||(u=a.width>=a.height||1===p?"width":"height"),"width"===u){var m=c/p-a.height;if(l.top&&l.bottom){var g=h.top,f=h.bottom;h.bottom=jt(m,f,g),h.top=jt(m,g,f)}else l.bottom?h.bottom=m:l.top?h.top=m:l.right?h.right=0:l.left&&(h.left=0)}else if("height"===u){var v=a.width-d*p;if(l.left&&l.right){var w=h.left,y=h.right;h.left=-jt(v,w,y),h.right=-jt(v,y,w)}else l.left?h.left=-v:l.right?h.right=-v:l.top?h.top=0:l.bottom&&(h.bottom=0)}h=$t({directions:h,coordinates:a,sizeRestrictions:o,positionRestrictions:n,preserveRatio:!0,compensate:r.compensate})}return c=mt(a,h).width,d=mt(a,h).height,(p=r.preserveRatio?wt(a):_t(c/d,s))&&Math.abs(p-c/d)>.001&&st.forEach((function(t){l[t]||(h[t]=0)})),Ot({event:new G({left:-h.left,top:-h.top}),coordinates:{width:i.width+h.right+h.left,height:i.height+h.top+h.bottom,left:i.left,top:i.top},positionRestrictions:n})}},moveAlgorithm:{type:Function,default:Ot},initStretcher:{type:Function,default:function(t){var e=t.stretcher,i=t.imageSize,s=wt(i);e.style.width=i.width+"px",e.style.height=e.clientWidth/s+"px",e.style.width=e.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(t){var e=t.visibleArea,i=t.coordinates,s=t.aspectRatio,n=t.sizeRestrictions,o=t.positionRestrictions,a=W(W({},i),It({width:i.width,height:i.height,aspectRatio:s,sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minHeight:Math.min(e.height,n.minHeight),minWidth:Math.min(e.width,n.minWidth)}}));return Rt(a=ft(a,dt(pt(i),pt(a))),Mt(ct(e),o))}},fitVisibleArea:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,s=t.getAreaRestrictions,n=t.coordinates,o=W({},e);o.height=o.width/wt(i),o.top+=(e.height-o.height)/2,(n.height-o.height>0||n.width-o.width>0)&&(o=vt(o,Math.max(n.height/o.height,n.width/o.width)));var a=gt(bt(n,ct(o=vt(o,At(o,s({visibleArea:o,type:"resize"}))))));return o.width<n.width&&(a.left=0),o.height<n.height&&(a.top=0),Rt(o=ft(o,a),s({visibleArea:o,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,s=t.imageSize,n=t.imageRestriction,o=t.type,a={};return"fill-area"===n?a={left:0,top:0,right:s.width,bottom:s.height}:"fit-area"===n&&(wt(i)>wt(s)?(a={top:0,bottom:s.height},e&&"move"===o&&(e.width>s.width?(a.left=-(e.width-s.width)/2,a.right=s.width-a.left):(a.left=0,a.right=s.width))):(a={left:0,right:s.width},e&&"move"===o&&(e.height>s.height?(a.top=-(e.height-s.height)/2,a.bottom=s.height-a.top):(a.top=0,a.bottom=s.height)))),a}},sizeRestrictionsAlgorithm:{type:Function,default:function(t){return{minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.imageSize,i={};return"none"!==t.imageRestriction&&(i={left:0,top:0,right:e.width,bottom:e.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:C({},ht)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var t=this.imageTransforms.rotate*Math.PI/180;return{width:Math.abs(this.imageAttributes.width*Math.cos(t))+Math.abs(this.imageAttributes.height*Math.sin(t)),height:Math.abs(this.imageAttributes.width*Math.sin(t))+Math.abs(this.imageAttributes.height*Math.cos(t))}},initialized:function(){return Boolean(this.visibleArea&&this.imageLoaded)},settings:function(){var t=j(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:j(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:t}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var t=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:F(this.minWidth)?0:N(this.minWidth),minHeight:F(this.minHeight)?0:N(this.minHeight),maxWidth:F(this.maxWidth)?1/0:N(this.maxWidth),maxHeight:F(this.maxHeight)?1/0:N(this.maxHeight)});if(t=function(t){var e=t.areaRestrictions,i=t.sizeRestrictions,s=t.boundaries,n=t.positionRestrictions,o=W(W({},i),{minWidth:void 0!==i.minWidth?i.minWidth:0,minHeight:void 0!==i.minHeight?i.minHeight:0,maxWidth:void 0!==i.maxWidth?i.maxWidth:1/0,maxHeight:void 0!==i.maxHeight?i.maxHeight:1/0});void 0!==n.left&&void 0!==n.right&&(o.maxWidth=Math.min(o.maxWidth,n.right-n.left)),void 0!==n.bottom&&void 0!==n.top&&(o.maxHeight=Math.min(o.maxHeight,n.bottom-n.top));var a=Ct(e),r=xt(s,a);return a.width<1/0&&(!o.maxWidth||o.maxWidth>r.width)&&(o.maxWidth=Math.min(o.maxWidth,r.width)),a.height<1/0&&(!o.maxHeight||o.maxHeight>r.height)&&(o.maxHeight=Math.min(o.maxHeight,r.height)),o.minWidth>o.maxWidth&&(o.minWidth=o.maxWidth,o.widthFrozen=!0),o.minHeight>o.maxHeight&&(o.minHeight=o.maxHeight,o.heightFrozen=!0),o}({sizeRestrictions:t,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var e=this.getStencilSize(),i=Ct(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));t.maxWidth=Math.min(t.maxWidth,i.width*e.width/this.boundaries.width),t.maxHeight=Math.min(t.maxHeight,i.height*e.height/this.boundaries.height),t.maxWidth<t.minWidth&&(t.minWidth=t.maxWidth),t.maxHeight<t.minHeight&&(t.minHeight=t.maxHeight)}return t}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:ue(),image:I(ue("image"),this.imageClass),stencil:ue("stencil"),boundaries:I(ue("boundaries"),this.boundariesClass),stretcher:I(ue("stretcher")),background:I(ue("background"),this.backgroundClass),foreground:I(ue("foreground"),this.foregroundClass),imageWrapper:I(ue("image-wrapper")),cropperWrapper:I(ue("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var t=this.coordinates,e=t.width,i=t.height,s=t.left,n=t.top;return{width:e/this.coefficient,height:i/this.coefficient,left:(s-this.visibleArea.left)/this.coefficient,top:(n-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var t={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(t.opacity="0"),t},imageStyle:function(){var t=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},e=(t.width-this.imageSize.width)/(2*this.coefficient),i=(t.height-this.imageSize.height)/(2*this.coefficient),s=(1-1/this.coefficient)*t.width/2,n=(1-1/this.coefficient)*t.height/2,o=C(C({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/t.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/t.height)}),a={width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-e-s-this.imageTransforms.translateX,"px, ").concat(-i-n-this.imageTransforms.translateY,"px)")+se(o)};return this.transitionsOptions.enabled&&(a.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),a}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var t=this;this.$nextTick((function(){t.resetCoordinates(),t.runAutoZoom("setCoordinates"),t.onChange()}))},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(t,e){["aspectRatio","minAspectRatio","maxAspectRatio"].find((function(i){return t[i]!==e[i]}))&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=D(this.update,this.debounce),this.debouncedDisableTransitions=D(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var t=this.initialized?this.prepareResult(C({},this.coordinates)):this.defaultCoordinates(),e={rotate:this.imageTransforms.rotate%360,flip:C({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:t,visibleArea:this.visibleArea?C({},this.visibleArea):null,imageTransforms:e,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:t,visibleArea:this.visibleArea?C({},this.visibleArea):null,canvas:void 0,imageTransforms:e}},zoom:function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).transitions,s=void 0===i||i;this.onManipulateImage(new V({},{factor:1/t,center:e}),{normalize:!1,transitions:s})},move:function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).transitions,s=void 0===i||i;this.onManipulateImage(new V({left:t||0,top:e||0}),{normalize:!1,transitions:s})},setCoordinates:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.autoZoom,n=void 0===s||s,o=i.transitions,a=void 0===o||o;this.$nextTick((function(){e.imageLoaded?(e.transitionsActive||(a&&e.enableTransitions(),e.coordinates=e.applyTransform(t),n&&e.runAutoZoom("setCoordinates"),a&&e.debouncedDisableTransitions()),e.onChange()):e.delayedTransforms=t}))},refresh:function(){var t=this,e=this.$refs.image;if(this.src&&e)return this.initialized?this.updateVisibleArea().then((function(){t.onChange()})):this.resetVisibleArea().then((function(){t.onChange()}))},reset:function(){var t=this;return this.resetVisibleArea().then((function(){t.onChange(!1)}))},awaitRender:function(t){var e=this;this.awaiting||(this.awaiting=!0,this.$nextTick((function(){t(),e.awaiting=!1})))},prepareResult:function(t){return this.roundResult?(e=C(C({},this.getPublicProperties()),{},{positionRestrictions:Ft(this.positionRestrictions,this.visibleArea),coordinates:t}),i=e.coordinates,s=e.sizeRestrictions,n=e.positionRestrictions,(o={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)}).width>s.maxWidth?o.width=Math.floor(i.width):o.width<s.minWidth&&(o.width=Math.ceil(i.width)),o.height>s.maxHeight?o.height=Math.floor(i.height):o.height<s.minHeight&&(o.height=Math.ceil(i.height)),Rt(o,n)):t;var e,i,s,n,o},processAutoZoom:function(t,e,i,s){var n=this.autoZoomAlgorithm;n||(n=this.stencilSize?Lt:this.autoZoom?Dt:Wt);var o=n({event:{type:t,params:s},visibleArea:e,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return C(C({},o),{},{changed:!lt(o.visibleArea,e)||!lt(o.coordinates,i)})},runAutoZoom:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.transitions,s=void 0!==i&&i,n=function(t,e){if(null==t)return{};var i,s,n=function(t,e){if(null==t)return{};var i,s,n={},o=Object.keys(t);for(s=0;s<o.length;s++)i=o[s],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)i=o[s],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}(e,pe),o=this.processAutoZoom(t,this.visibleArea,this.coordinates,n),a=o.visibleArea,r=o.coordinates,h=o.changed;s&&h&&this.enableTransitions(),this.visibleArea=a,this.coordinates=r,s&&h&&this.debouncedDisableTransitions()},normalizeEvent:function(t){return function(t){var e=t.event,i=t.visibleArea,s=t.coefficient;if("manipulateImage"===e.type)return W(W({},e),{move:{left:e.move&&e.move.left?s*e.move.left:0,top:e.move&&e.move.top?s*e.move.top:0},scale:{factor:e.scale&&e.scale.factor?e.scale.factor:1,center:e.scale&&e.scale.center?{left:e.scale.center.left*s+i.left,top:e.scale.center.top*s+i.top}:null}});if("resize"===e.type){var n=W(W({},e),{directions:W({},e.directions)});return st.forEach((function(t){n.directions[t]*=s})),n}if("move"===e.type){var o=W(W({},e),{directions:W({},e.directions)});return at.forEach((function(t){o.directions[t]*=s})),o}return e}(C(C({},this.getPublicProperties()),{},{event:t}))},getCanvas:function(){if(this.$refs.canvas){var t=this.$refs.canvas,e=this.$refs.image,i=0!==this.imageTransforms.rotate||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(t,e,i){var s=i.rotate,n=i.flip,o={width:e.naturalWidth,height:e.naturalHeight},a=zt(o,s),r=t.getContext("2d");t.height=a.height,t.width=a.width,r.save();var h=St(pt(W({left:0,top:0},o)),s);return r.translate(-(h.left-a.width/2),-(h.top-a.height/2)),r.rotate(s*Math.PI/180),r.translate(n.horizontal?o.width:0,n.vertical?o.height:0),r.scale(n.horizontal?-1:1,n.vertical?-1:1),r.drawImage(e,0,0,o.width,o.height),r.restore(),t}(this.$refs.sourceCanvas,e,this.imageTransforms):e,s=C({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),n=function(t){return t.find((function(t){return e=t,!Number.isNaN(parseFloat(e))&&isFinite(e);var e}))},o=It({sizeRestrictions:{minWidth:n([s.width,s.minWidth])||0,minHeight:n([s.height,s.minHeight])||0,maxWidth:n([s.width,s.maxWidth])||1/0,maxHeight:n([s.height,s.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(s.maxArea&&o.width*o.height>s.maxArea){var a=Math.sqrt(s.maxArea/(o.width*o.height));o={width:Math.round(a*o.width),height:Math.round(a*o.height)}}return function(t,e,i,s,n){t.width=s?s.width:i.width,t.height=s?s.height:i.height;var o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),n&&(n.imageSmoothingEnabled&&(o.imageSmoothingEnabled=n.imageSmoothingEnabled),n.imageSmoothingQuality&&(o.imageSmoothingQuality=n.imageSmoothingQuality),n.fillColor&&(o.fillStyle=n.fillColor,o.fillRect(0,0,t.width,t.height),o.save()));var a=i.left<0?-i.left:0,r=i.top<0?-i.top:0;o.drawImage(e,i.left+a,i.top+r,i.width,i.height,a*(t.width/i.width),r*(t.height/i.height),t.width,t.height)}(t,i,this.coordinates,o,s),t}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.visibleArea&&e?function(t,e){return W(W({},t),{minWidth:Math.min(e.width,t.minWidth),minHeight:Math.min(e.height,t.minHeight),maxWidth:Math.min(e.width,t.maxWidth),maxHeight:Math.min(e.height,t.maxHeight)})}(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,s=this.visibleArea&&e?Ft(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return function(t){var e=t.coordinates,i=t.transform,s=t.imageSize,n=t.sizeRestrictions,o=t.positionRestrictions,a=t.aspectRatio,r=t.visibleArea,h=function(t,e){return Ot({coordinates:t,positionRestrictions:o,event:new G({left:e.left-t.left,top:e.top-t.top})})},l=W({},e);return(Array.isArray(i)?i:[i]).forEach((function(t){var e,i,o,c;F((e="function"==typeof t?t({coordinates:l,imageSize:s,visibleArea:r}):t).width)&&F(e.height)||(i=l,o=W(W({},l),e),c=W(W(W({},i),It({width:o.width,height:o.height,sizeRestrictions:n,aspectRatio:a})),{left:0,top:0}),l=h(c,{left:i.left,top:i.top})),F(e.left)&&F(e.top)||(l=h(l,W(W({},l),e)))})),l}({transform:t,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:s,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var t=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var e=this.defaultSize;e||(e=this.stencilSize?Bt:Ht);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var s=k(e)?e({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):e,n=this.defaultPosition||Zt,o=[s,function(e){var i=e.coordinates;return C({},k(n)?n({coordinates:i,imageSize:t.imageSize,visibleArea:t.visibleArea}):t.defaultPosition)}];this.delayedTransforms&&o.push.apply(o,M(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(o,!0),this.delayedTransforms=null}},clearImage:function(){var t=this;this.imageLoaded=!1,setTimeout((function(){var e=t.$refs.stretcher;e&&(e.style.height="auto",e.style.width="auto"),t.coordinates=t.defaultCoordinates(),t.boundaries={width:0,height:0}}),this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var t=this,e=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:e,imageSize:this.imageSize}),this.$nextTick().then((function(){var e,s,n,o,a,r,h,l={cropper:i,imageSize:t.imageSize};if(k(t.defaultBoundaries)?t.boundaries=t.defaultBoundaries(l):"fit"===t.defaultBoundaries?t.boundaries=(n=(e=l).imageSize,o=(s=e.cropper).clientHeight,a=s.clientWidth,r=o,(h=n.width*o/n.height)>a&&(h=a,r=n.height*a/n.width),{width:h,height:r}):t.boundaries=function(t){var e=t.cropper;return{width:e.clientWidth,height:e.clientHeight}}(l),!t.boundaries.width||!t.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")}))},resetVisibleArea:function(){var t=this;return this.appliedImageTransforms=C(C({},this.defaultImageTransforms),{},{flip:C({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then((function(){"visible-area"!==t.priority&&(t.visibleArea=null,t.resetCoordinates());var e,i,s,n,o,a=t.defaultVisibleArea||kt;t.visibleArea=k(a)?a({imageSize:t.imageSize,boundaries:t.boundaries,coordinates:"visible-area"!==t.priority?t.coordinates:null,getAreaRestrictions:t.getAreaRestrictions,stencilSize:t.getStencilSize()}):t.defaultVisibleArea,t.visibleArea=(i=(e={visibleArea:t.visibleArea,boundaries:t.boundaries,getAreaRestrictions:t.getAreaRestrictions}).boundaries,s=e.getAreaRestrictions,n=W({},e.visibleArea),o=wt(i),n.width/n.height!==o&&(n.height=n.width/o),Rt(n,s({visibleArea:n,type:"move"}))),"visible-area"===t.priority?t.resetCoordinates():t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("resetVisibleArea")})).catch((function(){t.visibleArea=null}))},updateVisibleArea:function(){var t=this;return this.updateBoundaries().then((function(){t.visibleArea=t.fitVisibleArea({imageSize:t.imageSize,boundaries:t.boundaries,visibleArea:t.visibleArea,coordinates:t.coordinates,getAreaRestrictions:t.getAreaRestrictions}),t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("updateVisibleArea")})).catch((function(){t.visibleArea=null}))},onChange:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var t,e=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(t){if(B(t))return!1;var e=window.location,i=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(t)||[],s={protocol:i[1]||"",host:i[2]||"",port:i[3]||""},n=function(t){return t.port||("http"===(t.protocol||e.protocol)?80:433)};return!(!s.protocol&&!s.host&&!s.port||Boolean(s.protocol&&s.protocol==e.protocol&&s.host&&s.host==e.host&&s.host&&n(s)==n(e)))}(this.src)){var i=F(this.crossOrigin)?this.canvas:this.crossOrigin;!0===i&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var s=(t=this.src,new Promise((function(e){(function(t){return new Promise((function(e,i){try{if(t)if(/^data:/i.test(t))e(function(t){t=t.replace(/^data:([^;]+);base64,/gim,"");for(var e=atob(t),i=e.length,s=new ArrayBuffer(i),n=new Uint8Array(s),o=0;o<i;o++)n[o]=e.charCodeAt(o);return s}(t));else if(/^blob:/i.test(t)){var s=new FileReader;s.onload=function(t){e(t.target.result)},o=t,a=function(t){s.readAsArrayBuffer(t)},(r=new XMLHttpRequest).open("GET",o,!0),r.responseType="blob",r.onload=function(){200!=this.status&&0!==this.status||a(this.response)},r.send()}else{var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?e(n.response):i("Warning: could not load an image to parse its orientation"),n=null)},n.onprogress=function(){"image/jpeg"!==n.getResponseHeader("content-type")&&n.abort()},n.withCredentials=!1,n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)}else i("Error: the image is empty")}catch(h){i(h)}var o,a,r}))})(t).then((function(i){var s=function(t){try{var e,i=new DataView(t),s=void 0,n=void 0,o=void 0,a=void 0;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var r=i.byteLength,h=2;h+1<r;){if(255===i.getUint8(h)&&225===i.getUint8(h+1)){o=h;break}h++}if(o&&(s=o+10,"Exif"===function(t,e,i){var s,n="";for(s=e,i+=e;s<i;s++)n+=String.fromCharCode(t.getUint8(s));return n}(i,o+4,4))){var l=i.getUint16(s);if(((n=18761===l)||19789===l)&&42===i.getUint16(s+2,n)){var c=i.getUint32(s+4,n);c>=8&&(a=s+c)}}if(a)for(var d=i.getUint16(a,n),p=0;p<d;p++)if(h=a+12*p+2,274===i.getUint16(h,n)){h+=8,e=i.getUint16(h,n),i.setUint16(h,1,n);break}return e}catch(u){return null}}(i);e(i?{source:t,arrayBuffer:i,orientation:s}:{source:t,arrayBuffer:null,orientation:null})})).catch((function(i){e({source:t,arrayBuffer:null,orientation:null})}))})));setTimeout((function(){s.then(e.onParseImage)}),this.transitionTime)}else setTimeout((function(){e.onParseImage({source:e.src})}),this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var t=this,e=this.$refs.image;e&&!this.imageLoaded&&(this.imageAttributes.height=e.naturalHeight,this.imageAttributes.width=e.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then((function(){t.$emit("ready"),t.onChange(!1)})))},onParseImage:function(t){var e=this,i=t.source,s=t.arrayBuffer,n=t.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,s&&n&&n>1?H(i)||!B(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([s])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(t){for(var e=[],i=new Uint8Array(t);i.length>0;){var s=i.subarray(0,8192);e.push(String.fromCharCode.apply(null,Array.from?Array.from(s):s.slice())),i=i.subarray(8192)}return"data:image/jpeg;base64,"+btoa(e.join(""))}(s):this.imageAttributes.src=i,k(this.defaultTransforms)?this.appliedImageTransforms=ie(this.defaultTransforms()):$(this.defaultTransforms)?this.appliedImageTransforms=ie(this.defaultTransforms):this.appliedImageTransforms=function(t){var e=ie({});if(t)switch(t){case 2:e.flip.horizontal=!0;break;case 3:e.rotate=-180;break;case 4:e.flip.vertical=!0;break;case 5:e.rotate=90,e.flip.vertical=!0;break;case 6:e.rotate=90;break;case 7:e.rotate=90,e.flip.horizontal=!0;break;case 8:e.rotate=-90}return e}(n),this.defaultImageTransforms=C(C({},this.appliedImageTransforms),{},{flip:C({},this.appliedImageTransforms.flip)}),this.$nextTick((function(){var t=e.$refs.image;t&&t.complete&&(Boolean(t.naturalWidth)?e.onSuccessLoadImage():e.onFailLoadImage())}))},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(t){var e=this;this.transitionsOptions.enabled||this.awaitRender((function(){e.coordinates=e.moveAlgorithm(C(C({},e.getPublicProperties()),{},{positionRestrictions:Ft(e.positionRestrictions,e.visibleArea),coordinates:e.coordinates,event:e.normalizeEvent(t)})),e.onChange()}))},onResize:function(t){var e=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender((function(){var i=e.sizeRestrictions,s=Math.min(e.coordinates.width,e.coordinates.height,20*e.coefficient);e.coordinates=e.resizeAlgorithm(C(C({},e.getPublicProperties()),{},{positionRestrictions:Ft(e.positionRestrictions,e.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,e.visibleArea.width),maxHeight:Math.min(i.maxHeight,e.visibleArea.height),minWidth:Math.max(i.minWidth,s),minHeight:Math.max(i.minHeight,s)},event:e.normalizeEvent(t)})),e.onChange(),e.ticking=!1}))},onManipulateImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=e.transitions,s=void 0!==i&&i,n=e.normalize,o=void 0===n||n;s&&this.enableTransitions();var a=function(t){var e=t.event,i=t.coordinates,s=t.visibleArea,n=t.sizeRestrictions,o=t.getAreaRestrictions,a=t.positionRestrictions,r=t.adjustStencil,h=e.scale,l=e.move,c=W({},s),d=W({},i),p=1,u=1,m=h.factor&&Math.abs(h.factor-1)>.001;c=ft(c,{left:l.left||0,top:l.top||0});var g={stencil:{minimum:Math.max(n.minWidth?n.minWidth/d.width:0,n.minHeight?n.minHeight/d.height:0),maximum:Math.min(n.maxWidth?n.maxWidth/d.width:1/0,n.maxHeight?n.maxHeight/d.height:1/0,yt(d,a))},area:{maximum:yt(c,o({visibleArea:c,type:"resize"}))}};h.factor&&m&&(h.factor<1?(u=Math.max(h.factor,g.stencil.minimum))>1&&(u=1):h.factor>1&&(u=Math.min(h.factor,Math.min(g.area.maximum,g.stencil.maximum)))<1&&(u=1)),u&&(c=vt(c,u,h.center));var f=i.left-s.left,v=s.width+s.left-(i.width+i.left),w=i.top-s.top,y=s.height+s.top-(i.height+i.top);return c=Rt(c=ft(c,bt(c,{left:void 0!==a.left?a.left-f*u:void 0,top:void 0!==a.top?a.top-w*u:void 0,bottom:void 0!==a.bottom?a.bottom+y*u:void 0,right:void 0!==a.right?a.right+v*u:void 0})),o({visibleArea:c,type:"move"})),d.width=d.width*u,d.height=d.height*u,d.left=c.left+f*u,d.top=c.top+w*u,d=Rt(d,Mt(ct(c),a)),h.factor&&m&&r&&(h.factor>1?p=Math.min(g.area.maximum,h.factor)/u:h.factor<1&&(p=Math.max(d.height/c.height,d.width/c.width,h.factor/u)),1!==p&&(c=ft(c=Rt(c=vt(c,p,h.factor>1?h.center:pt(d)),o({visibleArea:c,type:"move"})),gt(bt(d,ct(c)))))),{coordinates:d,visibleArea:c}}(C(C({},this.getPublicProperties()),{},{event:o?this.normalizeEvent(t):t,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),r=a.visibleArea,h=a.coordinates;this.visibleArea=r,this.coordinates=h,this.runAutoZoom("manipulateImage"),this.onChange(),s&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.visibleArea,i=t.type,s=void 0===i?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:e,type:s})},getAspectRatio:function(t){var e,i,s=this.stencilProps,n=s.aspectRatio,o=s.minAspectRatio,a=s.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var r=this.$refs.stencil.aspectRatios();e=r.minimum,i=r.maximum}if(F(e)&&(e=F(n)?o:n),F(i)&&(i=F(n)?a:n),!t&&(F(e)||F(i))){var h=this.getStencilSize(),l=h?wt(h):null;F(e)&&(e=U(l)?l:void 0),F(i)&&(i=U(l)?l:void 0)}return{minimum:e,maximum:i}},getStencilSize:function(){if(this.stencilSize)return e=(t={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)}).boundaries,s=t.aspectRatio,_t(wt(n=k(i=t.stencilSize)?i({boundaries:e,aspectRatio:s}):i),s)&&(n=It({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:n.width,height:n.height,aspectRatio:{minimum:s.minimum,maximum:s.maximum}})),(n.width>e.width||n.height>e.height)&&(n=It({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:n.width,height:n.height,aspectRatio:{minimum:wt(n),maximum:wt(n)}})),n;var t,e,i,s,n},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return C({},ht)},flip:function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).transitions,s=void 0===i||i;if(!this.transitionsActive){s&&this.enableTransitions();var n=C({},this.imageTransforms.flip),o=function(t){var e=t.flip,i=t.previousFlip,s=t.rotate,n=t.getAreaRestrictions,o=t.coordinates,a=t.visibleArea,r=t.imageSize,h=W({},o),l=W({},a),c=i.horizontal!==e.horizontal,d=i.vertical!==e.vertical;if(c||d){var p=St({left:r.width/2,top:r.height/2},-s),u=St(pt(h),-s),m=St({left:c?p.left-(u.left-p.left):u.left,top:d?p.top-(u.top-p.top):u.top},s);h=ft(h,dt(m,pt(h))),u=St(pt(l),-s),l=Rt(l=ft(l,dt(m=St({left:c?p.left-(u.left-p.left):u.left,top:d?p.top-(u.top-p.top):u.top},s),pt(l))),n({visibleArea:l,type:"move"}))}return{coordinates:h,visibleArea:l}}({flip:{horizontal:t?!n.horizontal:n.horizontal,vertical:e?!n.vertical:n.vertical},previousFlip:n,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),a=o.visibleArea,r=o.coordinates;t&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),e&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=a,this.coordinates=r,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).transitions,i=void 0===e||e;if(!this.transitionsActive){i&&this.enableTransitions();var s=C({},this.imageSize);this.appliedImageTransforms.rotate+=t;var n=function(t){var e=t.aspectRatio,i=t.getAreaRestrictions,s=t.coordinates,n=t.visibleArea,o=t.sizeRestrictions,a=t.positionRestrictions,r=t.imageSize,h=t.previousImageSize,l=t.angle,c=W({},s),d=W({},n),p=St(pt(W({left:0,top:0},h)),l);return(c=W(W({},It({sizeRestrictions:o,aspectRatio:e,width:c.width,height:c.height})),St(pt(c),l))).left-=p.left-r.width/2+c.width/2,c.top-=p.top-r.height/2+c.height/2,d=vt(d,At(d,i({visibleArea:d,type:"resize"}))),{coordinates:c=Rt(c,a),visibleArea:d=Rt(d=ft(d,dt(pt(c),pt(s))),i({visibleArea:d,type:"move"}))}}({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:t,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),o=n.visibleArea,a=n.coordinates,r=this.processAutoZoom("rotateImage",o,a);o=r.visibleArea,a=r.coordinates,this.visibleArea=o,this.coordinates=a,this.onChange(),i&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},ge={key:0,ref:"canvas",style:{display:"none"}},fe={key:1,ref:"sourceCanvas",style:{display:"none"}};me.render=function(i,s,a,r,m,g){return e(),t("div",{ref:"cropper",class:g.classes.cropper},[n("div",{ref:"stretcher",class:g.classes.stretcher},null,2),n("div",{class:g.classes.boundaries,style:g.boundariesStyle},[(e(),t(h(a.backgroundWrapperComponent),{class:g.classes.cropperWrapper,"wheel-resize":g.settings.resizeImage.wheel,"touch-resize":g.settings.resizeImage.touch,"touch-move":g.settings.moveImage.touch,"mouse-move":g.settings.moveImage.mouse,onMove:g.onManipulateImage,onResize:g.onManipulateImage},{default:o((function(){return[n("div",{class:g.classes.background,style:g.boundariesStyle},null,6),n("div",{class:g.classes.imageWrapper},[n("img",{ref:"image",crossorigin:m.imageAttributes.crossOrigin,src:m.imageAttributes.src,class:g.classes.image,style:g.imageStyle,onMousedown:s[1]||(s[1]=u((function(){}),["prevent"]))},null,46,["crossorigin","src"])],2),n("div",{class:g.classes.foreground,style:g.boundariesStyle},null,6),l((e(),t(h(a.stencilComponent),d({ref:"stencil",image:g.image,coordinates:m.coordinates,"stencil-coordinates":g.stencilCoordinates,transitions:g.transitionsOptions},a.stencilProps,{onResize:g.onResize,onResizeEnd:g.onResizeEnd,onMove:g.onMove,onMoveEnd:g.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[c,m.imageLoaded]]),a.canvas?(e(),t("canvas",ge,null,512)):p("",!0),a.canvas?(e(),t("canvas",fe,null,512)):p("",!0)]})),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};var ve=Object.defineProperty,we=(t,e,i)=>(((t,e,i)=>{e in t?ve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);const ye=["rows","columns","masonry"],be=Object.freeze([1200,600,300,0]);function _e(t,e){return"function"==typeof t?t(e):t}function xe(t,e){return void 0!==t?_e(t,e):void 0}function ze(t,e,i,s=0){const n=xe(t,e);return Math.round(Math.max(void 0===n?function(t,e){const i=be.findIndex((t=>t<=e));return _e(t[i>=0?i:0],e)}(i,e):n,s))}function Se(t,e,i){const s=f(i),n=f();let o;const a=()=>{s.value=function(t,e){let i=null==t?void 0:t.clientWidth;if(void 0!==i&&void 0!==e&&e.length>0){const t=e.filter((t=>t>0)).sort(((t,e)=>e-t));t.push(Math.floor(t[t.length-1]/2));const s=i;i=t.find(((e,i)=>e<=s||i===t.length-1))}return i}(n.value,e)},r=()=>{void 0!==o&&(o.disconnect(),o=void 0)};return w(t,(e=>{var i;void 0!==e?(n.value=(t=>{const e=_(t);return void 0===e||e instanceof HTMLElement?e:e.$el})(t),i=n.value,r(),void 0!==i&&"undefined"!=typeof ResizeObserver&&(o=new ResizeObserver(a),o.observe(i))):r()}),{immediate:!0,flush:"post"}),x((()=>{r()})),{containerWidth:s}}function Ae(t,e=0){const i=10**e,s=t+Number.EPSILON;return Math.round(s*i)/i}function Re({width:t,height:e}){return t/e}class Ce{constructor(t){we(this,"heap",[]),we(this,"n",0),this.comparator=t}greater(t,e){return this.comparator(this.heap[t],this.heap[e])<0}swap(t,e){const i=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=i}swim(t){let e=t,i=Math.floor(e/2);for(;e>1&&this.greater(i,e);)this.swap(i,e),e=i,i=Math.floor(e/2)}sink(t){let e=t,i=2*e;for(;i<=this.n&&(i<this.n&&this.greater(i,i+1)&&(i+=1),this.greater(e,i));)this.swap(e,i),e=i,i=2*e}push(t){this.n+=1,this.heap[this.n]=t,this.swim(this.n)}pop(){if(0===this.n)return;this.swap(1,this.n),this.n-=1;const t=this.heap.pop();return this.sink(1),t}get size(){return this.n}}function Pe(t,e,i){const s=function(t,e,i){const s=new Map,n=new Set,o=new Map;o.set(e,0);const a=new Ce((r=t=>t.weight,(t,e)=>r(e)-r(t)));var r;for(a.push({id:e,weight:0});a.size>0;){const{id:e,weight:i}=a.pop();if(n.has(e))continue;const r=t(e);n.add(e),r.forEach(((t,n)=>{const r=i+t,h=s.get(n),l=o.get(n);(void 0===l||l>r&&(l/r>1.005||void 0!==h&&h<e))&&(o.set(n,r),a.push({id:n,weight:r}),s.set(n,e))}))}return o.has(i)?s:void 0}(t,e,i);return void 0!==s?function(t,e){const i=[];for(let s=e;void 0!==s;s=t.get(s))i.push(s);return i.reverse()}(s,i):void 0}function Me(t,e,i,s){return(e-(t.length-1)*i-2*s*t.length)/t.reduce(((t,e)=>t+Re(e)),0)}function Te(t,e,i,s,n,o,a){const r=t.slice(e,i),h=Me(r,s,o,a);if(!(h<=0))return(h-n)**2*r.length}function Ee({photos:t,layoutOptions:e}){const{spacing:i,padding:s,containerWidth:n,targetRowHeight:o,rowConstraints:a}=e,r=function({photos:t,targetRowHeight:e,containerWidth:i}){return Ae(i/e/t.reduce(((t,e)=>Math.min(t,Re(e))),Number.MAX_VALUE))+2}({photos:t,containerWidth:n,targetRowHeight:o}),h=function({photos:t,layoutOptions:e,targetRowHeight:i,limitNodeSearch:s,rowConstraints:n}){return o=>{const{containerWidth:a,spacing:r,padding:h}=e,l=new Map;l.set(o,0);const c=(null==n?void 0:n.minPhotos)??1,d=Math.min(s,(null==n?void 0:n.maxPhotos)??Number.POSITIVE_INFINITY);for(let e=o+c;e<t.length+1&&!(e-o>d);e+=1){const s=Te(t,o,e,a,i,r,h);if(void 0===s)break;l.set(e,s)}return l}}({photos:t,layoutOptions:e,targetRowHeight:o,limitNodeSearch:r,rowConstraints:a}),l=Pe(h,0,t.length);if(void 0===l)return;const c=[];for(let d=1;d<l.length;d+=1){const e=t.map(((t,e)=>({photo:t,index:e}))).slice(l[d-1],l[d]),o=Me(e.map((({photo:t})=>t)),n,i,s);c.push(e.map((({photo:t,index:i},s)=>({photo:t,layout:{height:o,width:o*Re(t),index:i,photoIndex:s,photosCount:e.length}}))))}return c}const Ie=m({__name:"RowRenderer",props:{layoutOptions:{},rowData:{},rowIndex:{},rowsCount:{},renderer:{}},setup(s){const n=s,a=v((()=>({display:"flex",flexFlow:"row nowrap",alignItems:"start",justifyContent:"space-between",marginBottom:void 0!==n.rowsCount&&n.rowIndex<n.rowsCount-1?`${n.layoutOptions.spacing}px`:void 0}))),r=v((()=>n.renderer??"div")),l=v((()=>({layoutOptions:n.layoutOptions,rowData:n.rowData,rowIndex:n.rowIndex,rowsCount:n.rowsCount})));return(s,n)=>(e(),t(h(r.value),d({class:"photo-album__row",style:a.value},l.value),{default:o((()=>[i(s.$slots,"default")])),_:3},16,["style"]))}}),Oe=m({__name:"RowsLayout",props:{photos:{},layoutOptions:{},rowRenderer:{}},setup(s){const n=s,h=v((()=>Ee({photos:n.photos,layoutOptions:n.layoutOptions})));return(s,n)=>(e(!0),y(a,null,r(h.value,((n,l)=>{var c;return e(),t(Ie,{key:`row-${l}`,"layout-options":s.layoutOptions,"row-data":n,"row-index":l,"rows-count":(null==(c=h.value)?void 0:c.length)??0,renderer:s.rowRenderer},{default:o((()=>[(e(!0),y(a,null,r(n,(({photo:t,layout:e})=>i(s.$slots,"default",b(d({key:t.key||t.src},{photo:t,layout:e,layoutOptions:s.layoutOptions}))))),128))])),_:2},1032,["layout-options","row-data","row-index","rows-count","renderer"])})),128))}});function Le(t,e,i,s){return function(t,e,i){const s=[i];for(let n=i,o=e;o>0;o-=1)n=t.get(n)[o].node,s.push(n);return s.reverse()}(function(t,e,i,s){const n=new Map,o=new Set;o.add(i);for(let a=0;a<e;a+=1){const i=[...o.keys()];o.clear(),i.forEach((i=>{const r=a>0?n.get(i)[a].weight:0;t(i).forEach((({neighbor:t,weight:h})=>{let l=n.get(t);void 0===l&&(l=[],n.set(t,l));const c=r+h,d=l[a+1];(void 0===d||d.weight>c&&(d.weight/c>1.0001||i<d.node))&&(l[a+1]={node:i,weight:c}),a<e-1&&t!==s&&o.add(t)}))}))}return n}(t,e,i,s),e,s)}function De({path:t,photos:e,containerWidth:i,columnsGaps:s,columnsRatios:n,spacing:o,padding:a}){const r=[],h=n.reduce(((t,e)=>t+e),0);for(let l=0;l<t.length-1;l+=1){const c=e.map(((t,e)=>({photo:t,index:e}))).slice(t[l],t[l+1]),d=n.reduce(((t,e,i)=>t+(s[l]-s[i])*e),0),p=(i-(t.length-2)*o-2*(t.length-1)*a-d)*n[l]/h;r.push(c.map((({photo:t,index:e},i)=>({photo:t,layout:{width:p,height:p/Re(t),index:e,photoIndex:i,photosCount:c.length}}))))}return r}function We({photos:t,layoutOptions:e,targetColumnWidth:i}){const{columns:s,spacing:n,padding:o,containerWidth:a}=e,r=[],h=[];if(t.length<=s){const e=t.length>0?t.reduce(((t,e)=>t+Re(e)),0)/t.length:1;for(let i=0;i<s;i+=1)r[i]=2*o,h[i]=i<t.length?Re(t[i]):e;return{columnsGaps:r,columnsRatios:h,columnsModel:De({path:Array.from({length:s+1},((e,i)=>Math.min(i,t.length))),photos:t,columnsGaps:r,columnsRatios:h,containerWidth:a,spacing:n,padding:o})}}const l=(t.reduce(((t,e)=>t+i/Re(e)),0)+n*(t.length-s)+2*o*t.length)/s,c=function({photos:t,spacing:e,padding:i,targetColumnWidth:s,targetColumnHeight:n}){return o=>{const a=[],r=1.5*n;let h=s/Re(t[o])+2*i;for(let l=o+1;l<t.length+1&&(a.push({neighbor:l,weight:(n-h)**2}),!(h>r||l===t.length));l+=1)h+=s/Re(t[l])+e+2*i;return a}}({photos:t,targetColumnWidth:i,targetColumnHeight:l,spacing:n,padding:o}),d=Le(c,s,0,t.length);for(let p=0;p<d.length-1;p+=1){const e=t.slice(d[p],d[p+1]);r[p]=n*(e.length-1)+2*o*e.length,h[p]=1/e.reduce(((t,e)=>t+1/Re(e)),0)}return{columnsGaps:r,columnsRatios:h,columnsModel:De({path:d,photos:t,columnsGaps:r,columnsRatios:h,containerWidth:a,spacing:n,padding:o})}}function Ze({photos:t,layoutOptions:e}){const{columns:i,spacing:s,padding:n,containerWidth:o}=e,a=(o-s*(i-1)-2*n*i)/i,{columnsGaps:r,columnsRatios:h,columnsModel:l}=We({photos:t,layoutOptions:e,targetColumnWidth:a});return l.findIndex((t=>t.findIndex((({layout:{width:t,height:e}})=>t<0||e<0))>=0))>=0?i>1?Ze({photos:t,layoutOptions:{...e,columns:i-1}}):void 0:{columnsGaps:r,columnsRatios:h,columnsModel:l}}function He({photos:t,layoutOptions:e}){return Ze({photos:t,layoutOptions:e})}const Be=m({__name:"ColumnRenderer",props:{layoutOptions:{},columnData:{},columnIndex:{},columnsCount:{},columnsGaps:{},columnsRatios:{},renderer:{}},setup(s){const n=s;const a=v((()=>{const t="columns"===n.layoutOptions.layout?"space-between":"flex-start";const e=function({layoutOptions:t,columnIndex:e,columnsCount:i,columnsGaps:s,columnsRatios:n}){const{layout:o,spacing:a,padding:r}=t;if("masonry"===o||void 0===s||void 0===n)return`calc((100% - ${a*(i-1)}px) / ${i})`;const h=n.reduce(((t,e)=>t+e),0);return`calc((100% - ${Ae((i-1)*a+2*i*r+n.reduce(((t,i,n)=>t+(s[e]-s[n])*i),0),3)}px) * ${Ae(n[e]/h,5)} + ${2*r}px)`}(n);return{display:"flex",flexFlow:"column nowrap",alignItems:"flex-start",justifyContent:t,width:e}})),r=v((()=>n.renderer??"div")),l=v((()=>({layoutOptions:n.layoutOptions,columnData:n.columnData,columnIndex:n.columnIndex,columnsCount:n.columnsCount,columnsGaps:n.columnsGaps,columnsRatios:n.columnsRatios})));return(s,n)=>(e(),t(h(r.value),d({class:"photo-album__column",style:a.value},l.value),{default:o((()=>[i(s.$slots,"default")])),_:3},16,["style"]))}}),ke=m({__name:"ColumnsLayout",props:{photos:{},layoutOptions:{},columnRenderer:{}},setup(s){const n=s,h=v((()=>He({photos:n.photos,layoutOptions:n.layoutOptions}))),l=v((()=>{var t;return null==(t=h.value)?void 0:t.columnsModel})),c=v((()=>{var t;return(null==(t=l.value)?void 0:t.length)??0})),p=v((()=>{var t;return null==(t=h.value)?void 0:t.columnsGaps})),u=v((()=>{var t;return null==(t=h.value)?void 0:t.columnsRatios}));return(s,n)=>(e(!0),y(a,null,r(l.value,((n,h)=>(e(),t(Be,{key:`column-${h}`,"layout-options":s.layoutOptions,"column-data":n,"column-index":h,"columns-count":c.value,"columns-gaps":p.value,"columns-ratios":u.value,renderer:s.columnRenderer},{default:o((()=>[(e(!0),y(a,null,r(n,(({photo:t,layout:e})=>i(s.$slots,"default",b(d({key:t.key||t.src},{photo:t,layout:e,layoutOptions:s.layoutOptions}))))),128))])),_:2},1032,["layout-options","column-data","column-index","columns-count","columns-gaps","columns-ratios","renderer"])))),128))}});function Fe(t){const{photos:e,layoutOptions:i}=t,{containerWidth:s,spacing:n,padding:o,columns:a}=i,r=(s-n*(a-1)-2*o*a)/a;if(r<=0)return a>1?Fe({...t,layoutOptions:{...i,columns:a-1}}):void 0;const h=Array.from({length:a},(()=>0));return e.reduce(((t,e,i)=>{const s=h.reduce(((t,e,i)=>e<h[t]-1?i:t),0);return h[s]+=r/Re(e)+n+2*o,t[s].push({photo:e,index:i}),t}),Array.from({length:a},(()=>[]))).map((t=>t.map((({photo:e,index:i},s)=>({photo:e,layout:{width:r,height:r/Re(e),photosCount:t.length,index:i,photoIndex:s}})))))}const $e=m({__name:"MasonryLayout",props:{photos:{},layoutOptions:{},columnRenderer:{}},setup(s){const n=s,h=v((()=>Fe({photos:n.photos,layoutOptions:n.layoutOptions}))),l=v((()=>{var t;return(null==(t=h.value)?void 0:t.length)??0}));return(s,n)=>(e(!0),y(a,null,r(h.value,((n,h)=>(e(),t(Be,{key:`masonry-column-${h}`,"layout-options":s.layoutOptions,"column-data":n,"column-index":h,"columns-count":l.value,renderer:s.columnRenderer},{default:o((()=>[(e(!0),y(a,null,r(n,(({photo:t,layout:e})=>i(s.$slots,"default",b(d({key:t.key||t.src},{photo:t,layout:e,layoutOptions:s.layoutOptions}))))),128))])),_:2},1032,["layout-options","column-data","column-index","columns-count","renderer"])))),128))}}),je=m({__name:"PhotoRenderer",props:{photo:{},layout:{},layoutOptions:{},clickable:{type:Boolean},renderer:{}},setup(i){const s=i;function n(t,{width:e,photosCount:i},{spacing:s,padding:n,containerWidth:o}){const a=s*(i-1)+2*n*i;return`calc((${t} - ${a}px) / ${Ae((o-a)/e,5)})`}function a(t,e,i){var s;return n((null==(s=t.match(/calc\((.*)\)/))?void 0:s[1])??t,e,i)}function r(t,e,i){const s=t.srcSet;return{srcset:void 0!==s&&s.length>0?s.concat(void 0!==s.find((({width:e})=>e===t.width))?[{src:t.src,width:t.width,height:t.height}]:[]).sort(((t,e)=>t.width-e.width)).map((t=>`${t.src} ${t.width}w`)).join(", "):void 0,sizes:void 0!==(null==i?void 0:i.sizes)?(i.sizes.sizes??[]).map((({viewport:t,size:s})=>`${t} ${a(s,e,i)}`)).concat(a(i.sizes.size,e,i)).join(", "):`${Math.ceil(e.width/i.containerWidth*100)}vw`}}const l=v((()=>{const t=(e=s.layout,"rows"!==(i=s.layoutOptions).layout?`calc(100% - ${2*i.padding}px)`:n("100%",e,i));var e,i;const o=s.photo.width/s.photo.height;return{display:"block",boxSizing:"content-box",padding:`${s.layoutOptions.padding}px`,marginBottom:["columns","masonry"].includes(s.layoutOptions.layout)&&s.layout.photoIndex<s.layout.photosCount-1?`${s.layoutOptions.spacing}px`:void 0,aspectRatio:o,width:t,height:"auto",cursor:s.clickable?"pointer":void 0}})),c=z({display:"block",boxSizing:"content-box",width:"100%",height:"100%"}),p=v((()=>({class:"photo-album__photo",src:s.photo.src,alt:s.photo.alt,title:s.photo.title,style:void 0===s.renderer?l.value:c.value,loading:"lazy",decoding:"async",...r(s.photo,s.layout,s.layoutOptions)}))),u=v((()=>({layoutOptions:s.layoutOptions,photo:s.photo,layout:s.layout,clickable:s.clickable,imageProps:p.value})));return(i,s)=>i.renderer?(e(),t(h(i.renderer),d({key:0,style:l.value},u.value),{default:o((()=>[S("img",b(A(p.value)),null,16)])),_:1},16,["style"])):(e(),y("img",b(d({key:1},p.value)),null,16))}}),Ne={key:0},Ue=m({__name:"PhotoAlbum",props:{photos:{},layout:{},columns:{},spacing:{},padding:{},targetRowHeight:{},rowConstraints:{},sizes:{},breakpoints:{},defaultContainerWidth:{},onClick:{},containerRenderer:{},rowRenderer:{},columnRenderer:{},photoRenderer:{}},emits:["click"],setup(i,{emit:s}){const[r,l,c]=ye,u=i,{photos:m,layout:x,targetRowHeight:z,rowConstraints:S,columns:A,spacing:R,padding:C,sizes:P,breakpoints:M,defaultContainerWidth:T,containerRenderer:E,rowRenderer:I,columnRenderer:O,photoRenderer:L}=g(u),D=s;const W=f(),{containerWidth:Z}=Se(W,M.value,T.value),H=f(),B=v((()=>void 0===x.value||!ye.includes(x.value))),k=v((()=>["photo-album",`photo-album-${B.value?"unknown":x.value}`])),F=v((()=>{let t;if(x.value===r&&(null==(e=H.value)?void 0:e.layout)===r){const{padding:e,spacing:i,rowConstraints:s,targetRowHeight:n}=H.value,o=null==s?void 0:s.singleRowMaxHeight;if(void 0!==o){const s=void 0!==n?Math.max(o,n):o,a=m.value.length,r=e*a*2+i*(a-1);t=Math.floor(m.value.reduce(((t,i)=>t+i.width/i.height*s-2*e),r))}}var e;const i=void 0!==t&&t>0?`${t}px`:void 0;return{display:"flex",flexDirection:"rows"===x.value?"column":"row",flexWrap:"nowrap",justifyContent:"space-between",maxWidth:i}})),$=v((()=>({is:E.value??"div",props:{photos:m.value,layoutOptions:H.value}}))),j=v((()=>{if(!B.value)switch(x.value){case r:return{is:Oe,props:{photos:m.value,layoutOptions:H.value,rowRenderer:I.value}};case l:return{is:ke,props:{photos:m.value,layoutOptions:H.value,columnRenderer:O.value}};case c:return{is:$e,props:{photos:m.value,layoutOptions:H.value,columnRenderer:O.value}};default:return}}));return w([Z,x,z,S,A,R,C,P,E,I,O,L],(([t,e,i,s,n,o,a,h])=>{H.value=function({layout:t,containerWidth:e,targetRowHeight:i,rowConstraints:s,columns:n,spacing:o,padding:a,sizes:h}){const d={layout:t,containerWidth:e,spacing:ze(o,e,[20,15,10,5]),padding:ze(a,e,[0,0,0,0,0]),sizes:h},p={targetRowHeight:ze(i,e,[t=>t/5,t=>t/4,t=>t/3,t=>t/2]),rowConstraints:xe(s,e)},u={columns:ze(n,e,[5,4,3,2],1)};switch(t){case r:return Object.assign(d,p,{layout:r});case l:case c:return Object.assign({},d,u,{layout:t===l?l:c});default:return}}({containerWidth:t??0,layout:e,targetRowHeight:i,rowConstraints:s,columns:n,spacing:o,padding:a,sizes:h})}),{immediate:!0}),(i,s)=>(e(),t(h($.value.is),d({class:k.value,style:F.value},$.value.props,{ref_key:"containerRef",ref:W}),{default:o((()=>[B.value?(e(),y("div",Ne,"Unknown Layout")):(e(),y(a,{key:1},[j.value?(e(),t(h(j.value.is),b(d({key:0},j.value.props)),{default:o((t=>[n(je,d(t,{renderer:_(L),clickable:void 0!==i.$props.onClick,onClick:e=>((t,e)=>{const i=e.photo,s=e.layout.index;D("click",{event:t,photo:i,index:s})})(e,t)}),null,16,["renderer","clickable","onClick"])])),_:1},16)):p("",!0)],64))])),_:1},16,["class","style"]))}});
/*!
  * PhotoSwipe 5.4.4 - https://photoswipe.com
  * (c) 2024 Dmytro Semenov
  */
function Xe(t,e,i){const s=document.createElement(e);return t&&(s.className=t),i&&i.appendChild(s),s}function Ye(t,e){return t.x=e.x,t.y=e.y,void 0!==e.id&&(t.id=e.id),t}function Ve(t){t.x=Math.round(t.x),t.y=Math.round(t.y)}function qe(t,e){const i=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return Math.sqrt(i*i+s*s)}function Ge(t,e){return t.x===e.x&&t.y===e.y}function Ke(t,e,i){return Math.min(Math.max(t,e),i)}function Qe(t,e,i){let s=`translate3d(${t}px,${e||0}px,0)`;return void 0!==i&&(s+=` scale3d(${i},${i},1)`),s}function Je(t,e,i,s){t.style.transform=Qe(e,i,s)}function ti(t,e,i,s){t.style.transition=e?`${e} ${i}ms ${s||"cubic-bezier(.4,0,.22,1)"}`:"none"}function ei(t,e,i){t.style.width="number"==typeof e?`${e}px`:e,t.style.height="number"==typeof i?`${i}px`:i}const ii="idle",si="loading",ni="loaded",oi="error";function ai(){return!(!navigator.vendor||!navigator.vendor.match(/apple/i))}let ri=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>{ri=!0}}))}catch(Qi){}class hi{constructor(){this._pool=[]}add(t,e,i,s){this._toggleListener(t,e,i,s)}remove(t,e,i,s){this._toggleListener(t,e,i,s,!0)}removeAll(){this._pool.forEach((t=>{this._toggleListener(t.target,t.type,t.listener,t.passive,!0,!0)})),this._pool=[]}_toggleListener(t,e,i,s,n,o){if(!t)return;const a=n?"removeEventListener":"addEventListener";e.split(" ").forEach((e=>{if(e){o||(n?this._pool=this._pool.filter((s=>s.type!==e||s.listener!==i||s.target!==t)):this._pool.push({target:t,type:e,listener:i,passive:s}));const r=!!ri&&{passive:s||!1};t[a](e,i,r)}}))}}function li(t,e){if(t.getViewportSizeFn){const i=t.getViewportSizeFn(t,e);if(i)return i}return{x:document.documentElement.clientWidth,y:window.innerHeight}}function ci(t,e,i,s,n){let o=0;if(e.paddingFn)o=e.paddingFn(i,s,n)[t];else if(e.padding)o=e.padding[t];else{const i="padding"+t[0].toUpperCase()+t.slice(1);e[i]&&(o=e[i])}return Number(o)||0}function di(t,e,i,s){return{x:e.x-ci("left",t,e,i,s)-ci("right",t,e,i,s),y:e.y-ci("top",t,e,i,s)-ci("bottom",t,e,i,s)}}class pi{constructor(t){this.slide=t,this.currZoomLevel=1,this.center={x:0,y:0},this.max={x:0,y:0},this.min={x:0,y:0}}update(t){this.currZoomLevel=t,this.slide.width?(this._updateAxis("x"),this._updateAxis("y"),this.slide.pswp.dispatch("calcBounds",{slide:this.slide})):this.reset()}_updateAxis(t){const{pswp:e}=this.slide,i=this.slide["x"===t?"width":"height"]*this.currZoomLevel,s=ci("x"===t?"left":"top",e.options,e.viewportSize,this.slide.data,this.slide.index),n=this.slide.panAreaSize[t];this.center[t]=Math.round((n-i)/2)+s,this.max[t]=i>n?Math.round(n-i)+s:this.center[t],this.min[t]=i>n?s:this.center[t]}reset(){this.center.x=0,this.center.y=0,this.max.x=0,this.max.y=0,this.min.x=0,this.min.y=0}correctPan(t,e){return Ke(e,this.max[t],this.min[t])}}class ui{constructor(t,e,i,s){this.pswp=s,this.options=t,this.itemData=e,this.index=i,this.panAreaSize=null,this.elementSize=null,this.fit=1,this.fill=1,this.vFill=1,this.initial=1,this.secondary=1,this.max=1,this.min=1}update(t,e,i){const s={x:t,y:e};this.elementSize=s,this.panAreaSize=i;const n=i.x/s.x,o=i.y/s.y;this.fit=Math.min(1,n<o?n:o),this.fill=Math.min(1,n>o?n:o),this.vFill=Math.min(1,o),this.initial=this._getInitial(),this.secondary=this._getSecondary(),this.max=Math.max(this.initial,this.secondary,this._getMax()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}_parseZoomLevelOption(t){const e=t+"ZoomLevel",i=this.options[e];if(i)return"function"==typeof i?i(this):"fill"===i?this.fill:"fit"===i?this.fit:Number(i)}_getSecondary(){let t=this._parseZoomLevelOption("secondary");return t||(t=Math.min(1,3*this.fit),this.elementSize&&t*this.elementSize.x>4e3&&(t=4e3/this.elementSize.x),t)}_getInitial(){return this._parseZoomLevelOption("initial")||this.fit}_getMax(){return this._parseZoomLevelOption("max")||Math.max(1,4*this.fit)}}class mi{constructor(t,e,i){this.data=t,this.index=e,this.pswp=i,this.isActive=e===i.currIndex,this.currentResolution=0,this.panAreaSize={x:0,y:0},this.pan={x:0,y:0},this.isFirstSlide=this.isActive&&!i.opener.isOpen,this.zoomLevels=new ui(i.options,t,e,i),this.pswp.dispatch("gettingData",{slide:this,data:this.data,index:e}),this.content=this.pswp.contentLoader.getContentBySlide(this),this.container=Xe("pswp__zoom-wrap","div"),this.holderElement=null,this.currZoomLevel=1,this.width=this.content.width,this.height=this.content.height,this.heavyAppended=!1,this.bounds=new pi(this),this.prevDisplayedWidth=-1,this.prevDisplayedHeight=-1,this.pswp.dispatch("slideInit",{slide:this})}setIsActive(t){t&&!this.isActive?this.activate():!t&&this.isActive&&this.deactivate()}append(t){this.holderElement=t,this.container.style.transformOrigin="0 0",this.data&&(this.calculateSize(),this.load(),this.updateContentSize(),this.appendHeavy(),this.holderElement.appendChild(this.container),this.zoomAndPanToInitial(),this.pswp.dispatch("firstZoomPan",{slide:this}),this.applyCurrentZoomPan(),this.pswp.dispatch("afterSetContent",{slide:this}),this.isActive&&this.activate())}load(){this.content.load(!1),this.pswp.dispatch("slideLoad",{slide:this})}appendHeavy(){const{pswp:t}=this;!this.heavyAppended&&t.opener.isOpen&&!t.mainScroll.isShifted()&&(this.isActive,1)&&(this.pswp.dispatch("appendHeavy",{slide:this}).defaultPrevented||(this.heavyAppended=!0,this.content.append(),this.pswp.dispatch("appendHeavyContent",{slide:this})))}activate(){this.isActive=!0,this.appendHeavy(),this.content.activate(),this.pswp.dispatch("slideActivate",{slide:this})}deactivate(){this.isActive=!1,this.content.deactivate(),this.currZoomLevel!==this.zoomLevels.initial&&this.calculateSize(),this.currentResolution=0,this.zoomAndPanToInitial(),this.applyCurrentZoomPan(),this.updateContentSize(),this.pswp.dispatch("slideDeactivate",{slide:this})}destroy(){this.content.hasSlide=!1,this.content.remove(),this.container.remove(),this.pswp.dispatch("slideDestroy",{slide:this})}resize(){this.currZoomLevel!==this.zoomLevels.initial&&this.isActive?(this.calculateSize(),this.bounds.update(this.currZoomLevel),this.panTo(this.pan.x,this.pan.y)):(this.calculateSize(),this.currentResolution=0,this.zoomAndPanToInitial(),this.applyCurrentZoomPan(),this.updateContentSize())}updateContentSize(t){const e=this.currentResolution||this.zoomLevels.initial;if(!e)return;const i=Math.round(this.width*e)||this.pswp.viewportSize.x,s=Math.round(this.height*e)||this.pswp.viewportSize.y;(this.sizeChanged(i,s)||t)&&this.content.setDisplayedSize(i,s)}sizeChanged(t,e){return(t!==this.prevDisplayedWidth||e!==this.prevDisplayedHeight)&&(this.prevDisplayedWidth=t,this.prevDisplayedHeight=e,!0)}getPlaceholderElement(){var t;return null===(t=this.content.placeholder)||void 0===t?void 0:t.element}zoomTo(t,e,i,s){const{pswp:n}=this;if(!this.isZoomable()||n.mainScroll.isShifted())return;n.dispatch("beforeZoomTo",{destZoomLevel:t,centerPoint:e,transitionDuration:i}),n.animations.stopAllPan();const o=this.currZoomLevel;s||(t=Ke(t,this.zoomLevels.min,this.zoomLevels.max)),this.setZoomLevel(t),this.pan.x=this.calculateZoomToPanOffset("x",e,o),this.pan.y=this.calculateZoomToPanOffset("y",e,o),Ve(this.pan);const a=()=>{this._setResolution(t),this.applyCurrentZoomPan()};i?n.animations.startTransition({isPan:!0,name:"zoomTo",target:this.container,transform:this.getCurrentTransform(),onComplete:a,duration:i,easing:n.options.easing}):a()}toggleZoom(t){this.zoomTo(this.currZoomLevel===this.zoomLevels.initial?this.zoomLevels.secondary:this.zoomLevels.initial,t,this.pswp.options.zoomAnimationDuration)}setZoomLevel(t){this.currZoomLevel=t,this.bounds.update(this.currZoomLevel)}calculateZoomToPanOffset(t,e,i){if(0===this.bounds.max[t]-this.bounds.min[t])return this.bounds.center[t];e||(e=this.pswp.getViewportCenterPoint()),i||(i=this.zoomLevels.initial);const s=this.currZoomLevel/i;return this.bounds.correctPan(t,(this.pan[t]-e[t])*s+e[t])}panTo(t,e){this.pan.x=this.bounds.correctPan("x",t),this.pan.y=this.bounds.correctPan("y",e),this.applyCurrentZoomPan()}isPannable(){return Boolean(this.width)&&this.currZoomLevel>this.zoomLevels.fit}isZoomable(){return Boolean(this.width)&&this.content.isZoomable()}applyCurrentZoomPan(){this._applyZoomTransform(this.pan.x,this.pan.y,this.currZoomLevel),this===this.pswp.currSlide&&this.pswp.dispatch("zoomPanUpdate",{slide:this})}zoomAndPanToInitial(){this.currZoomLevel=this.zoomLevels.initial,this.bounds.update(this.currZoomLevel),Ye(this.pan,this.bounds.center),this.pswp.dispatch("initialZoomPan",{slide:this})}_applyZoomTransform(t,e,i){i/=this.currentResolution||this.zoomLevels.initial,Je(this.container,t,e,i)}calculateSize(){const{pswp:t}=this;Ye(this.panAreaSize,di(t.options,t.viewportSize,this.data,this.index)),this.zoomLevels.update(this.width,this.height,this.panAreaSize),t.dispatch("calcSlideSize",{slide:this})}getCurrentTransform(){const t=this.currZoomLevel/(this.currentResolution||this.zoomLevels.initial);return Qe(this.pan.x,this.pan.y,t)}_setResolution(t){t!==this.currentResolution&&(this.currentResolution=t,this.updateContentSize(),this.pswp.dispatch("resolutionChanged"))}}class gi{constructor(t){this.gestures=t,this.pswp=t.pswp,this.startPan={x:0,y:0}}start(){this.pswp.currSlide&&Ye(this.startPan,this.pswp.currSlide.pan),this.pswp.animations.stopAll()}change(){const{p1:t,prevP1:e,dragAxis:i}=this.gestures,{currSlide:s}=this.pswp;if("y"===i&&this.pswp.options.closeOnVerticalDrag&&s&&s.currZoomLevel<=s.zoomLevels.fit&&!this.gestures.isMultitouch){const i=s.pan.y+(t.y-e.y);if(!this.pswp.dispatch("verticalDrag",{panY:i}).defaultPrevented){this._setPanWithFriction("y",i,.6);const t=1-Math.abs(this._getVerticalDragRatio(s.pan.y));this.pswp.applyBgOpacity(t),s.applyCurrentZoomPan()}}else{this._panOrMoveMainScroll("x")||(this._panOrMoveMainScroll("y"),s&&(Ve(s.pan),s.applyCurrentZoomPan()))}}end(){const{velocity:t}=this.gestures,{mainScroll:e,currSlide:i}=this.pswp;let s=0;if(this.pswp.animations.stopAll(),e.isShifted()){const i=(e.x-e.getCurrSlideX())/this.pswp.viewportSize.x;t.x<-.5&&i<0||t.x<.1&&i<-.5?(s=1,t.x=Math.min(t.x,0)):(t.x>.5&&i>0||t.x>-.1&&i>.5)&&(s=-1,t.x=Math.max(t.x,0)),e.moveIndexBy(s,!0,t.x)}i&&i.currZoomLevel>i.zoomLevels.max||this.gestures.isMultitouch?this.gestures.zoomLevels.correctZoomPan(!0):(this._finishPanGestureForAxis("x"),this._finishPanGestureForAxis("y"))}_finishPanGestureForAxis(t){const{velocity:e}=this.gestures,{currSlide:i}=this.pswp;if(!i)return;const{pan:s,bounds:n}=i,o=s[t],a=this.pswp.bgOpacity<1&&"y"===t,r=o+function(t,e){return t*e/(1-e)}(e[t],.995);if(a){const t=this._getVerticalDragRatio(o),e=this._getVerticalDragRatio(r);if(t<0&&e<-.4||t>0&&e>.4)return void this.pswp.close()}const h=n.correctPan(t,r);if(o===h)return;const l=h===r?1:.82,c=this.pswp.bgOpacity,d=h-o;this.pswp.animations.startSpring({name:"panGesture"+t,isPan:!0,start:o,end:h,velocity:e[t],dampingRatio:l,onUpdate:e=>{if(a&&this.pswp.bgOpacity<1){const t=1-(h-e)/d;this.pswp.applyBgOpacity(Ke(c+(1-c)*t,0,1))}s[t]=Math.floor(e),i.applyCurrentZoomPan()}})}_panOrMoveMainScroll(t){const{p1:e,dragAxis:i,prevP1:s,isMultitouch:n}=this.gestures,{currSlide:o,mainScroll:a}=this.pswp,r=e[t]-s[t],h=a.x+r;if(!r||!o)return!1;if("x"===t&&!o.isPannable()&&!n)return a.moveTo(h,!0),!0;const{bounds:l}=o,c=o.pan[t]+r;if(this.pswp.options.allowPanToNext&&"x"===i&&"x"===t&&!n){const e=a.getCurrSlideX(),i=a.x-e,s=r>0,n=!s;if(c>l.min[t]&&s){if(l.min[t]<=this.startPan[t])return a.moveTo(h,!0),!0;this._setPanWithFriction(t,c)}else if(c<l.max[t]&&n){if(this.startPan[t]<=l.max[t])return a.moveTo(h,!0),!0;this._setPanWithFriction(t,c)}else if(0!==i){if(i>0)return a.moveTo(Math.max(h,e),!0),!0;if(i<0)return a.moveTo(Math.min(h,e),!0),!0}else this._setPanWithFriction(t,c)}else"y"===t&&(a.isShifted()||l.min.y===l.max.y)||this._setPanWithFriction(t,c);return!1}_getVerticalDragRatio(t){var e,i;return(t-(null!==(e=null===(i=this.pswp.currSlide)||void 0===i?void 0:i.bounds.center.y)&&void 0!==e?e:0))/(this.pswp.viewportSize.y/3)}_setPanWithFriction(t,e,i){const{currSlide:s}=this.pswp;if(!s)return;const{pan:n,bounds:o}=s;if(o.correctPan(t,e)!==e||i){const s=Math.round(e-n[t]);n[t]+=s*(i||.35)}else n[t]=e}}function fi(t,e,i){return t.x=(e.x+i.x)/2,t.y=(e.y+i.y)/2,t}class vi{constructor(t){this.gestures=t,this._startPan={x:0,y:0},this._startZoomPoint={x:0,y:0},this._zoomPoint={x:0,y:0},this._wasOverFitZoomLevel=!1,this._startZoomLevel=1}start(){const{currSlide:t}=this.gestures.pswp;t&&(this._startZoomLevel=t.currZoomLevel,Ye(this._startPan,t.pan)),this.gestures.pswp.animations.stopAllPan(),this._wasOverFitZoomLevel=!1}change(){const{p1:t,startP1:e,p2:i,startP2:s,pswp:n}=this.gestures,{currSlide:o}=n;if(!o)return;const a=o.zoomLevels.min,r=o.zoomLevels.max;if(!o.isZoomable()||n.mainScroll.isShifted())return;fi(this._startZoomPoint,e,s),fi(this._zoomPoint,t,i);let h=1/qe(e,s)*qe(t,i)*this._startZoomLevel;if(h>o.zoomLevels.initial+o.zoomLevels.initial/15&&(this._wasOverFitZoomLevel=!0),h<a)if(n.options.pinchToClose&&!this._wasOverFitZoomLevel&&this._startZoomLevel<=o.zoomLevels.initial){const t=1-(a-h)/(a/1.2);n.dispatch("pinchClose",{bgOpacity:t}).defaultPrevented||n.applyBgOpacity(t)}else h=a-.15*(a-h);else h>r&&(h=r+.05*(h-r));o.pan.x=this._calculatePanForZoomLevel("x",h),o.pan.y=this._calculatePanForZoomLevel("y",h),o.setZoomLevel(h),o.applyCurrentZoomPan()}end(){const{pswp:t}=this.gestures,{currSlide:e}=t;(!e||e.currZoomLevel<e.zoomLevels.initial)&&!this._wasOverFitZoomLevel&&t.options.pinchToClose?t.close():this.correctZoomPan()}_calculatePanForZoomLevel(t,e){const i=e/this._startZoomLevel;return this._zoomPoint[t]-(this._startZoomPoint[t]-this._startPan[t])*i}correctZoomPan(t){const{pswp:e}=this.gestures,{currSlide:i}=e;if(null==i||!i.isZoomable())return;0===this._zoomPoint.x&&(t=!0);const s=i.currZoomLevel;let n,o=!0;s<i.zoomLevels.initial?n=i.zoomLevels.initial:s>i.zoomLevels.max?n=i.zoomLevels.max:(o=!1,n=s);const a=e.bgOpacity,r=e.bgOpacity<1,h=Ye({x:0,y:0},i.pan);let l=Ye({x:0,y:0},h);t&&(this._zoomPoint.x=0,this._zoomPoint.y=0,this._startZoomPoint.x=0,this._startZoomPoint.y=0,this._startZoomLevel=s,Ye(this._startPan,h)),o&&(l={x:this._calculatePanForZoomLevel("x",n),y:this._calculatePanForZoomLevel("y",n)}),i.setZoomLevel(n),l={x:i.bounds.correctPan("x",l.x),y:i.bounds.correctPan("y",l.y)},i.setZoomLevel(s);const c=!Ge(l,h);if(!c&&!o&&!r)return i._setResolution(n),void i.applyCurrentZoomPan();e.animations.stopAllPan(),e.animations.startSpring({isPan:!0,start:0,end:1e3,velocity:0,dampingRatio:1,naturalFrequency:40,onUpdate:t=>{if(t/=1e3,c||o){if(c&&(i.pan.x=h.x+(l.x-h.x)*t,i.pan.y=h.y+(l.y-h.y)*t),o){const e=s+(n-s)*t;i.setZoomLevel(e)}i.applyCurrentZoomPan()}r&&e.bgOpacity<1&&e.applyBgOpacity(Ke(a+(1-a)*t,0,1))},onComplete:()=>{i._setResolution(n),i.applyCurrentZoomPan()}})}}function wi(t){return!!t.target.closest(".pswp__container")}class yi{constructor(t){this.gestures=t}click(t,e){const i=e.target.classList,s=i.contains("pswp__img"),n=i.contains("pswp__item")||i.contains("pswp__zoom-wrap");s?this._doClickOrTapAction("imageClick",t,e):n&&this._doClickOrTapAction("bgClick",t,e)}tap(t,e){wi(e)&&this._doClickOrTapAction("tap",t,e)}doubleTap(t,e){wi(e)&&this._doClickOrTapAction("doubleTap",t,e)}_doClickOrTapAction(t,e,i){var s;const{pswp:n}=this.gestures,{currSlide:o}=n,a=t+"Action",r=n.options[a];if(!n.dispatch(a,{point:e,originalEvent:i}).defaultPrevented)if("function"!=typeof r)switch(r){case"close":case"next":n[r]();break;case"zoom":null==o||o.toggleZoom(e);break;case"zoom-or-close":null!=o&&o.isZoomable()&&o.zoomLevels.secondary!==o.zoomLevels.initial?o.toggleZoom(e):n.options.clickToCloseNonZoomable&&n.close();break;case"toggle-controls":null===(s=this.gestures.pswp.element)||void 0===s||s.classList.toggle("pswp--ui-visible")}else r.call(n,e,i)}}class bi{constructor(t){this.pswp=t,this.dragAxis=null,this.p1={x:0,y:0},this.p2={x:0,y:0},this.prevP1={x:0,y:0},this.prevP2={x:0,y:0},this.startP1={x:0,y:0},this.startP2={x:0,y:0},this.velocity={x:0,y:0},this._lastStartP1={x:0,y:0},this._intervalP1={x:0,y:0},this._numActivePoints=0,this._ongoingPointers=[],this._touchEventEnabled="ontouchstart"in window,this._pointerEventEnabled=!!window.PointerEvent,this.supportsTouch=this._touchEventEnabled||this._pointerEventEnabled&&navigator.maxTouchPoints>1,this._numActivePoints=0,this._intervalTime=0,this._velocityCalculated=!1,this.isMultitouch=!1,this.isDragging=!1,this.isZooming=!1,this.raf=null,this._tapTimer=null,this.supportsTouch||(t.options.allowPanToNext=!1),this.drag=new gi(this),this.zoomLevels=new vi(this),this.tapHandler=new yi(this),t.on("bindEvents",(()=>{t.events.add(t.scrollWrap,"click",this._onClick.bind(this)),this._pointerEventEnabled?this._bindEvents("pointer","down","up","cancel"):this._touchEventEnabled?(this._bindEvents("touch","start","end","cancel"),t.scrollWrap&&(t.scrollWrap.ontouchmove=()=>{},t.scrollWrap.ontouchend=()=>{})):this._bindEvents("mouse","down","up")}))}_bindEvents(t,e,i,s){const{pswp:n}=this,{events:o}=n,a=s?t+s:"";o.add(n.scrollWrap,t+e,this.onPointerDown.bind(this)),o.add(window,t+"move",this.onPointerMove.bind(this)),o.add(window,t+i,this.onPointerUp.bind(this)),a&&o.add(n.scrollWrap,a,this.onPointerUp.bind(this))}onPointerDown(t){const e="mousedown"===t.type||"mouse"===t.pointerType;if(e&&t.button>0)return;const{pswp:i}=this;i.opener.isOpen?i.dispatch("pointerDown",{originalEvent:t}).defaultPrevented||(e&&(i.mouseDetected(),this._preventPointerEventBehaviour(t,"down")),i.animations.stopAll(),this._updatePoints(t,"down"),1===this._numActivePoints&&(this.dragAxis=null,Ye(this.startP1,this.p1)),this._numActivePoints>1?(this._clearTapTimer(),this.isMultitouch=!0):this.isMultitouch=!1):t.preventDefault()}onPointerMove(t){this._preventPointerEventBehaviour(t,"move"),this._numActivePoints&&(this._updatePoints(t,"move"),this.pswp.dispatch("pointerMove",{originalEvent:t}).defaultPrevented||(1!==this._numActivePoints||this.isDragging?this._numActivePoints>1&&!this.isZooming&&(this._finishDrag(),this.isZooming=!0,this._updateStartPoints(),this.zoomLevels.start(),this._rafStopLoop(),this._rafRenderLoop()):(this.dragAxis||this._calculateDragDirection(),this.dragAxis&&!this.isDragging&&(this.isZooming&&(this.isZooming=!1,this.zoomLevels.end()),this.isDragging=!0,this._clearTapTimer(),this._updateStartPoints(),this._intervalTime=Date.now(),this._velocityCalculated=!1,Ye(this._intervalP1,this.p1),this.velocity.x=0,this.velocity.y=0,this.drag.start(),this._rafStopLoop(),this._rafRenderLoop()))))}_finishDrag(){this.isDragging&&(this.isDragging=!1,this._velocityCalculated||this._updateVelocity(!0),this.drag.end(),this.dragAxis=null)}onPointerUp(t){this._numActivePoints&&(this._updatePoints(t,"up"),this.pswp.dispatch("pointerUp",{originalEvent:t}).defaultPrevented||(0===this._numActivePoints&&(this._rafStopLoop(),this.isDragging?this._finishDrag():this.isZooming||this.isMultitouch||this._finishTap(t)),this._numActivePoints<2&&this.isZooming&&(this.isZooming=!1,this.zoomLevels.end(),1===this._numActivePoints&&(this.dragAxis=null,this._updateStartPoints()))))}_rafRenderLoop(){(this.isDragging||this.isZooming)&&(this._updateVelocity(),this.isDragging?Ge(this.p1,this.prevP1)||this.drag.change():Ge(this.p1,this.prevP1)&&Ge(this.p2,this.prevP2)||this.zoomLevels.change(),this._updatePrevPoints(),this.raf=requestAnimationFrame(this._rafRenderLoop.bind(this)))}_updateVelocity(t){const e=Date.now(),i=e-this._intervalTime;i<50&&!t||(this.velocity.x=this._getVelocity("x",i),this.velocity.y=this._getVelocity("y",i),this._intervalTime=e,Ye(this._intervalP1,this.p1),this._velocityCalculated=!0)}_finishTap(t){const{mainScroll:e}=this.pswp;if(e.isShifted())return void e.moveIndexBy(0,!0);if(t.type.indexOf("cancel")>0)return;if("mouseup"===t.type||"mouse"===t.pointerType)return void this.tapHandler.click(this.startP1,t);const i=this.pswp.options.doubleTapAction?300:0;this._tapTimer?(this._clearTapTimer(),qe(this._lastStartP1,this.startP1)<25&&this.tapHandler.doubleTap(this.startP1,t)):(Ye(this._lastStartP1,this.startP1),this._tapTimer=setTimeout((()=>{this.tapHandler.tap(this.startP1,t),this._clearTapTimer()}),i))}_clearTapTimer(){this._tapTimer&&(clearTimeout(this._tapTimer),this._tapTimer=null)}_getVelocity(t,e){const i=this.p1[t]-this._intervalP1[t];return Math.abs(i)>1&&e>5?i/e:0}_rafStopLoop(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}_preventPointerEventBehaviour(t,e){this.pswp.applyFilters("preventPointerEvent",!0,t,e)&&t.preventDefault()}_updatePoints(t,e){if(this._pointerEventEnabled){const i=t,s=this._ongoingPointers.findIndex((t=>t.id===i.pointerId));"up"===e&&s>-1?this._ongoingPointers.splice(s,1):"down"===e&&-1===s?this._ongoingPointers.push(this._convertEventPosToPoint(i,{x:0,y:0})):s>-1&&this._convertEventPosToPoint(i,this._ongoingPointers[s]),this._numActivePoints=this._ongoingPointers.length,this._numActivePoints>0&&Ye(this.p1,this._ongoingPointers[0]),this._numActivePoints>1&&Ye(this.p2,this._ongoingPointers[1])}else{const i=t;this._numActivePoints=0,i.type.indexOf("touch")>-1?i.touches&&i.touches.length>0&&(this._convertEventPosToPoint(i.touches[0],this.p1),this._numActivePoints++,i.touches.length>1&&(this._convertEventPosToPoint(i.touches[1],this.p2),this._numActivePoints++)):(this._convertEventPosToPoint(t,this.p1),"up"===e?this._numActivePoints=0:this._numActivePoints++)}}_updatePrevPoints(){Ye(this.prevP1,this.p1),Ye(this.prevP2,this.p2)}_updateStartPoints(){Ye(this.startP1,this.p1),Ye(this.startP2,this.p2),this._updatePrevPoints()}_calculateDragDirection(){if(this.pswp.mainScroll.isShifted())this.dragAxis="x";else{const t=Math.abs(this.p1.x-this.startP1.x)-Math.abs(this.p1.y-this.startP1.y);if(0!==t){const e=t>0?"x":"y";Math.abs(this.p1[e]-this.startP1[e])>=10&&(this.dragAxis=e)}}}_convertEventPosToPoint(t,e){return e.x=t.pageX-this.pswp.offset.x,e.y=t.pageY-this.pswp.offset.y,"pointerId"in t?e.id=t.pointerId:void 0!==t.identifier&&(e.id=t.identifier),e}_onClick(t){this.pswp.mainScroll.isShifted()&&(t.preventDefault(),t.stopPropagation())}}class _i{constructor(t){this.pswp=t,this.x=0,this.slideWidth=0,this._currPositionIndex=0,this._prevPositionIndex=0,this._containerShiftIndex=-1,this.itemHolders=[]}resize(t){const{pswp:e}=this,i=Math.round(e.viewportSize.x+e.viewportSize.x*e.options.spacing),s=i!==this.slideWidth;s&&(this.slideWidth=i,this.moveTo(this.getCurrSlideX())),this.itemHolders.forEach(((e,i)=>{s&&Je(e.el,(i+this._containerShiftIndex)*this.slideWidth),t&&e.slide&&e.slide.resize()}))}resetPosition(){this._currPositionIndex=0,this._prevPositionIndex=0,this.slideWidth=0,this._containerShiftIndex=-1}appendHolders(){this.itemHolders=[];for(let t=0;t<3;t++){const e=Xe("pswp__item","div",this.pswp.container);e.setAttribute("role","group"),e.setAttribute("aria-roledescription","slide"),e.setAttribute("aria-hidden","true"),e.style.display=1===t?"block":"none",this.itemHolders.push({el:e})}}canBeSwiped(){return this.pswp.getNumItems()>1}moveIndexBy(t,e,i){const{pswp:s}=this;let n=s.potentialIndex+t;const o=s.getNumItems();if(s.canLoop()){n=s.getLoopedIndex(n);const e=(t+o)%o;t=e<=o/2?e:e-o}else n<0?n=0:n>=o&&(n=o-1),t=n-s.potentialIndex;s.potentialIndex=n,this._currPositionIndex-=t,s.animations.stopMainScroll();const a=this.getCurrSlideX();if(e){s.animations.startSpring({isMainScroll:!0,start:this.x,end:a,velocity:i||0,naturalFrequency:30,dampingRatio:1,onUpdate:t=>{this.moveTo(t)},onComplete:()=>{this.updateCurrItem(),s.appendHeavy()}});let t=s.potentialIndex-s.currIndex;if(s.canLoop()){const e=(t+o)%o;t=e<=o/2?e:e-o}Math.abs(t)>1&&this.updateCurrItem()}else this.moveTo(a),this.updateCurrItem();return Boolean(t)}getCurrSlideX(){return this.slideWidth*this._currPositionIndex}isShifted(){return this.x!==this.getCurrSlideX()}updateCurrItem(){var t;const{pswp:e}=this,i=this._prevPositionIndex-this._currPositionIndex;if(!i)return;this._prevPositionIndex=this._currPositionIndex,e.currIndex=e.potentialIndex;let s,n=Math.abs(i);n>=3&&(this._containerShiftIndex+=i+(i>0?-3:3),n=3,this.itemHolders.forEach((t=>{var e;null===(e=t.slide)||void 0===e||e.destroy(),t.slide=void 0})));for(let o=0;o<n;o++)i>0?(s=this.itemHolders.shift(),s&&(this.itemHolders[2]=s,this._containerShiftIndex++,Je(s.el,(this._containerShiftIndex+2)*this.slideWidth),e.setContent(s,e.currIndex-n+o+2))):(s=this.itemHolders.pop(),s&&(this.itemHolders.unshift(s),this._containerShiftIndex--,Je(s.el,this._containerShiftIndex*this.slideWidth),e.setContent(s,e.currIndex+n-o-2)));Math.abs(this._containerShiftIndex)>50&&!this.isShifted()&&(this.resetPosition(),this.resize()),e.animations.stopAllPan(),this.itemHolders.forEach(((t,e)=>{t.slide&&t.slide.setIsActive(1===e)})),e.currSlide=null===(t=this.itemHolders[1])||void 0===t?void 0:t.slide,e.contentLoader.updateLazy(i),e.currSlide&&e.currSlide.applyCurrentZoomPan(),e.dispatch("change")}moveTo(t,e){if(!this.pswp.canLoop()&&e){let e=(this.slideWidth*this._currPositionIndex-t)/this.slideWidth;e+=this.pswp.currIndex;const i=Math.round(t-this.x);(e<0&&i>0||e>=this.pswp.getNumItems()-1&&i<0)&&(t=this.x+.35*i)}this.x=t,this.pswp.container&&Je(this.pswp.container,t),this.pswp.dispatch("moveMainScroll",{x:t,dragging:null!=e&&e})}}const xi={Escape:27,z:90,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Tab:9},zi=(t,e)=>e?t:xi[t];class Si{constructor(t){this.pswp=t,this._wasFocused=!1,t.on("bindEvents",(()=>{t.options.trapFocus&&(t.options.initialPointerPos||this._focusRoot(),t.events.add(document,"focusin",this._onFocusIn.bind(this))),t.events.add(document,"keydown",this._onKeyDown.bind(this))}));const e=document.activeElement;t.on("destroy",(()=>{t.options.returnFocus&&e&&this._wasFocused&&e.focus()}))}_focusRoot(){!this._wasFocused&&this.pswp.element&&(this.pswp.element.focus(),this._wasFocused=!0)}_onKeyDown(t){const{pswp:e}=this;if(e.dispatch("keydown",{originalEvent:t}).defaultPrevented)return;if(function(t){return"button"in t&&1===t.button||t.ctrlKey||t.metaKey||t.altKey||t.shiftKey}(t))return;let i,s,n=!1;const o="key"in t;switch(o?t.key:t.keyCode){case zi("Escape",o):e.options.escKey&&(i="close");break;case zi("z",o):i="toggleZoom";break;case zi("ArrowLeft",o):s="x";break;case zi("ArrowUp",o):s="y";break;case zi("ArrowRight",o):s="x",n=!0;break;case zi("ArrowDown",o):n=!0,s="y";break;case zi("Tab",o):this._focusRoot()}if(s){t.preventDefault();const{currSlide:o}=e;e.options.arrowKeys&&"x"===s&&e.getNumItems()>1?i=n?"next":"prev":o&&o.currZoomLevel>o.zoomLevels.fit&&(o.pan[s]+=n?-80:80,o.panTo(o.pan.x,o.pan.y))}i&&(t.preventDefault(),e[i]())}_onFocusIn(t){const{template:e}=this.pswp;e&&document!==t.target&&e!==t.target&&!e.contains(t.target)&&e.focus()}}const Ai="cubic-bezier(.4,0,.22,1)";class Ri{constructor(t){var e;this.props=t;const{target:i,onComplete:s,transform:n,onFinish:o=()=>{},duration:a=333,easing:r=Ai}=t;this.onFinish=o;const h=n?"transform":"opacity",l=null!==(e=t[h])&&void 0!==e?e:"";this._target=i,this._onComplete=s,this._finished=!1,this._onTransitionEnd=this._onTransitionEnd.bind(this),this._helperTimeout=setTimeout((()=>{ti(i,h,a,r),this._helperTimeout=setTimeout((()=>{i.addEventListener("transitionend",this._onTransitionEnd,!1),i.addEventListener("transitioncancel",this._onTransitionEnd,!1),this._helperTimeout=setTimeout((()=>{this._finalizeAnimation()}),a+500),i.style[h]=l}),30)}),0)}_onTransitionEnd(t){t.target===this._target&&this._finalizeAnimation()}_finalizeAnimation(){this._finished||(this._finished=!0,this.onFinish(),this._onComplete&&this._onComplete())}destroy(){this._helperTimeout&&clearTimeout(this._helperTimeout),ti(this._target),this._target.removeEventListener("transitionend",this._onTransitionEnd,!1),this._target.removeEventListener("transitioncancel",this._onTransitionEnd,!1),this._finished||this._finalizeAnimation()}}class Ci{constructor(t,e,i){this.velocity=1e3*t,this._dampingRatio=e||.75,this._naturalFrequency=i||12,this._dampedFrequency=this._naturalFrequency,this._dampingRatio<1&&(this._dampedFrequency*=Math.sqrt(1-this._dampingRatio*this._dampingRatio))}easeFrame(t,e){let i,s=0;e/=1e3;const n=Math.E**(-this._dampingRatio*this._naturalFrequency*e);if(1===this._dampingRatio)i=this.velocity+this._naturalFrequency*t,s=(t+i*e)*n,this.velocity=s*-this._naturalFrequency+i*n;else if(this._dampingRatio<1){i=1/this._dampedFrequency*(this._dampingRatio*this._naturalFrequency*t+this.velocity);const o=Math.cos(this._dampedFrequency*e),a=Math.sin(this._dampedFrequency*e);s=n*(t*o+i*a),this.velocity=s*-this._naturalFrequency*this._dampingRatio+n*(-this._dampedFrequency*t*a+this._dampedFrequency*i*o)}return s}}class Pi{constructor(t){this.props=t,this._raf=0;const{start:e,end:i,velocity:s,onUpdate:n,onComplete:o,onFinish:a=()=>{},dampingRatio:r,naturalFrequency:h}=t;this.onFinish=a;const l=new Ci(s,r,h);let c=Date.now(),d=e-i;const p=()=>{this._raf&&(d=l.easeFrame(d,Date.now()-c),Math.abs(d)<1&&Math.abs(l.velocity)<50?(n(i),o&&o(),this.onFinish()):(c=Date.now(),n(d+i),this._raf=requestAnimationFrame(p)))};this._raf=requestAnimationFrame(p)}destroy(){this._raf>=0&&cancelAnimationFrame(this._raf),this._raf=0}}class Mi{constructor(){this.activeAnimations=[]}startSpring(t){this._start(t,!0)}startTransition(t){this._start(t)}_start(t,e){const i=e?new Pi(t):new Ri(t);return this.activeAnimations.push(i),i.onFinish=()=>this.stop(i),i}stop(t){t.destroy();const e=this.activeAnimations.indexOf(t);e>-1&&this.activeAnimations.splice(e,1)}stopAll(){this.activeAnimations.forEach((t=>{t.destroy()})),this.activeAnimations=[]}stopAllPan(){this.activeAnimations=this.activeAnimations.filter((t=>!t.props.isPan||(t.destroy(),!1)))}stopMainScroll(){this.activeAnimations=this.activeAnimations.filter((t=>!t.props.isMainScroll||(t.destroy(),!1)))}isPanRunning(){return this.activeAnimations.some((t=>t.props.isPan))}}class Ti{constructor(t){this.pswp=t,t.events.add(t.element,"wheel",this._onWheel.bind(this))}_onWheel(t){t.preventDefault();const{currSlide:e}=this.pswp;let{deltaX:i,deltaY:s}=t;if(e&&!this.pswp.dispatch("wheel",{originalEvent:t}).defaultPrevented)if(t.ctrlKey||this.pswp.options.wheelToZoom){if(e.isZoomable()){let i=-s;1===t.deltaMode?i*=.05:i*=t.deltaMode?1:.002,i=2**i;const n=e.currZoomLevel*i;e.zoomTo(n,{x:t.clientX,y:t.clientY})}}else e.isPannable()&&(1===t.deltaMode&&(i*=18,s*=18),e.panTo(e.pan.x-i,e.pan.y-s))}}class Ei{constructor(t,e){var i;const s=e.name||e.className;let n=e.html;if(!1===t.options[s])return;"string"==typeof t.options[s+"SVG"]&&(n=t.options[s+"SVG"]),t.dispatch("uiElementCreate",{data:e});let o="";e.isButton?(o+="pswp__button ",o+=e.className||`pswp__button--${e.name}`):o+=e.className||`pswp__${e.name}`;let a=e.isButton?e.tagName||"button":e.tagName||"div";a=a.toLowerCase();const r=Xe(o,a);if(e.isButton){"button"===a&&(r.type="button");let{title:i}=e;const{ariaLabel:n}=e;"string"==typeof t.options[s+"Title"]&&(i=t.options[s+"Title"]),i&&(r.title=i);const o=n||i;o&&r.setAttribute("aria-label",o)}r.innerHTML=function(t){if("string"==typeof t)return t;if(!t||!t.isCustomSVG)return"";const e=t;let i='<svg aria-hidden="true" class="pswp__icn" viewBox="0 0 %d %d" width="%d" height="%d">';return i=i.split("%d").join(e.size||32),e.outlineID&&(i+='<use class="pswp__icn-shadow" xlink:href="#'+e.outlineID+'"/>'),i+=e.inner,i+="</svg>",i}(n),e.onInit&&e.onInit(r,t),e.onClick&&(r.onclick=i=>{"string"==typeof e.onClick?t[e.onClick]():"function"==typeof e.onClick&&e.onClick(i,r,t)});const h=e.appendTo||"bar";let l=t.element;"bar"===h?(t.topBar||(t.topBar=Xe("pswp__top-bar pswp__hide-on-close","div",t.scrollWrap)),l=t.topBar):(r.classList.add("pswp__hide-on-close"),"wrapper"===h&&(l=t.scrollWrap)),null===(i=l)||void 0===i||i.appendChild(t.applyFilters("uiElement",r,e))}}function Ii(t,e,i){t.classList.add("pswp__button--arrow"),t.setAttribute("aria-controls","pswp__items"),e.on("change",(()=>{e.options.loop||(t.disabled=i?!(e.currIndex<e.getNumItems()-1):!(e.currIndex>0))}))}const Oi={name:"arrowPrev",className:"pswp__button--arrow--prev",title:"Previous",order:10,isButton:!0,appendTo:"wrapper",html:{isCustomSVG:!0,size:60,inner:'<path d="M29 43l-3 3-16-16 16-16 3 3-13 13 13 13z" id="pswp__icn-arrow"/>',outlineID:"pswp__icn-arrow"},onClick:"prev",onInit:Ii},Li={name:"arrowNext",className:"pswp__button--arrow--next",title:"Next",order:11,isButton:!0,appendTo:"wrapper",html:{isCustomSVG:!0,size:60,inner:'<use xlink:href="#pswp__icn-arrow"/>',outlineID:"pswp__icn-arrow"},onClick:"next",onInit:(t,e)=>{Ii(t,e,!0)}},Di={name:"close",title:"Close",order:20,isButton:!0,html:{isCustomSVG:!0,inner:'<path d="M24 10l-2-2-6 6-6-6-2 2 6 6-6 6 2 2 6-6 6 6 2-2-6-6z" id="pswp__icn-close"/>',outlineID:"pswp__icn-close"},onClick:"close"},Wi={name:"zoom",title:"Zoom",order:10,isButton:!0,html:{isCustomSVG:!0,inner:'<path d="M17.426 19.926a6 6 0 1 1 1.5-1.5L23 22.5 21.5 24l-4.074-4.074z" id="pswp__icn-zoom"/><path fill="currentColor" class="pswp__zoom-icn-bar-h" d="M11 16v-2h6v2z"/><path fill="currentColor" class="pswp__zoom-icn-bar-v" d="M13 12h2v6h-2z"/>',outlineID:"pswp__icn-zoom"},onClick:"toggleZoom"},Zi={name:"preloader",appendTo:"bar",order:7,html:{isCustomSVG:!0,inner:'<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2 16a5.2 5.2 0 1 1-5.2-5.2V8a8 8 0 1 0 8 8h-2.8Z" id="pswp__icn-loading"/>',outlineID:"pswp__icn-loading"},onInit:(t,e)=>{let i,s=null;const n=e=>{var s,n;i!==e&&(i=e,s="active",n=e,t.classList.toggle("pswp__preloader--"+s,n))},o=()=>{var t;if(null===(t=e.currSlide)||void 0===t||!t.content.isLoading())return n(!1),void(s&&(clearTimeout(s),s=null));s||(s=setTimeout((()=>{var t;n(Boolean(null===(t=e.currSlide)||void 0===t?void 0:t.content.isLoading())),s=null}),e.options.preloaderDelay))};e.on("change",o),e.on("loadComplete",(t=>{e.currSlide===t.slide&&o()})),e.ui&&(e.ui.updatePreloaderVisibility=o)}},Hi={name:"counter",order:5,onInit:(t,e)=>{e.on("change",(()=>{t.innerText=e.currIndex+1+e.options.indexIndicatorSep+e.getNumItems()}))}};function Bi(t,e){t.classList.toggle("pswp--zoomed-in",e)}class ki{constructor(t){this.pswp=t,this.isRegistered=!1,this.uiElementsData=[],this.items=[],this.updatePreloaderVisibility=()=>{},this._lastUpdatedZoomLevel=void 0}init(){const{pswp:t}=this;this.isRegistered=!1,this.uiElementsData=[Di,Oi,Li,Wi,Zi,Hi],t.dispatch("uiRegister"),this.uiElementsData.sort(((t,e)=>(t.order||0)-(e.order||0))),this.items=[],this.isRegistered=!0,this.uiElementsData.forEach((t=>{this.registerElement(t)})),t.on("change",(()=>{var e;null===(e=t.element)||void 0===e||e.classList.toggle("pswp--one-slide",1===t.getNumItems())})),t.on("zoomPanUpdate",(()=>this._onZoomPanUpdate()))}registerElement(t){this.isRegistered?this.items.push(new Ei(this.pswp,t)):this.uiElementsData.push(t)}_onZoomPanUpdate(){const{template:t,currSlide:e,options:i}=this.pswp;if(this.pswp.opener.isClosing||!t||!e)return;let{currZoomLevel:s}=e;if(this.pswp.opener.isOpen||(s=e.zoomLevels.initial),s===this._lastUpdatedZoomLevel)return;this._lastUpdatedZoomLevel=s;const n=e.zoomLevels.initial-e.zoomLevels.secondary;if(Math.abs(n)<.01||!e.isZoomable())return Bi(t,!1),void t.classList.remove("pswp--zoom-allowed");t.classList.add("pswp--zoom-allowed");Bi(t,(s===e.zoomLevels.initial?e.zoomLevels.secondary:e.zoomLevels.initial)<=s),"zoom"!==i.imageClickAction&&"zoom-or-close"!==i.imageClickAction||t.classList.add("pswp--click-to-zoom")}}class Fi{constructor(t,e){this.type=t,this.defaultPrevented=!1,e&&Object.assign(this,e)}preventDefault(){this.defaultPrevented=!0}}class $i{constructor(){this._listeners={},this._filters={},this.pswp=void 0,this.options=void 0}addFilter(t,e,i=100){var s,n,o;this._filters[t]||(this._filters[t]=[]),null===(s=this._filters[t])||void 0===s||s.push({fn:e,priority:i}),null===(n=this._filters[t])||void 0===n||n.sort(((t,e)=>t.priority-e.priority)),null===(o=this.pswp)||void 0===o||o.addFilter(t,e,i)}removeFilter(t,e){this._filters[t]&&(this._filters[t]=this._filters[t].filter((t=>t.fn!==e))),this.pswp&&this.pswp.removeFilter(t,e)}applyFilters(t,...e){var i;return null===(i=this._filters[t])||void 0===i||i.forEach((t=>{e[0]=t.fn.apply(this,e)})),e[0]}on(t,e){var i,s;this._listeners[t]||(this._listeners[t]=[]),null===(i=this._listeners[t])||void 0===i||i.push(e),null===(s=this.pswp)||void 0===s||s.on(t,e)}off(t,e){var i;this._listeners[t]&&(this._listeners[t]=this._listeners[t].filter((t=>e!==t))),null===(i=this.pswp)||void 0===i||i.off(t,e)}dispatch(t,e){var i;if(this.pswp)return this.pswp.dispatch(t,e);const s=new Fi(t,e);return null===(i=this._listeners[t])||void 0===i||i.forEach((t=>{t.call(this,s)})),s}}class ji{constructor(t,e){if(this.element=Xe("pswp__img pswp__img--placeholder",t?"img":"div",e),t){const e=this.element;e.decoding="async",e.alt="",e.src=t,e.setAttribute("role","presentation")}this.element.setAttribute("aria-hidden","true")}setDisplayedSize(t,e){this.element&&("IMG"===this.element.tagName?(ei(this.element,250,"auto"),this.element.style.transformOrigin="0 0",this.element.style.transform=Qe(0,0,t/250)):ei(this.element,t,e))}destroy(){var t;null!==(t=this.element)&&void 0!==t&&t.parentNode&&this.element.remove(),this.element=null}}class Ni{constructor(t,e,i){this.instance=e,this.data=t,this.index=i,this.element=void 0,this.placeholder=void 0,this.slide=void 0,this.displayedImageWidth=0,this.displayedImageHeight=0,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.hasSlide=!1,this.isDecoding=!1,this.state=ii,this.data.type?this.type=this.data.type:this.data.src?this.type="image":this.type="html",this.instance.dispatch("contentInit",{content:this})}removePlaceholder(){this.placeholder&&!this.keepPlaceholder()&&setTimeout((()=>{this.placeholder&&(this.placeholder.destroy(),this.placeholder=void 0)}),1e3)}load(t,e){if(this.slide&&this.usePlaceholder())if(this.placeholder){const t=this.placeholder.element;t&&!t.parentElement&&this.slide.container.prepend(t)}else{const t=this.instance.applyFilters("placeholderSrc",!(!this.data.msrc||!this.slide.isFirstSlide)&&this.data.msrc,this);this.placeholder=new ji(t,this.slide.container)}this.element&&!e||this.instance.dispatch("contentLoad",{content:this,isLazy:t}).defaultPrevented||(this.isImageContent()?(this.element=Xe("pswp__img","img"),this.displayedImageWidth&&this.loadImage(t)):(this.element=Xe("pswp__content","div"),this.element.innerHTML=this.data.html||""),e&&this.slide&&this.slide.updateContentSize(!0))}loadImage(t){var e,i;if(!this.isImageContent()||!this.element||this.instance.dispatch("contentLoadImage",{content:this,isLazy:t}).defaultPrevented)return;const s=this.element;this.updateSrcsetSizes(),this.data.srcset&&(s.srcset=this.data.srcset),s.src=null!==(e=this.data.src)&&void 0!==e?e:"",s.alt=null!==(i=this.data.alt)&&void 0!==i?i:"",this.state=si,s.complete?this.onLoaded():(s.onload=()=>{this.onLoaded()},s.onerror=()=>{this.onError()})}setSlide(t){this.slide=t,this.hasSlide=!0,this.instance=t.pswp}onLoaded(){this.state=ni,this.slide&&this.element&&(this.instance.dispatch("loadComplete",{slide:this.slide,content:this}),this.slide.isActive&&this.slide.heavyAppended&&!this.element.parentNode&&(this.append(),this.slide.updateContentSize(!0)),this.state!==ni&&this.state!==oi||this.removePlaceholder())}onError(){this.state=oi,this.slide&&(this.displayError(),this.instance.dispatch("loadComplete",{slide:this.slide,isError:!0,content:this}),this.instance.dispatch("loadError",{slide:this.slide,content:this}))}isLoading(){return this.instance.applyFilters("isContentLoading",this.state===si,this)}isError(){return this.state===oi}isImageContent(){return"image"===this.type}setDisplayedSize(t,e){if(this.element&&(this.placeholder&&this.placeholder.setDisplayedSize(t,e),!this.instance.dispatch("contentResize",{content:this,width:t,height:e}).defaultPrevented&&(ei(this.element,t,e),this.isImageContent()&&!this.isError()))){const i=!this.displayedImageWidth&&t;this.displayedImageWidth=t,this.displayedImageHeight=e,i?this.loadImage(!1):this.updateSrcsetSizes(),this.slide&&this.instance.dispatch("imageSizeChange",{slide:this.slide,width:t,height:e,content:this})}}isZoomable(){return this.instance.applyFilters("isContentZoomable",this.isImageContent()&&this.state!==oi,this)}updateSrcsetSizes(){if(!this.isImageContent()||!this.element||!this.data.srcset)return;const t=this.element,e=this.instance.applyFilters("srcsetSizesWidth",this.displayedImageWidth,this);(!t.dataset.largestUsedSize||e>parseInt(t.dataset.largestUsedSize,10))&&(t.sizes=e+"px",t.dataset.largestUsedSize=String(e))}usePlaceholder(){return this.instance.applyFilters("useContentPlaceholder",this.isImageContent(),this)}lazyLoad(){this.instance.dispatch("contentLazyLoad",{content:this}).defaultPrevented||this.load(!0)}keepPlaceholder(){return this.instance.applyFilters("isKeepingPlaceholder",this.isLoading(),this)}destroy(){this.hasSlide=!1,this.slide=void 0,this.instance.dispatch("contentDestroy",{content:this}).defaultPrevented||(this.remove(),this.placeholder&&(this.placeholder.destroy(),this.placeholder=void 0),this.isImageContent()&&this.element&&(this.element.onload=null,this.element.onerror=null,this.element=void 0))}displayError(){if(this.slide){var t,e;let i=Xe("pswp__error-msg","div");i.innerText=null!==(t=null===(e=this.instance.options)||void 0===e?void 0:e.errorMsg)&&void 0!==t?t:"",i=this.instance.applyFilters("contentErrorElement",i,this),this.element=Xe("pswp__content pswp__error-msg-container","div"),this.element.appendChild(i),this.slide.container.innerText="",this.slide.container.appendChild(this.element),this.slide.updateContentSize(!0),this.removePlaceholder()}}append(){if(this.isAttached||!this.element)return;if(this.isAttached=!0,this.state===oi)return void this.displayError();if(this.instance.dispatch("contentAppend",{content:this}).defaultPrevented)return;const t="decode"in this.element;this.isImageContent()?t&&this.slide&&(!this.slide.isActive||ai())?(this.isDecoding=!0,this.element.decode().catch((()=>{})).finally((()=>{this.isDecoding=!1,this.appendImage()}))):this.appendImage():this.slide&&!this.element.parentNode&&this.slide.container.appendChild(this.element)}activate(){!this.instance.dispatch("contentActivate",{content:this}).defaultPrevented&&this.slide&&(this.isImageContent()&&this.isDecoding&&!ai()?this.appendImage():this.isError()&&this.load(!1,!0),this.slide.holderElement&&this.slide.holderElement.setAttribute("aria-hidden","false"))}deactivate(){this.instance.dispatch("contentDeactivate",{content:this}),this.slide&&this.slide.holderElement&&this.slide.holderElement.setAttribute("aria-hidden","true")}remove(){this.isAttached=!1,this.instance.dispatch("contentRemove",{content:this}).defaultPrevented||(this.element&&this.element.parentNode&&this.element.remove(),this.placeholder&&this.placeholder.element&&this.placeholder.element.remove())}appendImage(){this.isAttached&&(this.instance.dispatch("contentAppendImage",{content:this}).defaultPrevented||(this.slide&&this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element),this.state!==ni&&this.state!==oi||this.removePlaceholder()))}}function Ui(t,e,i){const s=e.createContentFromData(t,i);let n;const{options:o}=e;if(o){let a;n=new ui(o,t,-1),a=e.pswp?e.pswp.viewportSize:li(o,e);const r=di(o,a,t,i);n.update(s.width,s.height,r)}return s.lazyLoad(),n&&s.setDisplayedSize(Math.ceil(s.width*n.initial),Math.ceil(s.height*n.initial)),s}class Xi{constructor(t){this.pswp=t,this.limit=Math.max(t.options.preload[0]+t.options.preload[1]+1,5),this._cachedItems=[]}updateLazy(t){const{pswp:e}=this;if(e.dispatch("lazyLoad").defaultPrevented)return;const{preload:i}=e.options,s=void 0===t||t>=0;let n;for(n=0;n<=i[1];n++)this.loadSlideByIndex(e.currIndex+(s?n:-n));for(n=1;n<=i[0];n++)this.loadSlideByIndex(e.currIndex+(s?-n:n))}loadSlideByIndex(t){const e=this.pswp.getLoopedIndex(t);let i=this.getContentByIndex(e);i||(i=function(t,e){const i=e.getItemData(t);if(!e.dispatch("lazyLoadSlide",{index:t,itemData:i}).defaultPrevented)return Ui(i,e,t)}(e,this.pswp),i&&this.addToCache(i))}getContentBySlide(t){let e=this.getContentByIndex(t.index);return e||(e=this.pswp.createContentFromData(t.data,t.index),this.addToCache(e)),e.setSlide(t),e}addToCache(t){if(this.removeByIndex(t.index),this._cachedItems.push(t),this._cachedItems.length>this.limit){const t=this._cachedItems.findIndex((t=>!t.isAttached&&!t.hasSlide));if(-1!==t){this._cachedItems.splice(t,1)[0].destroy()}}}removeByIndex(t){const e=this._cachedItems.findIndex((e=>e.index===t));-1!==e&&this._cachedItems.splice(e,1)}getContentByIndex(t){return this._cachedItems.find((e=>e.index===t))}destroy(){this._cachedItems.forEach((t=>t.destroy())),this._cachedItems=[]}}class Yi extends $i{getNumItems(){var t;let e=0;const i=null===(t=this.options)||void 0===t?void 0:t.dataSource;i&&"length"in i?e=i.length:i&&"gallery"in i&&(i.items||(i.items=this._getGalleryDOMElements(i.gallery)),i.items&&(e=i.items.length));const s=this.dispatch("numItems",{dataSource:i,numItems:e});return this.applyFilters("numItems",s.numItems,i)}createContentFromData(t,e){return new Ni(t,this,e)}getItemData(t){var e;const i=null===(e=this.options)||void 0===e?void 0:e.dataSource;let s={};Array.isArray(i)?s=i[t]:i&&"gallery"in i&&(i.items||(i.items=this._getGalleryDOMElements(i.gallery)),s=i.items[t]);let n=s;n instanceof Element&&(n=this._domElementToItemData(n));const o=this.dispatch("itemData",{itemData:n||{},index:t});return this.applyFilters("itemData",o.itemData,t)}_getGalleryDOMElements(t){var e,i;return null!==(e=this.options)&&void 0!==e&&e.children||null!==(i=this.options)&&void 0!==i&&i.childSelector?function(t,e,i=document){let s=[];if(t instanceof Element)s=[t];else if(t instanceof NodeList||Array.isArray(t))s=Array.from(t);else{const n="string"==typeof t?t:e;n&&(s=Array.from(i.querySelectorAll(n)))}return s}(this.options.children,this.options.childSelector,t)||[]:[t]}_domElementToItemData(t){const e={element:t},i="A"===t.tagName?t:t.querySelector("a");if(i){e.src=i.dataset.pswpSrc||i.href,i.dataset.pswpSrcset&&(e.srcset=i.dataset.pswpSrcset),e.width=i.dataset.pswpWidth?parseInt(i.dataset.pswpWidth,10):0,e.height=i.dataset.pswpHeight?parseInt(i.dataset.pswpHeight,10):0,e.w=e.width,e.h=e.height,i.dataset.pswpType&&(e.type=i.dataset.pswpType);const n=t.querySelector("img");var s;if(n)e.msrc=n.currentSrc||n.src,e.alt=null!==(s=n.getAttribute("alt"))&&void 0!==s?s:"";(i.dataset.pswpCropped||i.dataset.cropped)&&(e.thumbCropped=!0)}return this.applyFilters("domItemData",e,t,i)}lazyLoadData(t,e){return Ui(t,this,e)}}const Vi=.003;class qi{constructor(t){this.pswp=t,this.isClosed=!0,this.isOpen=!1,this.isClosing=!1,this.isOpening=!1,this._duration=void 0,this._useAnimation=!1,this._croppedZoom=!1,this._animateRootOpacity=!1,this._animateBgOpacity=!1,this._placeholder=void 0,this._opacityElement=void 0,this._cropContainer1=void 0,this._cropContainer2=void 0,this._thumbBounds=void 0,this._prepareOpen=this._prepareOpen.bind(this),t.on("firstZoomPan",this._prepareOpen)}open(){this._prepareOpen(),this._start()}close(){if(this.isClosed||this.isClosing||this.isOpening)return;const t=this.pswp.currSlide;this.isOpen=!1,this.isOpening=!1,this.isClosing=!0,this._duration=this.pswp.options.hideAnimationDuration,t&&t.currZoomLevel*t.width>=this.pswp.options.maxWidthToAnimate&&(this._duration=0),this._applyStartProps(),setTimeout((()=>{this._start()}),this._croppedZoom?30:0)}_prepareOpen(){if(this.pswp.off("firstZoomPan",this._prepareOpen),!this.isOpening){const t=this.pswp.currSlide;this.isOpening=!0,this.isClosing=!1,this._duration=this.pswp.options.showAnimationDuration,t&&t.zoomLevels.initial*t.width>=this.pswp.options.maxWidthToAnimate&&(this._duration=0),this._applyStartProps()}}_applyStartProps(){const{pswp:t}=this,e=this.pswp.currSlide,{options:i}=t;var s,n;("fade"===i.showHideAnimationType?(i.showHideOpacity=!0,this._thumbBounds=void 0):"none"===i.showHideAnimationType?(i.showHideOpacity=!1,this._duration=0,this._thumbBounds=void 0):this.isOpening&&t._initialThumbBounds?this._thumbBounds=t._initialThumbBounds:this._thumbBounds=this.pswp.getThumbBounds(),this._placeholder=null==e?void 0:e.getPlaceholderElement(),t.animations.stopAll(),this._useAnimation=Boolean(this._duration&&this._duration>50),this._animateZoom=Boolean(this._thumbBounds)&&(null==e?void 0:e.content.usePlaceholder())&&(!this.isClosing||!t.mainScroll.isShifted()),this._animateZoom)?this._animateRootOpacity=null!==(s=i.showHideOpacity)&&void 0!==s&&s:(this._animateRootOpacity=!0,this.isOpening&&e&&(e.zoomAndPanToInitial(),e.applyCurrentZoomPan()));if(this._animateBgOpacity=!this._animateRootOpacity&&this.pswp.options.bgOpacity>Vi,this._opacityElement=this._animateRootOpacity?t.element:t.bg,!this._useAnimation)return this._duration=0,this._animateZoom=!1,this._animateBgOpacity=!1,this._animateRootOpacity=!0,void(this.isOpening&&(t.element&&(t.element.style.opacity=String(Vi)),t.applyBgOpacity(1)));this._animateZoom&&this._thumbBounds&&this._thumbBounds.innerRect?(this._croppedZoom=!0,this._cropContainer1=this.pswp.container,this._cropContainer2=null===(n=this.pswp.currSlide)||void 0===n?void 0:n.holderElement,t.container&&(t.container.style.overflow="hidden",t.container.style.width=t.viewportSize.x+"px")):this._croppedZoom=!1;this.isOpening?(this._animateRootOpacity?(t.element&&(t.element.style.opacity=String(Vi)),t.applyBgOpacity(1)):(this._animateBgOpacity&&t.bg&&(t.bg.style.opacity=String(Vi)),t.element&&(t.element.style.opacity="1")),this._animateZoom&&(this._setClosedStateZoomPan(),this._placeholder&&(this._placeholder.style.willChange="transform",this._placeholder.style.opacity=String(Vi)))):this.isClosing&&(t.mainScroll.itemHolders[0]&&(t.mainScroll.itemHolders[0].el.style.display="none"),t.mainScroll.itemHolders[2]&&(t.mainScroll.itemHolders[2].el.style.display="none"),this._croppedZoom&&0!==t.mainScroll.x&&(t.mainScroll.resetPosition(),t.mainScroll.resize()))}_start(){this.isOpening&&this._useAnimation&&this._placeholder&&"IMG"===this._placeholder.tagName?new Promise((t=>{let e=!1,i=!0;var s;(s=this._placeholder,"decode"in s?s.decode().catch((()=>{})):s.complete?Promise.resolve(s):new Promise(((t,e)=>{s.onload=()=>t(s),s.onerror=e}))).finally((()=>{e=!0,i||t(!0)})),setTimeout((()=>{i=!1,e&&t(!0)}),50),setTimeout(t,250)})).finally((()=>this._initiate())):this._initiate()}_initiate(){var t,e;null===(t=this.pswp.element)||void 0===t||t.style.setProperty("--pswp-transition-duration",this._duration+"ms"),this.pswp.dispatch(this.isOpening?"openingAnimationStart":"closingAnimationStart"),this.pswp.dispatch("initialZoom"+(this.isOpening?"In":"Out")),null===(e=this.pswp.element)||void 0===e||e.classList.toggle("pswp--ui-visible",this.isOpening),this.isOpening?(this._placeholder&&(this._placeholder.style.opacity="1"),this._animateToOpenState()):this.isClosing&&this._animateToClosedState(),this._useAnimation||this._onAnimationComplete()}_onAnimationComplete(){const{pswp:t}=this;if(this.isOpen=this.isOpening,this.isClosed=this.isClosing,this.isOpening=!1,this.isClosing=!1,t.dispatch(this.isOpen?"openingAnimationEnd":"closingAnimationEnd"),t.dispatch("initialZoom"+(this.isOpen?"InEnd":"OutEnd")),this.isClosed)t.destroy();else if(this.isOpen){var e;this._animateZoom&&t.container&&(t.container.style.overflow="visible",t.container.style.width="100%"),null===(e=t.currSlide)||void 0===e||e.applyCurrentZoomPan()}}_animateToOpenState(){const{pswp:t}=this;this._animateZoom&&(this._croppedZoom&&this._cropContainer1&&this._cropContainer2&&(this._animateTo(this._cropContainer1,"transform","translate3d(0,0,0)"),this._animateTo(this._cropContainer2,"transform","none")),t.currSlide&&(t.currSlide.zoomAndPanToInitial(),this._animateTo(t.currSlide.container,"transform",t.currSlide.getCurrentTransform()))),this._animateBgOpacity&&t.bg&&this._animateTo(t.bg,"opacity",String(t.options.bgOpacity)),this._animateRootOpacity&&t.element&&this._animateTo(t.element,"opacity","1")}_animateToClosedState(){const{pswp:t}=this;this._animateZoom&&this._setClosedStateZoomPan(!0),this._animateBgOpacity&&t.bgOpacity>.01&&t.bg&&this._animateTo(t.bg,"opacity","0"),this._animateRootOpacity&&t.element&&this._animateTo(t.element,"opacity","0")}_setClosedStateZoomPan(t){if(!this._thumbBounds)return;const{pswp:e}=this,{innerRect:i}=this._thumbBounds,{currSlide:s,viewportSize:n}=e;if(this._croppedZoom&&i&&this._cropContainer1&&this._cropContainer2){const e=-n.x+(this._thumbBounds.x-i.x)+i.w,s=-n.y+(this._thumbBounds.y-i.y)+i.h,o=n.x-i.w,a=n.y-i.h;t?(this._animateTo(this._cropContainer1,"transform",Qe(e,s)),this._animateTo(this._cropContainer2,"transform",Qe(o,a))):(Je(this._cropContainer1,e,s),Je(this._cropContainer2,o,a))}s&&(Ye(s.pan,i||this._thumbBounds),s.currZoomLevel=this._thumbBounds.w/s.width,t?this._animateTo(s.container,"transform",s.getCurrentTransform()):s.applyCurrentZoomPan())}_animateTo(t,e,i){if(!this._duration)return void(t.style[e]=i);const{animations:s}=this.pswp,n={duration:this._duration,easing:this.pswp.options.easing,onComplete:()=>{s.activeAnimations.length||this._onAnimationComplete()},target:t};n[e]=i,s.startTransition(n)}}const Gi={allowPanToNext:!0,spacing:.1,loop:!0,pinchToClose:!0,closeOnVerticalDrag:!0,hideAnimationDuration:333,showAnimationDuration:333,zoomAnimationDuration:333,escKey:!0,arrowKeys:!0,trapFocus:!0,returnFocus:!0,maxWidthToAnimate:4e3,clickToCloseNonZoomable:!0,imageClickAction:"zoom-or-close",bgClickAction:"close",tapAction:"toggle-controls",doubleTapAction:"zoom",indexIndicatorSep:" / ",preloaderDelay:2e3,bgOpacity:.8,index:0,errorMsg:"The image cannot be loaded",preload:[1,2],easing:"cubic-bezier(.4,0,.22,1)"};const Ki=Object.freeze(Object.defineProperty({__proto__:null,default:class extends Yi{constructor(t){super(),this.options=this._prepareOptions(t||{}),this.offset={x:0,y:0},this._prevViewportSize={x:0,y:0},this.viewportSize={x:0,y:0},this.bgOpacity=1,this.currIndex=0,this.potentialIndex=0,this.isOpen=!1,this.isDestroying=!1,this.hasMouse=!1,this._initialItemData={},this._initialThumbBounds=void 0,this.topBar=void 0,this.element=void 0,this.template=void 0,this.container=void 0,this.scrollWrap=void 0,this.currSlide=void 0,this.events=new hi,this.animations=new Mi,this.mainScroll=new _i(this),this.gestures=new bi(this),this.opener=new qi(this),this.keyboard=new Si(this),this.contentLoader=new Xi(this)}init(){if(this.isOpen||this.isDestroying)return!1;this.isOpen=!0,this.dispatch("init"),this.dispatch("beforeOpen"),this._createMainStructure();let t="pswp--open";return this.gestures.supportsTouch&&(t+=" pswp--touch"),this.options.mainClass&&(t+=" "+this.options.mainClass),this.element&&(this.element.className+=" "+t),this.currIndex=this.options.index||0,this.potentialIndex=this.currIndex,this.dispatch("firstUpdate"),this.scrollWheel=new Ti(this),(Number.isNaN(this.currIndex)||this.currIndex<0||this.currIndex>=this.getNumItems())&&(this.currIndex=0),this.gestures.supportsTouch||this.mouseDetected(),this.updateSize(),this.offset.y=window.pageYOffset,this._initialItemData=this.getItemData(this.currIndex),this.dispatch("gettingData",{index:this.currIndex,data:this._initialItemData,slide:void 0}),this._initialThumbBounds=this.getThumbBounds(),this.dispatch("initialLayout"),this.on("openingAnimationEnd",(()=>{const{itemHolders:t}=this.mainScroll;t[0]&&(t[0].el.style.display="block",this.setContent(t[0],this.currIndex-1)),t[2]&&(t[2].el.style.display="block",this.setContent(t[2],this.currIndex+1)),this.appendHeavy(),this.contentLoader.updateLazy(),this.events.add(window,"resize",this._handlePageResize.bind(this)),this.events.add(window,"scroll",this._updatePageScrollOffset.bind(this)),this.dispatch("bindEvents")})),this.mainScroll.itemHolders[1]&&this.setContent(this.mainScroll.itemHolders[1],this.currIndex),this.dispatch("change"),this.opener.open(),this.dispatch("afterInit"),!0}getLoopedIndex(t){const e=this.getNumItems();return this.options.loop&&(t>e-1&&(t-=e),t<0&&(t+=e)),Ke(t,0,e-1)}appendHeavy(){this.mainScroll.itemHolders.forEach((t=>{var e;null===(e=t.slide)||void 0===e||e.appendHeavy()}))}goTo(t){this.mainScroll.moveIndexBy(this.getLoopedIndex(t)-this.potentialIndex)}next(){this.goTo(this.potentialIndex+1)}prev(){this.goTo(this.potentialIndex-1)}zoomTo(...t){var e;null===(e=this.currSlide)||void 0===e||e.zoomTo(...t)}toggleZoom(){var t;null===(t=this.currSlide)||void 0===t||t.toggleZoom()}close(){this.opener.isOpen&&!this.isDestroying&&(this.isDestroying=!0,this.dispatch("close"),this.events.removeAll(),this.opener.close())}destroy(){var t;if(!this.isDestroying)return this.options.showHideAnimationType="none",void this.close();this.dispatch("destroy"),this._listeners={},this.scrollWrap&&(this.scrollWrap.ontouchmove=null,this.scrollWrap.ontouchend=null),null===(t=this.element)||void 0===t||t.remove(),this.mainScroll.itemHolders.forEach((t=>{var e;null===(e=t.slide)||void 0===e||e.destroy()})),this.contentLoader.destroy(),this.events.removeAll()}refreshSlideContent(t){this.contentLoader.removeByIndex(t),this.mainScroll.itemHolders.forEach(((e,i)=>{var s,n;let o=(null!==(s=null===(n=this.currSlide)||void 0===n?void 0:n.index)&&void 0!==s?s:0)-1+i;var a;(this.canLoop()&&(o=this.getLoopedIndex(o)),o===t)&&(this.setContent(e,t,!0),1===i&&(this.currSlide=e.slide,null===(a=e.slide)||void 0===a||a.setIsActive(!0)))})),this.dispatch("change")}setContent(t,e,i){if(this.canLoop()&&(e=this.getLoopedIndex(e)),t.slide){if(t.slide.index===e&&!i)return;t.slide.destroy(),t.slide=void 0}if(!this.canLoop()&&(e<0||e>=this.getNumItems()))return;const s=this.getItemData(e);t.slide=new mi(s,e,this),e===this.currIndex&&(this.currSlide=t.slide),t.slide.append(t.el)}getViewportCenterPoint(){return{x:this.viewportSize.x/2,y:this.viewportSize.y/2}}updateSize(t){if(this.isDestroying)return;const e=li(this.options,this);!t&&Ge(e,this._prevViewportSize)||(Ye(this._prevViewportSize,e),this.dispatch("beforeResize"),Ye(this.viewportSize,this._prevViewportSize),this._updatePageScrollOffset(),this.dispatch("viewportSize"),this.mainScroll.resize(this.opener.isOpen),!this.hasMouse&&window.matchMedia("(any-hover: hover)").matches&&this.mouseDetected(),this.dispatch("resize"))}applyBgOpacity(t){this.bgOpacity=Math.max(t,0),this.bg&&(this.bg.style.opacity=String(this.bgOpacity*this.options.bgOpacity))}mouseDetected(){var t;this.hasMouse||(this.hasMouse=!0,null===(t=this.element)||void 0===t||t.classList.add("pswp--has_mouse"))}_handlePageResize(){this.updateSize(),/iPhone|iPad|iPod/i.test(window.navigator.userAgent)&&setTimeout((()=>{this.updateSize()}),500)}_updatePageScrollOffset(){this.setScrollOffset(0,window.pageYOffset)}setScrollOffset(t,e){this.offset.x=t,this.offset.y=e,this.dispatch("updateScrollOffset")}_createMainStructure(){this.element=Xe("pswp","div"),this.element.setAttribute("tabindex","-1"),this.element.setAttribute("role","dialog"),this.template=this.element,this.bg=Xe("pswp__bg","div",this.element),this.scrollWrap=Xe("pswp__scroll-wrap","section",this.element),this.container=Xe("pswp__container","div",this.scrollWrap),this.scrollWrap.setAttribute("aria-roledescription","carousel"),this.container.setAttribute("aria-live","off"),this.container.setAttribute("id","pswp__items"),this.mainScroll.appendHolders(),this.ui=new ki(this),this.ui.init(),(this.options.appendToEl||document.body).appendChild(this.element)}getThumbBounds(){return function(t,e,i){const s=i.dispatch("thumbBounds",{index:t,itemData:e,instance:i});if(s.thumbBounds)return s.thumbBounds;const{element:n}=e;let o,a;if(n&&!1!==i.options.thumbSelector){const t=i.options.thumbSelector||"img";a=n.matches(t)?n:n.querySelector(t)}return a=i.applyFilters("thumbEl",a,e,t),a&&(o=e.thumbCropped?function(t,e,i){const s=t.getBoundingClientRect(),n=s.width/e,o=s.height/i,a=n>o?n:o,r=(s.width-e*a)/2,h=(s.height-i*a)/2,l={x:s.left+r,y:s.top+h,w:e*a};return l.innerRect={w:s.width,h:s.height,x:r,y:h},l}(a,e.width||e.w||0,e.height||e.h||0):function(t){const e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width}}(a)),i.applyFilters("thumbBounds",o,e,t)}(this.currIndex,this.currSlide?this.currSlide.data:this._initialItemData,this)}canLoop(){return this.options.loop&&this.getNumItems()>2}_prepareOptions(t){return window.matchMedia("(prefers-reduced-motion), (update: slow)").matches&&(t.showHideAnimationType="none",t.zoomAnimationDuration=0),{...Gi,...t}}}},Symbol.toStringTag,{value:"Module"}));export{Ue as _,me as f,Ki as p};
