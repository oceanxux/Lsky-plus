import{_ as e,n as a,u as l}from"./Layout.vue_vue_type_script_setup_true_lang-Bd80f82b.js";import{_ as t}from"./Content.vue_vue_type_script_setup_true_lang-CEfikmAR.js";import{k as u,r as s,$ as r,c as n,o,N as d,Q as i,a8 as c,P as m,K as p,U as v,Y as _,M as f,a7 as y,j as b,R as $,F as g,L as h}from"./vue-vendors-B4XdlKKZ.js";import{a as k,F as P,K as j}from"./index-DZdj2b_n.js";import{_ as x}from"./Back.vue_vue_type_script_setup_true_lang-CZlTXmSD.js";import{u as L}from"./order-B5wF1C3c.js";import{u as w,_ as C}from"./usePayment-uvCoKVRE.js";import{d as z,W as O,g as N}from"./icons-C1_zt0kT.js";import{m as S,G as T,r as U,o as B,X as D,Y as I,B as K}from"./naive-ui-DFBPfLe9.js";import"./photo-components-DTzq5atJ.js";import"./utils-DGAJShNI.js";const F={class:"flex flex-col space-y-3 my-6 items-center justify-center"},M={class:"flex space-x-1 w-full items-center"},Y=["title"],A={class:"text-red-500"},G={class:"text-red-500"},H={key:0,class:"text-xs"},J={key:0},Q={class:"flex justify-end space-x-2 w-full mt-4"},R=u({__name:"DetailView",setup(u){const R=c(),V=S(),W=T(),X=s({}),q=k(),E=L(),Z=P(),{t:ee}=r(),ae=s(""),{handlePayment:le,validatePayment:te}=w();async function ue(){var e,a,l;const t=await j({path:{trade_no:R.params.trade_no.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return V.error(null==(a=t.data)?void 0:a.message);X.value=null==(l=t.data)?void 0:l.data}const se=n((()=>({cancelled:ee("Cancelled"),unpaid:ee("Unpaid"),paid:ee("Paid")}))),re=n((()=>({cancelled:"red",unpaid:"yellow",paid:"green"}))),ne={cancelled:N,unpaid:O,paid:z};async function oe(){te(ae.value,X.value.amount)&&await le(ae.value,R.params.trade_no.toString())}async function de(){try{await E.cancelOrder(R.params.trade_no.toString(),W,ee),V.success(ee("Cancellation successful")),ue()}catch(e){}}return o((()=>{ue()})),(u,s)=>(h(),d(e,{"header-title":u.$t("Order Details"),"toggle-header":!1,"show-footer":!1},{default:i((()=>[m(t,{class:"mx-auto p-4 md:p-10 space-y-5"},{default:i((()=>[m(x,{to:"/user/orders"}),m(_(U),null,{default:i((()=>[f("div",F,[m(_(B),{size:50,color:re.value[X.value.status],component:ne[X.value.status]},null,8,["color","component"]),f("p",null,y(se.value[X.value.status]),1)])])),_:1}),m(_(U),{title:u.$t("Package Snapshot")},{default:i((()=>[m(_(D),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:i((()=>[m(_(I),{label:u.$t("Name")},{default:i((()=>{var e;return[b(y(null==(e=X.value.snapshot)?void 0:e.name),1)]})),_:1},8,["label"]),m(_(I),{label:u.$t("Intro")},{default:i((()=>{var e;return[b(y(null==(e=X.value.snapshot)?void 0:e.intro),1)]})),_:1},8,["label"]),m(_(I),{label:u.$t("Badge")},{default:i((()=>{var e;return[b(y(null==(e=X.value.snapshot)?void 0:e.badge),1)]})),_:1},8,["label"]),m(_(I),{label:u.$t("Privileges")},{default:i((()=>{var e;return[(h(!0),p(g,null,$((null==(e=X.value.snapshot)?void 0:e.features)||[],(e=>(h(),p("div",M,[m(_(B),{size:16,color:"green",component:_(z)},null,8,["component"]),f("p",{class:"w-full truncate",title:e},y(e),9,Y)])))),256))]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),m(_(U),{title:u.$t("Product Information")},{default:i((()=>[m(_(D),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:i((()=>[m(_(I),{label:u.$t("Name")},{default:i((()=>{var e;return[b(y(null==(e=X.value.product)?void 0:e.name),1)]})),_:1},8,["label"]),m(_(I),{label:u.$t("Duration")},{default:i((()=>{var e;return[b(y(u.$t("{minutes} minutes",{minutes:null==(e=X.value.product)?void 0:e.duration})),1)]})),_:1},8,["label"]),m(_(I),{label:u.$t("Price")},{default:i((()=>{var e,l;return[f("p",A,y(_(a).currency(null==(e=X.value.product)?void 0:e.price,null==(l=_(q).configs)?void 0:l.app.currency,_(Z).locale)),1)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),m(_(U),{title:u.$t("Order Information")},{default:i((()=>[m(_(D),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:i((()=>[m(_(I),{label:u.$t("Order Number")},{default:i((()=>[b(y(X.value.trade_no),1)])),_:1},8,["label"]),m(_(I),{label:u.$t("Order Status")},{default:i((()=>[b(y(se.value[X.value.status]),1)])),_:1},8,["label"]),X.value.pay_method?(h(),d(_(I),{key:0,label:u.$t("Payment Method")},{default:i((()=>[b(y(X.value.pay_method),1)])),_:1},8,["label"])):v("",!0),X.value.paid_at?(h(),d(_(I),{key:1,label:u.$t("Payment Time")},{default:i((()=>[b(y(_(l)(X.value.paid_at).format("LLL")),1)])),_:1},8,["label"])):v("",!0),X.value.canceled_at?(h(),d(_(I),{key:2,label:u.$t("Cancellation Time")},{default:i((()=>[b(y(_(l)(X.value.canceled_at).format("LLL")),1)])),_:1},8,["label"])):v("",!0),m(_(I),{label:u.$t("Creation Time")},{default:i((()=>[b(y(_(l)(X.value.created_at).format("LLL")),1)])),_:1},8,["label"]),m(_(I),{label:u.$t("Total Price")},{default:i((()=>{var e,l;return[f("p",G,y(_(a).currency(X.value.amount,null==(e=_(q).configs)?void 0:e.app.currency,_(Z).locale)),1),X.value.deduct_amount>0?(h(),p("span",H,y(u.$t("Use the coupon to deduct {amount}",{amount:_(a).currency(X.value.deduct_amount,null==(l=_(q).configs)?void 0:l.app.currency,_(Z).locale)})),1)):v("",!0)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),"unpaid"===X.value.status?(h(),p("div",J,[m(_(U),{title:u.$t("Checkout")},{default:i((()=>[X.value.amount>0?(h(),d(C,{key:0,value:ae.value,"onUpdate:value":s[0]||(s[0]=e=>ae.value=e)},null,8,["value"])):v("",!0),f("div",Q,[X.value.amount>0?(h(),d(_(K),{key:0,type:"primary",disabled:""===ae.value,size:"small",onClick:oe},{default:i((()=>[b(y(u.$t("Proceed to Payment")),1)])),_:1},8,["disabled"])):(h(),d(_(K),{key:1,type:"primary",size:"small",onClick:oe},{default:i((()=>[b(y(u.$t("Pay Now")),1)])),_:1})),m(_(K),{type:"error",size:"small",onClick:de},{default:i((()=>[b(y(u.$t("Cancel Order")),1)])),_:1})])])),_:1},8,["title"])])):v("",!0)])),_:1})])),_:1},8,["header-title"]))}});export{R as default};
